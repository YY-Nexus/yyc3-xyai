#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
from datetime import datetime

# å®šä¹‰æˆé•¿é˜¶æ®µå’Œæ–‡ä»¶å¤¹ç»“æ„
folder_structure = {
    "èƒå„¿æœŸ": ["äº§æ£€è®°å½•", "å­•æœŸBè¶…", "èƒæ•™å†…å®¹", "å­•å¦‡æ—¥è®°"],
    "æ–°ç”Ÿå„¿æœŸ": ["æŠ¤ç†è®°å½•", "å¥åº·æ¡£æ¡ˆ", "æˆé•¿ç…§ç‰‡", "è„å¸¦æŠ¤ç†"],
    "å©´å„¿æœŸ": ["å–‚å…»è®°å½•", "ç–«è‹—æ¥ç§", "å‘è‚²æŒ‡æ ‡", "æ—©æ•™æ´»åŠ¨"],
    "å¹¼å„¿æœŸ": ["è¯­è¨€å‘å±•", "è®¤çŸ¥èƒ½åŠ›", "ç¤¾äº¤æ´»åŠ¨", "å…´è¶£çˆ±å¥½"],
    "å­¦é¾„å‰": ["å­¦å‰å‡†å¤‡", "å®‰å…¨æ•™è‚²", "ä¹ æƒ¯å…»æˆ", "äº²å­æ¸¸æˆ"],
    "å°å­¦": ["å­¦ä¹ è®°å½•", "è¯¾å¤–æ´»åŠ¨", "æˆç»©æ¡£æ¡ˆ", "æ•™å¸ˆè¯„è¯­"],
    "ä¸­å­¦": ["å­¦ç§‘ç¬”è®°", "è€ƒè¯•æˆç»©", "ç¤¾ä¼šå®è·µ", "å‡å­¦è§„åˆ’"],
    "å¤§å­¦": ["ä¸“ä¸šå­¦ä¹ ", "å®ä¹ ç»å†", "èŒä¸šè§„åˆ’", "æ¯•ä¸šå‡†å¤‡"]
}

def generate_phase_message(phase):
    """æ ¹æ®ä¸åŒé˜¶æ®µç”Ÿæˆå¯¹åº”çš„å¯„è¯­"""
    messages = {
        "èƒå„¿æœŸ": "æœŸå¾…ä½ çš„ç¬¬ä¸€å£°å•¼å“­ï¼Œæˆ‘ä»¬çš„å°å¤©ä½¿",
        "æ–°ç”Ÿå„¿æœŸ": "ä½ çš„ç¬¬ä¸€æ¬¡å‘¼å¸ï¼Œæ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„æ—‹å¾‹",
        "å©´å„¿æœŸ": "ç¬¬ä¸€æ¬¡çœ‹åˆ°ä½ ç¬‘ï¼Œæˆ‘çš„ä¸–ç•Œéƒ½äº®äº†",
        "å¹¼å„¿æœŸ": "ä½ çš„æ¯ä¸€æ­¥æˆé•¿ï¼Œéƒ½è®©æˆ‘ä»¬æƒŠå–œä¸‡åˆ†",
        "å­¦é¾„å‰": "å‡†å¤‡å¥½äº†å—ï¼Ÿå¤šå½©çš„ä¸–ç•Œåœ¨ç­‰ç€ä½ ",
        "å°å­¦": "çŸ¥è¯†çš„æµ·æ´‹é‡Œï¼Œæ„¿ä½ åƒå‹‡æ•¢çš„å°èˆ¹",
        "ä¸­å­¦": "é’æ˜¥çš„ç¯‡ç« å³å°†å¼€å¯ï¼Œå‹‡æ•¢è¿½å¯»æ¢¦æƒ³",
        "å¤§å­¦": "å±•ç¿…é«˜é£å§ï¼Œå‘ç€æœªæ¥çš„å¤©ç©º"
    }
    return messages.get(phase, "è®°å½•æˆé•¿çš„æ¯ä¸€ä¸ªç²¾å½©ç¬é—´")

def create_templates(folder_path, phase):
    """ä¸ºä¸åŒé˜¶æ®µç”Ÿæˆè®°å½•æ¨¡æ¿"""
    # æ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨
    if not os.path.exists(folder_path):
        os.makedirs(folder_path)
    
    # é¿å…è¦†ç›–å·²æœ‰æ–‡ä»¶
    def safe_create_file(file_path, content):
        if not os.path.exists(file_path):
            with open(file_path, "w", encoding="utf-8") as f:
                f.write(content)
    
    if "å©´å„¿æœŸ" in phase:
        # 0-1å²ä¸“å±æ¨¡æ¿ï¼šé¦–æ¬¡äº‹ä»¶è®°å½•è¡¨
        safe_create_file(os.path.join(folder_path, "é¦–æ¬¡äº‹ä»¶è®°å½•æ¨¡æ¿.txt"), 
                        "æ—¥æœŸï¼š\näº‹ä»¶ï¼šï¼ˆå¦‚ç¬¬ä¸€æ¬¡ç¿»èº«/ç¬¬ä¸€æ¬¡ç¬‘å‡ºå£°ï¼‰\nåœºæ™¯ï¼š\nè¡¨ç°ï¼šï¼ˆè¡¨æƒ…/åŠ¨ä½œ/å£°éŸ³ï¼‰\nå®¶é•¿æ„Ÿå—ï¼š\n")
    elif "å°å­¦" in phase:
        # å°å­¦é˜¶æ®µï¼šå‘¨æˆé•¿å°ç»“æ¨¡æ¿
        safe_create_file(os.path.join(folder_path, "å‘¨å°ç»“æ¨¡æ¿.txt"), 
                        "æœ¬å‘¨æœ€å¼€å¿ƒçš„äº‹ï¼š\né‡åˆ°çš„å°å›°éš¾ï¼š\nå­¦ä¼šçš„æ–°ä¸œè¥¿ï¼š\næƒ³å¯¹çˆ¸å¦ˆè¯´çš„è¯ï¼š\n")
    elif "å¹¼å„¿æœŸ" in phase:
        # å¹¼å„¿æœŸï¼šè¯­è¨€å‘å±•è®°å½•è¡¨
        safe_create_file(os.path.join(folder_path, "è¯­è¨€å‘å±•è®°å½•.txt"), 
                        "æ—¥æœŸï¼š\næ–°å­¦ä¼šçš„è¯æ±‡ï¼š\nèƒ½è¯´çš„å¥å­ï¼š\næœ‰è¶£çš„è¡¨è¾¾ï¼š\nè¯­è¨€å°æ•…äº‹ï¼š\n")
    elif "ä¸­å­¦" in phase:
        # ä¸­å­¦é˜¶æ®µï¼šæœˆåº¦åæ€æ¨¡æ¿
        safe_create_file(os.path.join(folder_path, "æœˆåº¦æˆé•¿åæ€.txt"), 
                        "æœ¬æœˆå­¦ä¹ æ”¶è·ï¼š\né‡åˆ°çš„æŒ‘æˆ˜ï¼š\nè§£å†³æ–¹æ¡ˆï¼š\nä¸‹æœˆç›®æ ‡ï¼š\næƒ³å¯¹æœªæ¥è‡ªå·±è¯´çš„è¯ï¼š\n")

def add_sync_guide(main_path):
    """ç”Ÿæˆäº‘åŒæ­¥æŒ‡å—æ–‡ä»¶"""
    guide = """ã€æ²«è¯­æˆé•¿è®°å½•äº‘åŒæ­¥æŒ‡å—ã€‘

ğŸ“ å¤‡ä»½ç­–ç•¥ï¼š
1. æ¨èä½¿ç”¨iCloud/é˜¿é‡Œäº‘ç›˜è‡ªåŠ¨åŒæ­¥æ­¤æ–‡ä»¶å¤¹
2. æ¯æœˆ1æ—¥æ‰‹åŠ¨å¤‡ä»½è‡³ç§»åŠ¨ç¡¬ç›˜ï¼ˆå‘½åæ ¼å¼ï¼š202Xå¹´Xæœˆ-æ²«è¯­æˆé•¿å¤‡ä»½ï¼‰
3. é‡è¦ç…§ç‰‡/è§†é¢‘å•ç‹¬åˆ›å»ºåŠ å¯†ç›¸å†Œï¼Œå¯†ç æç¤ºï¼šæ²«è¯­çš„ç”Ÿæ—¥æœˆä»½+èŠ‚æ°”ï¼ˆå¦‚3æ˜¥åˆ†ï¼‰

ğŸ”’ å®‰å…¨æé†’ï¼š
- å®šæœŸæ£€æŸ¥äº‘ç«¯åŒæ­¥çŠ¶æ€
- é‡è¦æ–‡ä»¶å»ºè®®ä¿å­˜å¤šä¸ªå‰¯æœ¬
- ç…§ç‰‡è§†é¢‘æ–‡ä»¶è¾ƒå¤§ï¼Œæ³¨æ„å­˜å‚¨ç©ºé—´

ğŸ“ ä½¿ç”¨å»ºè®®ï¼š
- æ¯ä¸ªé˜¶æ®µç»“æŸåæ•´ç†å½’æ¡£
- å®šæœŸæ·»åŠ æˆé•¿ç…§ç‰‡å’Œè§†é¢‘
- ä¿æŒè®°å½•çš„è¿ç»­æ€§å’Œå®Œæ•´æ€§
"""
    guide_path = os.path.join(main_path, "äº‘åŒæ­¥æŒ‡å—.txt")
    if not os.path.exists(guide_path):
        with open(guide_path, "w", encoding="utf-8") as f:
            f.write(guide)

def create_folder_structure(main_path):
    """åˆ›å»ºå®Œæ•´çš„æ–‡ä»¶å¤¹ç»“æ„"""
    # åˆ›å»ºä¸»æ–‡ä»¶å¤¹
    if not os.path.exists(main_path):
        os.makedirs(main_path)
        print(f"ğŸ“ åˆ›å»ºä¸»æ–‡ä»¶å¤¹: {main_path}")
    
    # åˆ›å»ºé˜¶æ®µæ–‡ä»¶å¤¹
    for phase, subfolders in folder_structure.items():
        phase_path = os.path.join(main_path, phase)
        if not os.path.exists(phase_path):
            os.makedirs(phase_path)
            print(f"ğŸ“‚ åˆ›å»ºé˜¶æ®µæ–‡ä»¶å¤¹: {phase}")
        
        # åˆ›å»ºå¯„è¯­æ–‡ä»¶
        message_path = os.path.join(phase_path, "é˜¶æ®µå¯„è¯­.txt")
        if not os.path.exists(message_path):
            with open(message_path, "w", encoding="utf-8") as f:
                f.write(generate_phase_message(phase))
        
        # åˆ›å»ºå­æ–‡ä»¶å¤¹
        for subfolder in subfolders:
            sub_path = os.path.join(phase_path, subfolder)
            if not os.path.exists(sub_path):
                os.makedirs(sub_path)

def create_readme(main_path):
    """åˆ›å»ºREADMEè¯´æ˜æ–‡ä»¶"""
    readme_content = f"""# æ²«è¯­æˆé•¿è®°å½•ä½“ç³»

## ğŸ“… åˆ›å»ºæ—¶é—´
{datetime.now().strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S')}

## ğŸŒŸ é¡¹ç›®ç®€ä»‹
æœ¬æ–‡ä»¶å¤¹ç”¨äºè®°å½•æ²«è¯­ä»èƒå„¿æœŸåˆ°å¤§å­¦çš„å®Œæ•´æˆé•¿å†ç¨‹ï¼ŒåŒ…å«8ä¸ªé‡è¦é˜¶æ®µï¼š
- èƒå„¿æœŸ â†’ æ–°ç”Ÿå„¿æœŸ â†’ å©´å„¿æœŸ â†’ å¹¼å„¿æœŸ
- å­¦é¾„å‰ â†’ å°å­¦ â†’ ä¸­å­¦ â†’ å¤§å­¦

## ğŸ“‹ ä½¿ç”¨è¯´æ˜
1. æ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸“å±çš„å­æ–‡ä»¶å¤¹å’Œè®°å½•æ¨¡æ¿
2. è¯·æŒ‰ç…§æ—¶é—´é¡ºåºä¿å­˜ç›¸å…³èµ„æ–™
3. é‡è¦æ—¶åˆ»å¯æ‹ç…§è®°å½•å¹¶æ”¾å…¥å¯¹åº”æ–‡ä»¶å¤¹
4. å®šæœŸæŸ¥çœ‹å„é˜¶æ®µå¯„è¯­ï¼Œå›é¡¾æˆé•¿è¶³è¿¹

## ğŸ”§ æŠ€æœ¯æ”¯æŒ
å¦‚éœ€å¸®åŠ©ï¼Œè¯·æŸ¥çœ‹ã€Šäº‘åŒæ­¥æŒ‡å—.txtã€‹
å¦‚éœ€æ·»åŠ æ–°æ¨¡æ¿ï¼Œå¯ä¿®æ”¹æºç é‡æ–°è¿è¡Œ

## â¤ï¸ å®¶é•¿å¯„è¯­
æ„¿è¿™ä¸ªå°å°çš„æ•°å­—æ¡£æ¡ˆï¼Œè®°å½•ä¸‹æ²«è¯­æˆé•¿è·¯ä¸Šçš„æ¯ä¸€ä¸ªçè´µç¬é—´ã€‚
æ¯ä¸€æ¬¡ç¿»çœ‹ï¼Œéƒ½æ˜¯çˆ±çš„å›å¿†ã€‚

---
ğŸ’ ç”¨å¿ƒè®°å½•ï¼Œç”¨çˆ±é™ªä¼´
"""
    
    readme_path = os.path.join(main_path, "README.md")
    if not os.path.exists(readme_path):
        with open(readme_path, "w", encoding="utf-8") as f:
            f.write(readme_content)

# ä¸»ç¨‹åº
if __name__ == "__main__":
    print("ğŸŒ¸ æ²«è¯­æˆé•¿è®°å½•ä½“ç³»åˆ›å»ºå™¨ ğŸŒ¸")
    print("=" * 40)
    
    main_folder = "æ²«è¯­æˆé•¿è®°å½•"
    main_path = os.path.join(os.getcwd(), main_folder)
    
    # æ­¥éª¤1ï¼šåˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„
    print("ğŸ“ æ­£åœ¨åˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„...")
    create_folder_structure(main_path)
    
    # æ­¥éª¤2ï¼šç”Ÿæˆæ¨¡æ¿æ–‡ä»¶
    print("ğŸ“ æ­£åœ¨ç”Ÿæˆè®°å½•æ¨¡æ¿...")
    for phase in folder_structure.keys():
        phase_path = os.path.join(main_path, phase)
        create_templates(phase_path, phase)
    
    # æ­¥éª¤3ï¼šæ·»åŠ äº‘åŒæ­¥æŒ‡å—
    print("â˜ï¸ æ­£åœ¨ç”Ÿæˆäº‘åŒæ­¥æŒ‡å—...")
    add_sync_guide(main_path)
    
    # æ­¥éª¤4ï¼šåˆ›å»ºREADMEæ–‡ä»¶
    print("ğŸ“„ æ­£åœ¨åˆ›å»ºè¯´æ˜æ–‡æ¡£...")
    create_readme(main_path)
    
    print("=" * 40)
    print(f"âœ… æ²«è¯­ä¸“å±æˆé•¿è®°å½•ä½“ç³»åˆ›å»ºå®Œæˆï¼")
    print(f"ğŸ“ æ–‡ä»¶å¤¹ä½ç½®ï¼š{main_path}")
    print("ğŸ‰ å¼€å§‹è®°å½•ç¾å¥½çš„æˆé•¿æ—¶å…‰å§ï¼")