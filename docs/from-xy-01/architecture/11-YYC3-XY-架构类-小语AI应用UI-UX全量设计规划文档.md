---
@file: YYC3-XY-æ¶æ„ç±»-å°è¯­AIåº”ç”¨UI-UXå…¨é‡è®¾è®¡è§„åˆ’æ–‡æ¡£.md
@description: YYCÂ³-XYå°è¯­AIåº”ç”¨çš„UI/UXå…¨é‡è®¾è®¡è§„åˆ’æ–‡æ¡£
@author: YYCÂ³
@version: v1.0.0
@created: 2025-12-26
@updated: 2025-12-28
@status: published
@tags: UI/UXè®¾è®¡,è®¾è®¡è§„åˆ’,ç»„ä»¶ä½“ç³»,äº”é«˜äº”æ ‡äº”åŒ–
---

# YYCÂ³-XY æ¶æ„ç±» - å°è¯­AIåº”ç”¨UI/UXå…¨é‡è®¾è®¡è§„åˆ’æ–‡æ¡£  

---

## ç›®å½•

1. [æ–‡æ¡£æ¦‚è¿°](#ä¸€æ–‡æ¡£æ¦‚è¿°)
2. [å…¨å±€é¡µé¢ç»„ä»¶ä½“ç³»](#äºŒå…¨å±€é¡µé¢ç»„ä»¶ä½“ç³»)
3. [åˆ†å±‚å¼æ¶æ„ä½“ç³»](#ä¸‰åˆ†å±‚å¼æ¶æ„ä½“ç³»)
4. [AIå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿ](#å››aiå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿ)
5. [å…¨é“¾è·¯é—­ç¯ç³»ç»Ÿ](#äº”å…¨é“¾è·¯é—­ç¯ç³»ç»Ÿ)
6. [APIæ¥å£ä½“ç³»](#å…­apiæ¥å£ä½“ç³»)
7. [ç”¨æˆ·ä¿¡æ¯åŠå…¨å±€å½¢è±¡ç³»ç»Ÿ](#ä¸ƒç”¨æˆ·ä¿¡æ¯åŠå…¨å±€å½¢è±¡ç³»ç»Ÿ)
8. [ä¿¡æ¯æ˜ å°„ç³»ç»Ÿ](#å…«ä¿¡æ¯æ˜ å°„ç³»ç»Ÿ)
9. [æŠ€æœ¯å®ç°è§„èŒƒ](#ä¹æŠ€æœ¯å®ç°è§„èŒƒ)
10. [è®¾è®¡è§„èŒƒä¸æ ‡å‡†](#åè®¾è®¡è§„èŒƒä¸æ ‡å‡†)

---

## ä¸€ã€æ–‡æ¡£æ¦‚è¿°

### 1.1 è®¾è®¡ç›®æ ‡

æœ¬è®¾è®¡è§„åˆ’æ—¨åœ¨ä¸ºå°è¯­AIåº”ç”¨æä¾›å®Œæ•´ã€ç³»ç»Ÿã€å¯è½åœ°çš„UI/UXè®¾è®¡æ–¹æ¡ˆï¼Œå®ç°ä»¥ä¸‹æ ¸å¿ƒç›®æ ‡ï¼š

- **å…¨å±€ç»Ÿä¸€æ€§**: ç¡®ä¿æ‰€æœ‰é¡µé¢ç»„ä»¶éµå¾ªç»Ÿä¸€çš„è®¾è®¡è¯­è¨€å’Œäº¤äº’è§„èŒƒ
- **åˆ†å±‚æ¸…æ™°æ€§**: é‡‡ç”¨äº”å±‚æ¶æ„æ¨¡å‹ï¼Œå®ç°ç»„ä»¶çš„å±‚æ¬¡åŒ–ç®¡ç†å’Œå¤ç”¨
- **AIå¼¹çª—è‡ªæ²»**: AIæµ®çª—ä½œä¸ºç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿï¼Œå…·å¤‡å®Œæ•´çš„äº¤äº’èƒ½åŠ›å’ŒçŠ¶æ€ç®¡ç†
- **å…¨é“¾è·¯é—­ç¯**: ä»ç”¨æˆ·è¿›å…¥åº”ç”¨åˆ°å®Œæˆäº¤äº’çš„å®Œæ•´æµç¨‹é—­ç¯è®¾è®¡
- **æ™ºèƒ½é€‚é…æ€§**: æ ¹æ®ç”¨æˆ·å¹´é¾„ã€æˆé•¿é˜¶æ®µã€æ–‡åŒ–èƒŒæ™¯æ™ºèƒ½é€‚é…å†…å®¹å’Œç•Œé¢

### 1.2 è®¾è®¡åŸåˆ™

éµå¾ªYYCÂ³ã€Œäº”é«˜äº”æ ‡äº”åŒ–ã€æ ‡å‡†ï¼š

**äº”é«˜ (Five Highs)**:
- é«˜å¯ç”¨: ç»„ä»¶å¯å¤ç”¨æ€§â‰¥90%ï¼Œäº¤äº’å“åº”æ—¶é—´â‰¤200ms
- é«˜æ€§èƒ½: é¡µé¢åŠ è½½æ—¶é—´â‰¤2sï¼ŒåŠ¨ç”»å¸§ç‡â‰¥60fps
- é«˜å®‰å…¨: ç”¨æˆ·æ•°æ®åŠ å¯†å­˜å‚¨ï¼Œæƒé™åˆ†çº§ç®¡ç†
- é«˜æ‰©å±•: ç»„ä»¶åŒ–è®¾è®¡ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½å’ŒæŒ‰éœ€æ¸²æŸ“
- é«˜ç»´æŠ¤: ä»£ç æ³¨é‡Šè¦†ç›–ç‡â‰¥80%ï¼Œæ–‡æ¡£å®Œæ•´åº¦100%

**äº”æ ‡ (Five Standards)**:
- æ ‡å‡†åŒ–: ç»„ä»¶å‘½åã€æ ·å¼ã€äº¤äº’éµå¾ªç»Ÿä¸€è§„èŒƒ
- è§„èŒƒåŒ–: è®¾è®¡ç¨¿ã€ä»£ç ã€æ–‡æ¡£ä¸‰åŒæ­¥
- è‡ªåŠ¨åŒ–: ç»„ä»¶è‡ªåŠ¨ç”Ÿæˆã€æµ‹è¯•ã€éƒ¨ç½²
- æ™ºèƒ½åŒ–: AIè¾…åŠ©è®¾è®¡ã€æ™ºèƒ½æ¨èã€è‡ªé€‚åº”å¸ƒå±€
- å¯è§†åŒ–: è®¾è®¡ç³»ç»Ÿå¯è§†åŒ–ã€ç»„ä»¶åº“å¯è§†åŒ–

**äº”åŒ– (Five Transformations)**:
- æµç¨‹åŒ–: è®¾è®¡æµç¨‹æ ‡å‡†åŒ–ã€å¯è¿½æº¯
- æ–‡æ¡£åŒ–: æ‰€æœ‰è®¾è®¡å†³ç­–æœ‰æ–‡æ¡£è®°å½•
- å·¥å…·åŒ–: è®¾è®¡å·¥å…·é“¾å®Œæ•´é›†æˆ
- æ•°å­—åŒ–: è®¾è®¡èµ„äº§æ•°å­—åŒ–ç®¡ç†
- ç”Ÿæ€åŒ–: è®¾è®¡ç³»ç»Ÿå¯æ‰©å±•ã€å¯æ¼”è¿›

### 1.3 è®¾è®¡èŒƒå›´

æœ¬è®¾è®¡è§„åˆ’è¦†ç›–ä»¥ä¸‹æ ¸å¿ƒç³»ç»Ÿï¼š

| ç³»ç»Ÿåç§° | è®¾è®¡å†…å®¹ | å…³é”®ç‰¹æ€§ |
|---------|---------|---------|
| å…¨å±€é¡µé¢ç»„ä»¶ä½“ç³» | åŸºç¡€ç»„ä»¶ã€ä¸šåŠ¡ç»„ä»¶ã€é¡µé¢ç»„ä»¶ã€ç³»ç»Ÿç»„ä»¶ | ç»„ä»¶åŒ–ã€å¯å¤ç”¨ã€å¯é…ç½® |
| åˆ†å±‚å¼æ¶æ„ä½“ç³» | äº”å±‚æ¶æ„æ¨¡å‹ã€ç»„ä»¶å±‚çº§å…³ç³» | å±‚æ¬¡æ¸…æ™°ã€èŒè´£æ˜ç¡® |
| AIå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿ | AIæµ®çª—ã€è¯­éŸ³äº¤äº’ã€æ™ºèƒ½æ¨è | ç‹¬ç«‹è¿è¡Œã€çŠ¶æ€è‡ªæ²» |
| å…¨é“¾è·¯é—­ç¯ç³»ç»Ÿ | ç”¨æˆ·æ—…ç¨‹ã€äº¤äº’æµç¨‹ã€æ•°æ®æµè½¬ | æµç¨‹å®Œæ•´ã€æ•°æ®é—­ç¯ |
| APIæ¥å£ä½“ç³» | æ¥å£è®¾è®¡ã€æ•°æ®ç»“æ„ã€é€šä¿¡åè®® | æ ‡å‡†åŒ–ã€å¯æ‰©å±• |
| ç”¨æˆ·ä¿¡æ¯åŠå…¨å±€å½¢è±¡ç³»ç»Ÿ | ç”¨æˆ·ç”»åƒã€æˆé•¿è®°å½•ã€å½¢è±¡å±•ç¤º | ä¸ªæ€§åŒ–ã€æˆé•¿æ€§ |
| ä¿¡æ¯æ˜ å°„ç³»ç»Ÿ | å†…å®¹æ˜ å°„ã€å¹´é¾„é€‚é…ã€æ–‡åŒ–èåˆ | æ™ºèƒ½åŒ¹é…ã€ç²¾å‡†æ¨é€ |

---

## äºŒã€å…¨å±€é¡µé¢ç»„ä»¶ä½“ç³»

### 2.1 ç»„ä»¶ä½“ç³»æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç³»ç»Ÿç»„ä»¶å±‚ (System Layer)               â”‚
â”‚  AIæµ®çª—ã€å…¨å±€å¯¼èˆªã€ä¸»é¢˜åˆ‡æ¢ã€æƒé™æ§åˆ¶ã€é€šçŸ¥ä¸­å¿ƒ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é¡µé¢ç»„ä»¶å±‚ (Page Layer)                   â”‚
â”‚  é¦–é¡µã€æˆé•¿è®°å½•ã€æ–‡åŒ–æ¢ç´¢ã€å­¦ä¹ ä¸­å¿ƒã€ä¸ªäººä¸­å¿ƒ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡ç»„ä»¶å±‚ (Business Layer)                â”‚
â”‚  æˆé•¿å¡ç‰‡ã€æ–‡åŒ–è½®æ’­ã€å­¦ä¹ è¿›åº¦ã€æˆå°±å¾½ç« ã€ç¤¾äº¤äº’åŠ¨             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŸºç¡€ç»„ä»¶å±‚ (Foundation Layer)              â”‚
â”‚  æŒ‰é’®ã€è¾“å…¥æ¡†ã€å¡ç‰‡ã€åˆ—è¡¨ã€å¼¹çª—ã€åŠ è½½å™¨ã€æç¤ºæ¡†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŸºç¡€ç»„ä»¶å±‚ (Foundation Layer)

#### 2.2.1 æŒ‰é’®ç»„ä»¶ (Button)

```typescript
export interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'outline' | 'ghost' | 'danger';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  loading?: boolean;
  icon?: React.ReactNode;
  fullWidth?: boolean;
  onClick?: () => void;
  children: React.ReactNode;
  className?: string;
}

export const Button: React.FC<ButtonProps> = ({
  variant = 'primary',
  size = 'medium',
  disabled = false,
  loading = false,
  icon,
  fullWidth = false,
  onClick,
  children,
  className = '',
}) => {
  const baseStyles = 'rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2';
  
  const variantStyles = {
    primary: 'bg-gradient-to-r from-purple-600 to-pink-500 text-white hover:shadow-lg hover:scale-105',
    secondary: 'bg-gray-100 text-gray-700 hover:bg-gray-200',
    outline: 'border-2 border-purple-500 text-purple-600 hover:bg-purple-50',
    ghost: 'text-gray-600 hover:bg-gray-100',
    danger: 'bg-red-500 text-white hover:bg-red-600',
  };
  
  const sizeStyles = {
    small: 'px-3 py-1.5 text-sm',
    medium: 'px-4 py-2 text-base',
    large: 'px-6 py-3 text-lg',
  };
  
  return (
    <button
      className={`${baseStyles} ${variantStyles[variant]} ${sizeStyles[size]} ${fullWidth ? 'w-full' : ''} ${disabled || loading ? 'opacity-50 cursor-not-allowed' : ''} ${className}`}
      disabled={disabled || loading}
      onClick={onClick}
    >
      {loading && <LoadingSpinner size="small" />}
      {icon && !loading && <span className="icon">{icon}</span>}
      {children}
    </button>
  );
};
```

#### 2.2.2 å¡ç‰‡ç»„ä»¶ (Card)

```typescript
export interface CardProps {
  title?: string;
  subtitle?: string;
  image?: string;
  actions?: React.ReactNode;
  onClick?: () => void;
  hoverable?: boolean;
  className?: string;
  children?: React.ReactNode;
}

export const Card: React.FC<CardProps> = ({
  title,
  subtitle,
  image,
  actions,
  onClick,
  hoverable = true,
  className = '',
  children,
}) => {
  return (
    <div
      className={`bg-white rounded-xl shadow-md overflow-hidden ${hoverable ? 'hover:shadow-xl hover:-translate-y-1 transition-all duration-300 cursor-pointer' : ''} ${onClick ? 'cursor-pointer' : ''} ${className}`}
      onClick={onClick}
    >
      {image && (
        <div className="relative h-48 overflow-hidden">
          <img
            src={image}
            alt={title}
            className="w-full h-full object-cover transition-transform duration-300 hover:scale-110"
          />
        </div>
      )}
      <div className="p-4">
        {title && (
          <Typography variant="h6" gutterBottom>
            {title}
          </Typography>
        )}
        {subtitle && (
          <Typography variant="body2" color="textSecondary" gutterBottom>
            {subtitle}
          </Typography>
        )}
        {children}
        {actions && (
          <div className="mt-4 flex gap-2 justify-end">
            {actions}
          </div>
        )}
      </div>
    </div>
  );
};
```

#### 2.2.3 è¾“å…¥æ¡†ç»„ä»¶ (Input)

```typescript
export interface InputProps {
  label?: string;
  placeholder?: string;
  type?: 'text' | 'password' | 'email' | 'number';
  value?: string;
  onChange?: (value: string) => void;
  error?: string;
  helperText?: string;
  disabled?: boolean;
  icon?: React.ReactNode;
  className?: string;
}

export const Input: React.FC<InputProps> = ({
  label,
  placeholder,
  type = 'text',
  value,
  onChange,
  error,
  helperText,
  disabled = false,
  icon,
  className = '',
}) => {
  const [focused, setFocused] = useState(false);
  
  return (
    <div className={`input-wrapper ${className}`}>
      {label && (
        <label className="block text-sm font-medium text-gray-700 mb-1">
          {label}
        </label>
      )}
      <div className={`relative flex items-center border-2 rounded-lg transition-all duration-200 ${focused ? 'border-purple-500 ring-2 ring-purple-200' : 'border-gray-300'} ${error ? 'border-red-500' : ''}`}>
        {icon && (
          <span className="absolute left-3 text-gray-400">
            {icon}
          </span>
        )}
        <input
          type={type}
          placeholder={placeholder}
          value={value}
          onChange={(e) => onChange?.(e.target.value)}
          onFocus={() => setFocused(true)}
          onBlur={() => setFocused(false)}
          disabled={disabled}
          className={`w-full px-4 py-2.5 outline-none ${icon ? 'pl-10' : ''} ${disabled ? 'bg-gray-100 cursor-not-allowed' : ''}`}
        />
      </div>
      {error && (
        <p className="text-red-500 text-sm mt-1">{error}</p>
      )}
      {helperText && !error && (
        <p className="text-gray-500 text-sm mt-1">{helperText}</p>
      )}
    </div>
  );
};
```

#### 2.2.4 åŠ è½½å™¨ç»„ä»¶ (LoadingSpinner)

```typescript
export interface LoadingSpinnerProps {
  size?: 'small' | 'medium' | 'large';
  color?: string;
  className?: string;
}

export const LoadingSpinner: React.FC<LoadingSpinnerProps> = ({
  size = 'medium',
  color = '#9333EA',
  className = '',
}) => {
  const sizeMap = {
    small: 'w-4 h-4',
    medium: 'w-8 h-8',
    large: 'w-12 h-12',
  };
  
  return (
    <div className={`flex items-center justify-center ${className}`}>
      <svg
        className={`animate-spin ${sizeMap[size]}`}
        viewBox="0 0 24 24"
      >
        <circle
          className="opacity-25"
          cx="12"
          cy="12"
          r="10"
          stroke="currentColor"
          strokeWidth="4"
          fill="none"
        />
        <path
          className="opacity-75"
          fill={color}
          d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
        />
      </svg>
    </div>
  );
};
```

#### 2.2.5 æç¤ºæ¡†ç»„ä»¶ (Toast)

```typescript
export interface ToastProps {
  type?: 'success' | 'error' | 'warning' | 'info';
  title?: string;
  message: string;
  duration?: number;
  onClose?: () => void;
}

export const Toast: React.FC<ToastProps> = ({
  type = 'info',
  title,
  message,
  duration = 3000,
  onClose,
}) => {
  const [visible, setVisible] = useState(true);
  
  useEffect(() => {
    const timer = setTimeout(() => {
      setVisible(false);
      onClose?.();
    }, duration);
    
    return () => clearTimeout(timer);
  }, [duration, onClose]);
  
  const typeConfig = {
    success: {
      icon: 'âœ“',
      bgColor: 'bg-green-500',
      textColor: 'text-white',
    },
    error: {
      icon: 'âœ•',
      bgColor: 'bg-red-500',
      textColor: 'text-white',
    },
    warning: {
      icon: 'âš ',
      bgColor: 'bg-yellow-500',
      textColor: 'text-white',
    },
    info: {
      icon: 'â„¹',
      bgColor: 'bg-blue-500',
      textColor: 'text-white',
    },
  };
  
  const config = typeConfig[type];
  
  if (!visible) return null;
  
  return (
    <div className={`fixed top-4 right-4 ${config.bgColor} ${config.textColor} px-6 py-4 rounded-lg shadow-lg z-50 animate-slide-in-right`}>
      <div className="flex items-start gap-3">
        <span className="text-xl font-bold">{config.icon}</span>
        <div>
          {title && <p className="font-semibold mb-1">{title}</p>}
          <p className="text-sm">{message}</p>
        </div>
      </div>
    </div>
  );
};
```

### 2.3 ä¸šåŠ¡ç»„ä»¶å±‚ (Business Layer)

#### 2.3.1 æˆé•¿å¡ç‰‡ç»„ä»¶ (GrowthCard)

```typescript
export interface GrowthCardProps {
  ageStage: string;
  growthData: GrowthRecord;
  onViewDetails?: () => void;
  onEdit?: () => void;
  className?: string;
}

export interface GrowthRecord {
  id: string;
  age: number;
  stage: string;
  dimensions: {
    name: string;
    progress: number;
    items: GrowthItem[];
  }[];
  achievements: Achievement[];
  lastUpdated: string;
}

export interface GrowthItem {
  id: string;
  title: string;
  description: string;
  completed: boolean;
  date?: string;
}

export interface Achievement {
  id: string;
  title: string;
  icon: string;
  earnedDate: string;
}

export const GrowthCard: React.FC<GrowthCardProps> = ({
  ageStage,
  growthData,
  onViewDetails,
  onEdit,
  className = '',
}) => {
  const overallProgress = useMemo(() => {
    const totalItems = growthData.dimensions.reduce((sum, dim) => sum + dim.items.length, 0);
    const completedItems = growthData.dimensions.reduce((sum, dim) => sum + dim.items.filter(item => item.completed).length, 0);
    return totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;
  }, [growthData]);
  
  return (
    <Card className={`growth-card ${className}`}>
      <div className="flex items-center justify-between mb-4">
        <div className="flex items-center gap-3">
          <div className="w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-lg">
            {growthData.age}
          </div>
          <div>
            <Typography variant="h6">{ageStage}</Typography>
            <Typography variant="body2" color="textSecondary">
              æœ€åæ›´æ–°: {new Date(growthData.lastUpdated).toLocaleDateString('zh-CN')}
            </Typography>
          </div>
        </div>
        <div className="text-right">
          <Typography variant="h4" color="primary">
            {overallProgress}%
          </Typography>
          <Typography variant="caption">æ€»ä½“è¿›åº¦</Typography>
        </div>
      </div>
      
      <div className="space-y-3 mb-4">
        {growthData.dimensions.slice(0, 3).map((dimension, index) => (
          <div key={index}>
            <div className="flex justify-between text-sm mb-1">
              <span>{dimension.name}</span>
              <span>{dimension.progress}%</span>
            </div>
            <div className="w-full bg-gray-200 rounded-full h-2">
              <div
                className="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-500"
                style={{ width: `${dimension.progress}%` }}
              />
            </div>
          </div>
        ))}
      </div>
      
      {growthData.achievements.length > 0 && (
        <div className="flex gap-2 mb-4">
          {growthData.achievements.slice(0, 4).map((achievement) => (
            <Tooltip key={achievement.id} title={achievement.title}>
              <div className="w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center text-2xl">
                {achievement.icon}
              </div>
            </Tooltip>
          ))}
          {growthData.achievements.length > 4 && (
            <div className="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-sm font-medium text-gray-600">
              +{growthData.achievements.length - 4}
            </div>
          )}
        </div>
      )}
      
      <div className="flex gap-2">
        <Button variant="outline" size="small" onClick={onViewDetails} fullWidth>
          æŸ¥çœ‹è¯¦æƒ…
        </Button>
        <Button variant="ghost" size="small" onClick={onEdit}>
          ç¼–è¾‘
        </Button>
      </div>
    </Card>
  );
};
```

#### 2.3.2 æ–‡åŒ–è½®æ’­ç»„ä»¶ (CultureCarousel)

```typescript
export interface CultureCarouselProps {
  items: CultureItem[];
  autoplay?: boolean;
  interval?: number;
  onItemClick?: (item: CultureItem) => void;
  className?: string;
}

export interface CultureItem {
  id: string;
  title: string;
  description: string;
  image: string;
  category: string;
  tags?: string[];
}

export const CultureCarousel: React.FC<CultureCarouselProps> = ({
  items,
  autoplay = true,
  interval = 5000,
  onItemClick,
  className = '',
}) => {
  const [currentIndex, setCurrentIndex] = useState(0);
  
  useEffect(() => {
    if (!autoplay) return;
    
    const timer = setInterval(() => {
      setCurrentIndex((prev) => (prev + 1) % items.length);
    }, interval);
    
    return () => clearInterval(timer);
  }, [autoplay, interval, items.length]);
  
  const goToSlide = (index: number) => {
    setCurrentIndex(index);
  };
  
  const goToPrevious = () => {
    setCurrentIndex((prev) => (prev - 1 + items.length) % items.length);
  };
  
  const goToNext = () => {
    setCurrentIndex((prev) => (prev + 1) % items.length);
  };
  
  const currentItem = items[currentIndex];
  
  return (
    <div className={`culture-carousel ${className}`}>
      <div
        style={{
          position: 'relative',
          width: '100%',
          height: '400px',
          borderRadius: '12px',
          overflow: 'hidden',
          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.1)',
        }}
      >
        <img
          src={currentItem.image}
          alt={currentItem.title}
          style={{
            width: '100%',
            height: '100%',
            objectFit: 'cover',
          }}
        />
        
        <div
          style={{
            position: 'absolute',
            bottom: 0,
            left: 0,
            right: 0,
            padding: '24px',
            background: 'linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent)',
            color: 'white',
          }}
        >
          <Typography variant="h5" gutterBottom style={{ color: 'white' }}>
            {currentItem.title}
          </Typography>
          <Typography variant="body2" style={{ color: 'rgba(255, 255, 255, 0.9)' }}>
            {currentItem.description}
          </Typography>
          {currentItem.tags && (
            <div className="flex gap-2 mt-2">
              {currentItem.tags.map((tag, index) => (
                <span
                  key={index}
                  className="px-2 py-1 bg-white/20 rounded text-sm"
                >
                  {tag}
                </span>
              ))}
            </div>
          )}
        </div>
        
        <button
          onClick={goToPrevious}
          className="absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/80 rounded-full flex items-center justify-center hover:bg-white transition-colors"
        >
          â€¹
        </button>
        
        <button
          onClick={goToNext}
          className="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/80 rounded-full flex items-center justify-center hover:bg-white transition-colors"
        >
          â€º
        </button>
        
        <div className="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
          {items.map((_, index) => (
            <button
              key={index}
              onClick={() => goToSlide(index)}
              className={`w-2 h-2 rounded-full transition-all ${index === currentIndex ? 'bg-white w-6' : 'bg-white/50'}`}
            />
          ))}
        </div>
      </div>
    </div>
  );
};
```

#### 2.3.3 å­¦ä¹ è¿›åº¦ç»„ä»¶ (LearningProgress)

```typescript
export interface LearningProgressProps {
  subject: string;
  progress: number;
  lessons: Lesson[];
  currentLesson?: Lesson;
  onContinue?: () => void;
  className?: string;
}

export interface Lesson {
  id: string;
  title: string;
  duration: number;
  completed: boolean;
  locked: boolean;
}

export const LearningProgress: React.FC<LearningProgressProps> = ({
  subject,
  progress,
  lessons,
  currentLesson,
  onContinue,
  className = '',
}) => {
  const completedLessons = lessons.filter(l => l.completed).length;
  const totalLessons = lessons.length;
  
  return (
    <div className={`learning-progress ${className}`}>
      <div className="bg-white rounded-xl shadow-md p-6">
        <div className="flex items-center justify-between mb-4">
          <Typography variant="h6">{subject}</Typography>
          <Typography variant="body2" color="textSecondary">
            {completedLessons}/{totalLessons} è¯¾æ—¶
          </Typography>
        </div>
        
        <div className="mb-6">
          <div className="flex justify-between text-sm mb-2">
            <span>å­¦ä¹ è¿›åº¦</span>
            <span className="font-semibold text-purple-600">{progress}%</span>
          </div>
          <div className="w-full bg-gray-200 rounded-full h-3">
            <div
              className="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500"
              style={{ width: `${progress}%` }}
            />
          </div>
        </div>
        
        {currentLesson && (
          <div className="mb-4 p-4 bg-purple-50 rounded-lg">
            <Typography variant="subtitle2" gutterBottom>
              å½“å‰è¯¾ç¨‹
            </Typography>
            <Typography variant="h6" gutterBottom>
              {currentLesson.title}
            </Typography>
            <div className="flex items-center gap-4 text-sm text-gray-600">
              <span>â± {currentLesson.duration}åˆ†é’Ÿ</span>
              <span>ğŸ“š è¿›è¡Œä¸­</span>
            </div>
          </div>
        )}
        
        <div className="space-y-2 max-h-48 overflow-y-auto">
          {lessons.slice(0, 5).map((lesson, index) => (
            <div
              key={lesson.id}
              className={`flex items-center gap-3 p-3 rounded-lg ${lesson.completed ? 'bg-green-50' : lesson.locked ? 'bg-gray-50 opacity-60' : 'bg-white'}`}
            >
              <div className={`w-8 h-8 rounded-full flex items-center justify-center ${lesson.completed ? 'bg-green-500 text-white' : lesson.locked ? 'bg-gray-300 text-gray-600' : 'bg-purple-100 text-purple-600'}`}>
                {lesson.completed ? 'âœ“' : lesson.locked ? 'ğŸ”’' : index + 1}
              </div>
              <div className="flex-1">
                <Typography variant="body2" className={lesson.locked ? 'text-gray-500' : ''}>
                  {lesson.title}
                </Typography>
              </div>
              <Typography variant="caption" color="textSecondary">
                {lesson.duration}åˆ†é’Ÿ
              </Typography>
            </div>
          ))}
        </div>
        
        {onContinue && currentLesson && (
          <Button
            variant="primary"
            fullWidth
            onClick={onContinue}
            className="mt-4"
          >
            ç»§ç»­å­¦ä¹ 
          </Button>
        )}
      </div>
    </div>
  );
};
```

#### 2.3.4 æˆå°±å¾½ç« ç»„ä»¶ (AchievementBadge)

```typescript
export interface AchievementBadgeProps {
  achievement: Achievement;
  size?: 'small' | 'medium' | 'large';
  showTooltip?: boolean;
  onClick?: () => void;
  className?: string;
}

export const AchievementBadge: React.FC<AchievementBadgeProps> = ({
  achievement,
  size = 'medium',
  showTooltip = true,
  onClick,
  className = '',
}) => {
  const sizeMap = {
    small: 'w-8 h-8 text-lg',
    medium: 'w-12 h-12 text-2xl',
    large: 'w-16 h-16 text-3xl',
  };
  
  const badge = (
    <div
      className={`achievement-badge ${sizeMap[size]} rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center shadow-lg cursor-pointer hover:scale-110 transition-transform ${className}`}
      onClick={onClick}
    >
      <span>{achievement.icon}</span>
    </div>
  );
  
  if (showTooltip) {
    return (
      <Tooltip title={`${achievement.title} - ${new Date(achievement.earnedDate).toLocaleDateString('zh-CN')}`}>
        {badge}
      </Tooltip>
    );
  }
  
  return badge;
};
```

#### 2.3.5 ç¤¾äº¤äº’åŠ¨ç»„ä»¶ (SocialInteraction)

```typescript
export interface SocialInteractionProps {
  postId: string;
  likes: number;
  comments: number;
  shares: number;
  liked?: boolean;
  onLike?: () => void;
  onComment?: () => void;
  onShare?: () => void;
  className?: string;
}

export const SocialInteraction: React.FC<SocialInteractionProps> = ({
  postId,
  likes,
  comments,
  shares,
  liked = false,
  onLike,
  onComment,
  onShare,
  className = '',
}) => {
  return (
    <div className={`social-interaction flex items-center gap-4 ${className}`}>
      <button
        onClick={onLike}
        className={`flex items-center gap-2 px-4 py-2 rounded-full transition-colors ${liked ? 'bg-red-100 text-red-600' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}
      >
        <span className="text-xl">{liked ? 'â¤ï¸' : 'ğŸ¤'}</span>
        <span className="font-medium">{likes}</span>
      </button>
      
      <button
        onClick={onComment}
        className="flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors"
      >
        <span className="text-xl">ğŸ’¬</span>
        <span className="font-medium">{comments}</span>
      </button>
      
      <button
        onClick={onShare}
        className="flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors"
      >
        <span className="text-xl">ğŸ“¤</span>
        <span className="font-medium">{shares}</span>
      </button>
    </div>
  );
};
```

### 2.4 é¡µé¢ç»„ä»¶å±‚ (Page Layer)

#### 2.4.1 é¦–é¡µç»„ä»¶ (HomePage)

```typescript
export interface HomePageProps {
  userData: UserData;
  growthData: GrowthRecord;
  cultureItems: CultureItem[];
  learningProgress: LearningProgress[];
  recommendations: Recommendation[];
  onNavigate: (page: string) => void;
}

export const HomePage: React.FC<HomePageProps> = ({
  userData,
  growthData,
  cultureItems,
  learningProgress,
  recommendations,
  onNavigate,
}) => {
  return (
    <div className="home-page">
      <Header userData={userData} />
      
      <main className="container mx-auto px-4 py-8">
        <WelcomeSection userData={userData} />
        
        <section className="mb-8">
          <SectionTitle title="æˆé•¿è®°å½•" onMore={() => onNavigate('growth')} />
          <GrowthCard
            ageStage={growthData.stage}
            growthData={growthData}
            onViewDetails={() => onNavigate('growth')}
          />
        </section>
        
        <section className="mb-8">
          <SectionTitle title="æ²³æ´›æ–‡åŒ–æ¢ç´¢" onMore={() => onNavigate('culture')} />
          <CultureCarousel items={cultureItems} />
        </section>
        
        <section className="mb-8">
          <SectionTitle title="å­¦ä¹ è¿›åº¦" onMore={() => onNavigate('learning')} />
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {learningProgress.map((progress, index) => (
              <LearningProgress key={index} {...progress} />
            ))}
          </div>
        </section>
        
        <section className="mb-8">
          <SectionTitle title="ä¸ºä½ æ¨è" />
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            {recommendations.map((rec, index) => (
              <RecommendationCard key={index} {...rec} />
            ))}
          </div>
        </section>
      </main>
      
      <Footer />
    </div>
  );
};
```

#### 2.4.2 æˆé•¿è®°å½•é¡µç»„ä»¶ (GrowthPage)

```typescript
export interface GrowthPageProps {
  growthData: GrowthRecord[];
  selectedAge?: number;
  onSelectAge: (age: number) => void;
  onEditRecord: (recordId: string) => void;
}

export const GrowthPage: React.FC<GrowthPageProps> = ({
  growthData,
  selectedAge,
  onSelectAge,
  onEditRecord,
}) => {
  const [viewMode, setViewMode] = useState<'timeline' | 'cards'>('cards');
  
  return (
    <div className="growth-page">
      <Header />
      
      <main className="container mx-auto px-4 py-8">
        <PageTitle title="æˆé•¿è®°å½•" subtitle="è®°å½•æ¯ä¸€ä¸ªæˆé•¿çš„ç¬é—´" />
        
        <div className="mb-6">
          <AgeSelector
            ages={growthData.map(d => d.age)}
            selectedAge={selectedAge}
            onSelectAge={onSelectAge}
          />
        </div>
        
        <div className="mb-6 flex justify-end">
          <ViewToggle
            mode={viewMode}
            onChange={setViewMode}
          />
        </div>
        
        {viewMode === 'cards' ? (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {growthData.map((data, index) => (
              <GrowthCard
                key={index}
                ageStage={data.stage}
                growthData={data}
                onViewDetails={() => onSelectAge(data.age)}
                onEdit={() => onEditRecord(data.id)}
              />
            ))}
          </div>
        ) : (
          <GrowthTimeline growthData={growthData} />
        )}
      </main>
      
      <Footer />
    </div>
  );
};
```

#### 2.4.3 æ–‡åŒ–æ¢ç´¢é¡µç»„ä»¶ (CulturePage)

```typescript
export interface CulturePageProps {
  cultureItems: CultureItem[];
  categories: CultureCategory[];
  selectedCategory?: string;
  onSelectCategory: (category: string) => void;
  onItemClick: (item: CultureItem) => void;
}

export const CulturePage: React.FC<CulturePageProps> = ({
  cultureItems,
  categories,
  selectedCategory,
  onSelectCategory,
  onItemClick,
}) => {
  const filteredItems = selectedCategory
    ? cultureItems.filter(item => item.category === selectedCategory)
    : cultureItems;
  
  return (
    <div className="culture-page">
      <Header />
      
      <main className="container mx-auto px-4 py-8">
        <PageTitle title="æ²³æ´›æ–‡åŒ–æ¢ç´¢" subtitle="æ¢ç´¢æ´›é˜³åƒå¹´æ–‡åŒ–åº•è•´" />
        
        <div className="mb-6">
          <CategoryFilter
            categories={categories}
            selectedCategory={selectedCategory}
            onSelectCategory={onSelectCategory}
          />
        </div>
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredItems.map((item, index) => (
            <CultureCard
              key={index}
              item={item}
              onClick={() => onItemClick(item)}
            />
          ))}
        </div>
      </main>
      
      <Footer />
    </div>
  );
};
```

### 2.5 ç³»ç»Ÿç»„ä»¶å±‚ (System Layer)

#### 2.5.1 AIæµ®çª—ç»„ä»¶ (AIFloatWindow)

```typescript
export interface AIFloatWindowProps {
  initialPosition?: { x: number; y: number };
  size?: { width: number; height: number };
  theme?: 'light' | 'dark';
  onInteraction?: (type: string, data?: any) => void;
  className?: string;
}

export const AIFloatWindow: React.FC<AIFloatWindowProps> = ({
  initialPosition = { x: 100, y: 100 },
  size = { width: 60, height: 60 },
  theme = 'light',
  onInteraction,
  className = '',
}) => {
  const [position, setPosition] = useState(initialPosition);
  const [isDragging, setIsDragging] = useState(false);
  const [isExpanded, setIsExpanded] = useState(false);
  const [isListening, setIsListening] = useState(false);
  const floatWindowRef = useRef<HTMLDivElement>(null);
  
  const handleMouseDown = (e: React.MouseEvent) => {
    if (isExpanded) return;
    setIsDragging(true);
    const startX = e.clientX - position.x;
    const startY = e.clientY - position.y;
    
    const handleMouseMove = (e: MouseEvent) => {
      setPosition({
        x: e.clientX - startX,
        y: e.clientY - startY,
      });
    };
    
    const handleMouseUp = () => {
      setIsDragging(false);
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
    };
    
    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  };
  
  const toggleExpanded = () => {
    setIsExpanded(!isExpanded);
    onInteraction?.('toggle-expanded', { expanded: !isExpanded });
  };
  
  const handleVoiceClick = () => {
    setIsListening(!isListening);
    onInteraction?.('voice-click', { listening: !isListening });
  };
  
  return (
    <motion.div
      ref={floatWindowRef}
      className={`ai-float-window theme-${theme} ${className}`}
      style={{
        position: 'fixed',
        left: position.x,
        top: position.y,
        width: isExpanded ? 320 : size.width,
        height: isExpanded ? 480 : size.height,
        zIndex: 9999,
        borderRadius: isExpanded ? '16px' : '50%',
        boxShadow: '0 8px 32px rgba(0, 0, 0, 0.15)',
        backdropFilter: 'blur(10px)',
        background: theme === 'light' ? 'rgba(255, 255, 255, 0.95)' : 'rgba(30, 30, 30, 0.95)',
      }}
      initial={{ scale: 0 }}
      animate={{ scale: 1 }}
      transition={{ duration: 0.3 }}
      onMouseDown={handleMouseDown}
    >
      {isExpanded ? (
        <div className="float-window-expanded h-full flex flex-col">
          <div className="p-4 border-b flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white">
                ğŸ¤–
              </div>
              <div>
                <Typography variant="subtitle1">å°è¯­AIåŠ©æ‰‹</Typography>
                <Typography variant="caption" color="textSecondary">
                  {isListening ? 'æ­£åœ¨è†å¬...' : 'éšæ—¶ä¸ºæ‚¨æœåŠ¡'}
                </Typography>
              </div>
            </div>
            <IconButton onClick={toggleExpanded}>
              âœ•
            </IconButton>
          </div>
          
          <div className="flex-1 overflow-y-auto p-4">
            <ChatMessageList />
          </div>
          
          <div className="p-4 border-t">
            <div className="flex items-center gap-2">
              <Input
                placeholder="è¾“å…¥æ¶ˆæ¯..."
                className="flex-1"
              />
              <VoiceButton
                isListening={isListening}
                onClick={handleVoiceClick}
              />
              <Button variant="primary" size="small">
                å‘é€
              </Button>
            </div>
          </div>
        </div>
      ) : (
        <div className="float-window-minimized w-full h-full flex items-center justify-center cursor-pointer" onClick={toggleExpanded}>
          <div className="relative">
            <div className="w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-2xl shadow-lg">
              ğŸ¤–
            </div>
            <NotificationBadge count={3} />
          </div>
        </div>
      )}
    </motion.div>
  );
};
```

#### 2.5.2 å…¨å±€å¯¼èˆªç»„ä»¶ (GlobalNavigation)

```typescript
export interface GlobalNavigationProps {
  currentPage: string;
  onNavigate: (page: string) => void;
  className?: string;
}

export const GlobalNavigation: React.FC<GlobalNavigationProps> = ({
  currentPage,
  onNavigate,
  className = '',
}) => {
  const navItems = [
    { id: 'home', label: 'é¦–é¡µ', icon: 'ğŸ ' },
    { id: 'growth', label: 'æˆé•¿è®°å½•', icon: 'ğŸ“Š' },
    { id: 'culture', label: 'æ–‡åŒ–æ¢ç´¢', icon: 'ğŸ›ï¸' },
    { id: 'learning', label: 'å­¦ä¹ ä¸­å¿ƒ', icon: 'ğŸ“š' },
    { id: 'profile', label: 'ä¸ªäººä¸­å¿ƒ', icon: 'ğŸ‘¤' },
  ];
  
  return (
    <nav className={`global-navigation fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg ${className}`}>
      <div className="container mx-auto px-4">
        <div className="flex justify-around items-center h-16">
          {navItems.map((item) => (
            <button
              key={item.id}
              onClick={() => onNavigate(item.id)}
              className={`flex flex-col items-center gap-1 px-4 py-2 rounded-lg transition-colors ${currentPage === item.id ? 'text-purple-600' : 'text-gray-500 hover:text-gray-700'}`}
            >
              <span className="text-2xl">{item.icon}</span>
              <span className="text-xs font-medium">{item.label}</span>
            </button>
          ))}
        </div>
      </div>
    </nav>
  );
};
```

#### 2.5.3 ä¸»é¢˜åˆ‡æ¢ç»„ä»¶ (ThemeToggle)

```typescript
export interface ThemeToggleProps {
  theme: 'light' | 'dark';
  onToggle: (theme: 'light' | 'dark') => void;
  className?: string;
}

export const ThemeToggle: React.FC<ThemeToggleProps> = ({
  theme,
  onToggle,
  className = '',
}) => {
  return (
    <button
      onClick={() => onToggle(theme === 'light' ? 'dark' : 'light')}
      className={`theme-toggle w-10 h-10 rounded-full flex items-center justify-center transition-all ${theme === 'light' ? 'bg-gray-100 hover:bg-gray-200' : 'bg-gray-700 hover:bg-gray-600'} ${className}`}
    >
      <span className="text-xl">{theme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™'}</span>
    </button>
  );
};
```

#### 2.5.4 é€šçŸ¥ä¸­å¿ƒç»„ä»¶ (NotificationCenter)

```typescript
export interface NotificationCenterProps {
  notifications: Notification[];
  onMarkAsRead: (id: string) => void;
  onClearAll: () => void;
  className?: string;
}

export interface Notification {
  id: string;
  type: 'info' | 'success' | 'warning' | 'error';
  title: string;
  message: string;
  timestamp: string;
  read: boolean;
}

export const NotificationCenter: React.FC<NotificationCenterProps> = ({
  notifications,
  onMarkAsRead,
  onClearAll,
  className = '',
}) => {
  const [isOpen, setIsOpen] = useState(false);
  const unreadCount = notifications.filter(n => !n.read).length;
  
  return (
    <div className={`notification-center relative ${className}`}>
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="relative w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors"
      >
        <span className="text-xl">ğŸ””</span>
        {unreadCount > 0 && (
          <NotificationBadge count={unreadCount} />
        )}
      </button>
      
      {isOpen && (
        <div className="absolute right-0 top-12 w-80 bg-white rounded-xl shadow-xl border overflow-hidden z-50">
          <div className="p-4 border-b flex items-center justify-between">
            <Typography variant="subtitle1">é€šçŸ¥ä¸­å¿ƒ</Typography>
            <Button variant="ghost" size="small" onClick={onClearAll}>
              æ¸…ç©ºå…¨éƒ¨
            </Button>
          </div>
          
          <div className="max-h-96 overflow-y-auto">
            {notifications.length === 0 ? (
              <div className="p-8 text-center text-gray-500">
                <p>æš‚æ— é€šçŸ¥</p>
              </div>
            ) : (
              notifications.map((notification) => (
                <NotificationItem
                  key={notification.id}
                  notification={notification}
                  onRead={() => onMarkAsRead(notification.id)}
                />
              ))
            )}
          </div>
        </div>
      )}
    </div>
  );
};
```

---

## ä¸‰ã€åˆ†å±‚å¼æ¶æ„ä½“ç³»

### 3.1 äº”å±‚æ¶æ„æ¨¡å‹

å°è¯­AIåº”ç”¨é‡‡ç”¨äº”å±‚æ¶æ„æ¨¡å‹ï¼Œç¡®ä¿ç»„ä»¶å±‚æ¬¡æ¸…æ™°ã€èŒè´£æ˜ç¡®ã€æ˜“äºç»´æŠ¤ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åº”ç”¨å±‚ (Application Layer)                  â”‚
â”‚  åº”ç”¨å…¥å£ã€è·¯ç”±é…ç½®ã€å…¨å±€çŠ¶æ€ç®¡ç†ã€ä¸»é¢˜é…ç½®                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é¡µé¢å±‚ (Page Layer)                         â”‚
â”‚  é¡µé¢çº§ç»„ä»¶ã€é¡µé¢å¸ƒå±€ã€é¡µé¢çŠ¶æ€ç®¡ç†ã€é¡µé¢äº¤äº’é€»è¾‘             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¸ƒå±€å±‚ (Layout Layer)                       â”‚
â”‚  é¡µé¢å¸ƒå±€ç»„ä»¶ã€å“åº”å¼å¸ƒå±€ã€å¯¼èˆªæ ã€ä¾§è¾¹æ ã€åº•éƒ¨æ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç»„ä»¶å±‚ (Component Layer)                     â”‚
â”‚  ä¸šåŠ¡ç»„ä»¶ã€å¤åˆç»„ä»¶ã€åŠŸèƒ½ç»„ä»¶ã€UIç»„ä»¶                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åŸºç¡€å±‚ (Foundation Layer)                    â”‚
â”‚  åŸºç¡€UIç»„ä»¶ã€å·¥å…·å‡½æ•°ã€å¸¸é‡å®šä¹‰ã€ç±»å‹å®šä¹‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åº”ç”¨å±‚ (Application Layer)

#### 3.2.1 åº”ç”¨å…¥å£ (App Entry)

```typescript
// src/app/layout.tsx
import { Provider } from 'react-redux';
import { store } from '@/store';
import { ThemeProvider } from '@/components/ThemeProvider';
import { AIFloatWindow } from '@/components/AIFloatWindow';
import { GlobalNavigation } from '@/components/GlobalNavigation';
import '@/styles/globals.css';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="zh-CN">
      <body>
        <Provider store={store}>
          <ThemeProvider>
            {children}
            <AIFloatWindow />
            <GlobalNavigation />
          </ThemeProvider>
        </Provider>
      </body>
    </html>
  );
}
```

#### 3.2.2 è·¯ç”±é…ç½® (Router Configuration)

```typescript
// src/app/router.tsx
import { createBrowserRouter } from 'react-router-dom';
import HomePage from '@/pages/HomePage';
import GrowthPage from '@/pages/GrowthPage';
import CulturePage from '@/pages/CulturePage';
import LearningPage from '@/pages/LearningPage';
import ProfilePage from '@/pages/ProfilePage';

export const router = createBrowserRouter([
  {
    path: '/',
    element: <HomePage />,
  },
  {
    path: '/growth',
    element: <GrowthPage />,
  },
  {
    path: '/culture',
    element: <CulturePage />,
  },
  {
    path: '/learning',
    element: <LearningPage />,
  },
  {
    path: '/profile',
    element: <ProfilePage />,
  },
]);
```

#### 3.2.3 å…¨å±€çŠ¶æ€ç®¡ç† (Global State Management)

```typescript
// src/store/index.ts
import { configureStore } from '@reduxjs/toolkit';
import userReducer from './slices/userSlice';
import themeReducer from './slices/themeSlice';
import aiReducer from './slices/aiSlice';
import growthReducer from './slices/growthSlice';

export const store = configureStore({
  reducer: {
    user: userReducer,
    theme: themeReducer,
    ai: aiReducer,
    growth: growthReducer,
  },
});

export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

### 3.3 é¡µé¢å±‚ (Page Layer)

#### 3.3.1 é¡µé¢ç»„ä»¶è§„èŒƒ

æ‰€æœ‰é¡µé¢ç»„ä»¶å¿…é¡»éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

1. **æ–‡ä»¶å‘½å**: é‡‡ç”¨PascalCaseï¼Œå¦‚`HomePage.tsx`
2. **Propsæ¥å£**: å®šä¹‰æ˜ç¡®çš„Propsæ¥å£ï¼Œä½¿ç”¨TypeScriptç±»å‹
3. **çŠ¶æ€ç®¡ç†**: ä½¿ç”¨React Hooksæˆ–Reduxè¿›è¡ŒçŠ¶æ€ç®¡ç†
4. **ç”Ÿå‘½å‘¨æœŸ**: ä½¿ç”¨useEffectå¤„ç†å‰¯ä½œç”¨
5. **é”™è¯¯å¤„ç†**: å®ç°é”™è¯¯è¾¹ç•Œå’Œé”™è¯¯å¤„ç†é€»è¾‘

```typescript
// src/pages/HomePage.tsx
import { useEffect, useState } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { RootState, AppDispatch } from '@/store';
import { fetchUserData } from '@/store/slices/userSlice';
import { fetchGrowthData } from '@/store/slices/growthSlice';
import { Header } from '@/components/Header';
import { WelcomeSection } from '@/components/WelcomeSection';
import { GrowthCard } from '@/components/GrowthCard';
import { CultureCarousel } from '@/components/CultureCarousel';
import { LearningProgress } from '@/components/LearningProgress';
import { RecommendationCard } from '@/components/RecommendationCard';
import { SectionTitle } from '@/components/SectionTitle';
import { Footer } from '@/components/Footer';

export default function HomePage() {
  const dispatch = useDispatch<AppDispatch>();
  const { userData, loading: userLoading } = useSelector((state: RootState) => state.user);
  const { growthData, loading: growthLoading } = useSelector((state: RootState) => state.growth);
  
  useEffect(() => {
    dispatch(fetchUserData());
    dispatch(fetchGrowthData());
  }, [dispatch]);
  
  if (userLoading || growthLoading) {
    return <LoadingPage />;
  }
  
  return (
    <div className="home-page">
      <Header userData={userData} />
      
      <main className="container mx-auto px-4 py-8">
        <WelcomeSection userData={userData} />
        
        <section className="mb-8">
          <SectionTitle title="æˆé•¿è®°å½•" onMore={() => {}} />
          <GrowthCard
            ageStage={growthData.stage}
            growthData={growthData}
            onViewDetails={() => {}}
          />
        </section>
        
        <section className="mb-8">
          <SectionTitle title="æ²³æ´›æ–‡åŒ–æ¢ç´¢" onMore={() => {}} />
          <CultureCarousel items={[]} />
        </section>
        
        <section className="mb-8">
          <SectionTitle title="å­¦ä¹ è¿›åº¦" onMore={() => {}} />
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <LearningProgress subject="è¯­æ–‡" progress={75} lessons={[]} />
            <LearningProgress subject="æ•°å­¦" progress={60} lessons={[]} />
            <LearningProgress subject="è‹±è¯­" progress={45} lessons={[]} />
          </div>
        </section>
      </main>
      
      <Footer />
    </div>
  );
}
```

### 3.4 å¸ƒå±€å±‚ (Layout Layer)

#### 3.4.1 å“åº”å¼å¸ƒå±€ç»„ä»¶

```typescript
// src/components/layouts/ResponsiveLayout.tsx
export interface ResponsiveLayoutProps {
  children: React.ReactNode;
  maxWidth?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
  padding?: boolean;
  className?: string;
}

export const ResponsiveLayout: React.FC<ResponsiveLayoutProps> = ({
  children,
  maxWidth = 'lg',
  padding = true,
  className = '',
}) => {
  const maxWidthMap = {
    sm: 'max-w-sm',
    md: 'max-w-md',
    lg: 'max-w-4xl',
    xl: 'max-w-6xl',
    full: 'max-w-full',
  };
  
  return (
    <div className={`responsive-layout mx-auto ${maxWidthMap[maxWidth]} ${padding ? 'px-4' : ''} ${className}`}>
      {children}
    </div>
  );
};
```

#### 3.4.2 ç½‘æ ¼å¸ƒå±€ç»„ä»¶

```typescript
// src/components/layouts/GridLayout.tsx
export interface GridLayoutProps {
  children: React.ReactNode;
  cols?: 1 | 2 | 3 | 4 | 6 | 12;
  gap?: number;
  responsive?: {
    sm?: number;
    md?: number;
    lg?: number;
    xl?: number;
  };
  className?: string;
}

export const GridLayout: React.FC<GridLayoutProps> = ({
  children,
  cols = 1,
  gap = 4,
  responsive,
  className = '',
}) => {
  const getGridClasses = () => {
    let classes = `grid gap-${gap}`;
    
    if (responsive) {
      classes += ` grid-cols-${responsive.sm || 1}`;
      classes += ` md:grid-cols-${responsive.md || cols}`;
      classes += ` lg:grid-cols-${responsive.lg || cols}`;
      classes += ` xl:grid-cols-${responsive.xl || cols}`;
    } else {
      classes += ` grid-cols-${cols}`;
    }
    
    return classes;
  };
  
  return (
    <div className={getGridClasses()}>
      {children}
    </div>
  );
};
```

### 3.5 ç»„ä»¶å±‚ (Component Layer)

#### 3.5.1 ç»„ä»¶åˆ†ç±»

ç»„ä»¶å±‚åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

| ç»„ä»¶ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|---------|------|------|
| ä¸šåŠ¡ç»„ä»¶ | ä¸å…·ä½“ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ç»„ä»¶ | GrowthCard, LearningProgress |
| å¤åˆç»„ä»¶ | ç”±å¤šä¸ªåŸºç¡€ç»„ä»¶ç»„åˆè€Œæˆ | CultureCarousel, SocialInteraction |
| åŠŸèƒ½ç»„ä»¶ | å®ç°ç‰¹å®šåŠŸèƒ½çš„ç»„ä»¶ | AIFloatWindow, NotificationCenter |
| UIç»„ä»¶ | çº¯UIå±•ç¤ºç»„ä»¶ | Button, Card, Input |

#### 3.5.2 ç»„ä»¶å¼€å‘è§„èŒƒ

æ‰€æœ‰ç»„ä»¶å¿…é¡»éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

1. **Propsæ¥å£**: ä½¿ç”¨TypeScriptå®šä¹‰æ˜ç¡®çš„Propsæ¥å£
2. **é»˜è®¤å€¼**: ä¸ºå¯é€‰Propsæä¾›åˆç†çš„é»˜è®¤å€¼
3. **æ ·å¼**: ä½¿ç”¨Tailwind CSSæˆ–styled-components
4. **å¯è®¿é—®æ€§**: éµå¾ªWCAG 2.1æ ‡å‡†
5. **æµ‹è¯•**: ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

```typescript
// src/components/GrowthCard.tsx
import React from 'react';
import { Card } from './Card';
import { Button } from './Button';
import { Typography } from './Typography';
import { Tooltip } from './Tooltip';

export interface GrowthCardProps {
  ageStage: string;
  growthData: GrowthRecord;
  onViewDetails?: () => void;
  onEdit?: () => void;
  className?: string;
}

export const GrowthCard: React.FC<GrowthCardProps> = ({
  ageStage,
  growthData,
  onViewDetails,
  onEdit,
  className = '',
}) => {
  return (
    <Card className={`growth-card ${className}`}>
    </Card>
  );
};
```

### 3.6 åŸºç¡€å±‚ (Foundation Layer)

#### 3.6.1 åŸºç¡€UIç»„ä»¶

åŸºç¡€å±‚æä¾›æ‰€æœ‰åŸºç¡€UIç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼š

- Buttonï¼ˆæŒ‰é’®ï¼‰
- Inputï¼ˆè¾“å…¥æ¡†ï¼‰
- Cardï¼ˆå¡ç‰‡ï¼‰
- Listï¼ˆåˆ—è¡¨ï¼‰
- Modalï¼ˆå¼¹çª—ï¼‰
- Loadingï¼ˆåŠ è½½å™¨ï¼‰
- Toastï¼ˆæç¤ºæ¡†ï¼‰
- Tooltipï¼ˆå·¥å…·æç¤ºï¼‰

#### 3.6.2 å·¥å…·å‡½æ•°

```typescript
// src/utils/helpers.ts
export const formatDate = (date: Date | string): string => {
  const d = typeof date === 'string' ? new Date(date) : date;
  return d.toLocaleDateString('zh-CN');
};

export const formatTime = (seconds: number): string => {
  const minutes = Math.floor(seconds / 60);
  const remainingSeconds = seconds % 60;
  return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
};

export const calculateProgress = (completed: number, total: number): number => {
  return total > 0 ? Math.round((completed / total) * 100) : 0;
};

export const debounce = <T extends (...args: any[]) => any>(
  func: T,
  wait: number
): ((...args: Parameters<T>) => void) => {
  let timeout: NodeJS.Timeout;
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
};
```

#### 3.6.3 ç±»å‹å®šä¹‰

```typescript
// src/types/index.ts
export interface User {
  id: string;
  name: string;
  age: number;
  avatar: string;
  growthStage: string;
}

export interface GrowthRecord {
  id: string;
  age: number;
  stage: string;
  dimensions: GrowthDimension[];
  achievements: Achievement[];
  lastUpdated: string;
}

export interface GrowthDimension {
  name: string;
  progress: number;
  items: GrowthItem[];
}

export interface GrowthItem {
  id: string;
  title: string;
  description: string;
  completed: boolean;
  date?: string;
}

export interface Achievement {
  id: string;
  title: string;
  icon: string;
  earnedDate: string;
}

export interface CultureItem {
  id: string;
  title: string;
  description: string;
  image: string;
  category: string;
  tags?: string[];
}

export interface Lesson {
  id: string;
  title: string;
  duration: number;
  completed: boolean;
  locked: boolean;
}

export interface Notification {
  id: string;
  type: 'info' | 'success' | 'warning' | 'error';
  title: string;
  message: string;
  timestamp: string;
  read: boolean;
}
```

---

## å››ã€AIå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿ

### 4.1 ç³»ç»Ÿæ¶æ„

AIå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å­ç³»ç»Ÿï¼Œå…·å¤‡å®Œæ•´çš„äº¤äº’èƒ½åŠ›ã€çŠ¶æ€ç®¡ç†å’Œæ™ºèƒ½æ¨èåŠŸèƒ½ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AIå¼¹çª—ç‹¬ç«‹è‡ªæ²»ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              äº¤äº’å±‚ (Interaction Layer)              â”‚   â”‚
â”‚  â”‚  è¯­éŸ³äº¤äº’ã€æ–‡æœ¬äº¤äº’ã€æ‰‹åŠ¿äº¤äº’ã€è¡¨æƒ…äº¤äº’               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              çŠ¶æ€å±‚ (State Layer)                     â”‚   â”‚
â”‚  â”‚  å±•å¼€/æ”¶èµ·çŠ¶æ€ã€ä½ç½®çŠ¶æ€ã€å¯¹è¯çŠ¶æ€ã€ç›‘å¬çŠ¶æ€         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              æ™ºèƒ½å±‚ (Intelligence Layer)               â”‚   â”‚
â”‚  â”‚  æ™ºèƒ½æ¨èã€ä¸Šä¸‹æ–‡ç†è§£ã€æ„å›¾è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æ             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              æ•°æ®å±‚ (Data Layer)                      â”‚   â”‚
â”‚  â”‚  å¯¹è¯å†å²ã€ç”¨æˆ·ç”»åƒã€çŸ¥è¯†åº“ã€é…ç½®å‚æ•°                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 äº¤äº’å±‚ (Interaction Layer)

#### 4.2.1 è¯­éŸ³äº¤äº’ç»„ä»¶

```typescript
// src/components/ai/VoiceInteraction.tsx
export interface VoiceInteractionProps {
  onVoiceInput: (text: string) => void;
  onError: (error: Error) => void;
  className?: string;
}

export const VoiceInteraction: React.FC<VoiceInteractionProps> = ({
  onVoiceInput,
  onError,
  className = '',
}) => {
  const [isListening, setIsListening] = useState(false);
  const [transcript, setTranscript] = useState('');
  const recognitionRef = useRef<any>(null);
  
  useEffect(() => {
    if ('webkitSpeechRecognition' in window) {
      const recognition = new (window as any).webkitSpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = 'zh-CN';
      
      recognition.onresult = (event: any) => {
        let interimTranscript = '';
        let finalTranscript = '';
        
        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript;
          } else {
            interimTranscript += transcript;
          }
        }
        
        setTranscript(finalTranscript || interimTranscript);
        
        if (finalTranscript) {
          onVoiceInput(finalTranscript);
        }
      };
      
      recognition.onerror = (event: any) => {
        onError(new Error(event.error));
        setIsListening(false);
      };
      
      recognitionRef.current = recognition;
    }
  }, [onVoiceInput, onError]);
  
  const toggleListening = () => {
    if (isListening) {
      recognitionRef.current?.stop();
    } else {
      recognitionRef.current?.start();
    }
    setIsListening(!isListening);
  };
  
  return (
    <div className={`voice-interaction ${className}`}>
      <button
        onClick={toggleListening}
        className={`w-16 h-16 rounded-full flex items-center justify-center transition-all ${isListening ? 'bg-red-500 animate-pulse' : 'bg-purple-500 hover:bg-purple-600'}`}
      >
        <span className="text-3xl text-white">
          {isListening ? 'ğŸ¤' : 'ğŸ™ï¸'}
        </span>
      </button>
      {transcript && (
        <div className="mt-2 p-2 bg-gray-100 rounded text-sm">
          {transcript}
        </div>
      )}
    </div>
  );
};
```

#### 4.2.2 æ–‡æœ¬äº¤äº’ç»„ä»¶

```typescript
// src/components/ai/TextInteraction.tsx
export interface TextInteractionProps {
  onSend: (message: string) => void;
  placeholder?: string;
  disabled?: boolean;
  className?: string;
}

export const TextInteraction: React.FC<TextInteractionProps> = ({
  onSend,
  placeholder = 'è¾“å…¥æ¶ˆæ¯...',
  disabled = false,
  className = '',
}) => {
  const [message, setMessage] = useState('');
  const inputRef = useRef<HTMLInputElement>(null);
  
  const handleSend = () => {
    if (message.trim()) {
      onSend(message.trim());
      setMessage('');
    }
  };
  
  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  };
  
  return (
    <div className={`text-interaction flex items-center gap-2 ${className}`}>
      <input
        ref={inputRef}
        type="text"
        value={message}
        onChange={(e) => setMessage(e.target.value)}
        onKeyPress={handleKeyPress}
        placeholder={placeholder}
        disabled={disabled}
        className="flex-1 px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
      />
      <Button
        variant="primary"
        onClick={handleSend}
        disabled={!message.trim() || disabled}
      >
        å‘é€
      </Button>
    </div>
  );
};
```

### 4.3 çŠ¶æ€å±‚ (State Layer)

#### 4.3.1 AIå¼¹çª—çŠ¶æ€ç®¡ç†

```typescript
// src/store/slices/aiSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

export interface AIState {
  isExpanded: boolean;
  position: { x: number; y: number };
  isListening: boolean;
  messages: ChatMessage[];
  context: AIContext;
  recommendations: Recommendation[];
}

export interface ChatMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: string;
  type?: 'text' | 'voice' | 'image';
}

export interface AIContext {
  currentAge: number;
  currentStage: string;
  recentTopics: string[];
  userPreferences: Record<string, any>;
}

export interface Recommendation {
  id: string;
  type: 'content' | 'action' | 'question';
  title: string;
  description: string;
  action?: () => void;
}

const initialState: AIState = {
  isExpanded: false,
  position: { x: 100, y: 100 },
  isListening: false,
  messages: [],
  context: {
    currentAge: 0,
    currentStage: '',
    recentTopics: [],
    userPreferences: {},
  },
  recommendations: [],
};

const aiSlice = createSlice({
  name: 'ai',
  initialState,
  reducers: {
    toggleExpanded: (state) => {
      state.isExpanded = !state.isExpanded;
    },
    setExpanded: (state, action: PayloadAction<boolean>) => {
      state.isExpanded = action.payload;
    },
    setPosition: (state, action: PayloadAction<{ x: number; y: number }>) => {
      state.position = action.payload;
    },
    setListening: (state, action: PayloadAction<boolean>) => {
      state.isListening = action.payload;
    },
    addMessage: (state, action: PayloadAction<ChatMessage>) => {
      state.messages.push(action.payload);
    },
    clearMessages: (state) => {
      state.messages = [];
    },
    setContext: (state, action: PayloadAction<Partial<AIContext>>) => {
      state.context = { ...state.context, ...action.payload };
    },
    setRecommendations: (state, action: PayloadAction<Recommendation[]>) => {
      state.recommendations = action.payload;
    },
  },
});

export const {
  toggleExpanded,
  setExpanded,
  setPosition,
  setListening,
  addMessage,
  clearMessages,
  setContext,
  setRecommendations,
} = aiSlice.actions;

export default aiSlice.reducer;
```

### 4.4 æ™ºèƒ½å±‚ (Intelligence Layer)

#### 4.4.1 æ™ºèƒ½æ¨èå¼•æ“

```typescript
// src/services/ai/recommendationEngine.ts
export class RecommendationEngine {
  private userContext: AIContext;
  private knowledgeBase: KnowledgeBase;
  
  constructor(userContext: AIContext, knowledgeBase: KnowledgeBase) {
    this.userContext = userContext;
    this.knowledgeBase = knowledgeBase;
  }
  
  generateRecommendations(): Recommendation[] {
    const recommendations: Recommendation[] = [];
    
    const ageBasedRecommendations = this.getAgeBasedRecommendations();
    const topicBasedRecommendations = this.getTopicBasedRecommendations();
    const preferenceBasedRecommendations = this.getPreferenceBasedRecommendations();
    
    recommendations.push(...ageBasedRecommendations);
    recommendations.push(...topicBasedRecommendations);
    recommendations.push(...preferenceBasedRecommendations);
    
    return this.rankRecommendations(recommendations);
  }
  
  private getAgeBasedRecommendations(): Recommendation[] {
    const age = this.userContext.currentAge;
    const stage = this.userContext.currentStage;
    
    return this.knowledgeBase
      .getContentByAge(age)
      .map((content) => ({
        id: content.id,
        type: 'content' as const,
        title: content.title,
        description: content.description,
      }));
  }
  
  private getTopicBasedRecommendations(): Recommendation[] {
    const recentTopics = this.userContext.recentTopics;
    
    return this.knowledgeBase
      .getRelatedContent(recentTopics)
      .map((content) => ({
        id: content.id,
        type: 'content' as const,
        title: content.title,
        description: content.description,
      }));
  }
  
  private getPreferenceBasedRecommendations(): Recommendation[] {
    const preferences = this.userContext.userPreferences;
    
    return this.knowledgeBase
      .getContentByPreferences(preferences)
      .map((content) => ({
        id: content.id,
        type: 'content' as const,
        title: content.title,
        description: content.description,
      }));
  }
  
  private rankRecommendations(recommendations: Recommendation[]): Recommendation[] {
    return recommendations.sort((a, b) => {
      const scoreA = this.calculateRelevanceScore(a);
      const scoreB = this.calculateRelevanceScore(b);
      return scoreB - scoreA;
    });
  }
  
  private calculateRelevanceScore(recommendation: Recommendation): number {
    let score = 0;
    
    if (recommendation.type === 'content') {
      score += 0.5;
    }
    
    if (this.userContext.recentTopics.some(topic => 
      recommendation.title.includes(topic)
    )) {
      score += 0.3;
    }
    
    return score;
  }
}
```

#### 4.4.2 æ„å›¾è¯†åˆ«å¼•æ“

```typescript
// src/services/ai/intentRecognizer.ts
export class IntentRecognizer {
  private intents: IntentPattern[];
  
  constructor() {
    this.intents = [
      {
        intent: 'learn',
        patterns: ['å­¦ä¹ ', 'æ•™æˆ‘', 'å¦‚ä½•', 'æ€ä¹ˆ'],
      },
      {
        intent: 'play',
        patterns: ['ç©', 'æ¸¸æˆ', 'å¨±ä¹'],
      },
      {
        intent: 'explore',
        patterns: ['æ¢ç´¢', 'å‘ç°', 'äº†è§£'],
      },
      {
        intent: 'record',
        patterns: ['è®°å½•', 'ä¿å­˜', 'æ·»åŠ '],
      },
      {
        intent: 'greeting',
        patterns: ['ä½ å¥½', 'å—¨', 'æ—©ä¸Šå¥½', 'æ™šä¸Šå¥½'],
      },
    ];
  }
  
  recognizeIntent(text: string): IntentResult {
    const lowerText = text.toLowerCase();
    
    for (const intentPattern of this.intents) {
      for (const pattern of intentPattern.patterns) {
        if (lowerText.includes(pattern)) {
          return {
            intent: intentPattern.intent,
            confidence: this.calculateConfidence(lowerText, pattern),
            entities: this.extractEntities(text, intentPattern.intent),
          };
        }
      }
    }
    
    return {
      intent: 'unknown',
      confidence: 0,
      entities: {},
    };
  }
  
  private calculateConfidence(text: string, pattern: string): number {
    if (text.includes(pattern)) {
      return 0.9;
    }
    return 0;
  }
  
  private extractEntities(text: string, intent: string): Record<string, string> {
    const entities: Record<string, string> = {};
    
    if (intent === 'learn') {
      const subjectMatch = text.match(/å­¦ä¹ (.+)/);
      if (subjectMatch) {
        entities.subject = subjectMatch[1].trim();
      }
    }
    
    return entities;
  }
}

export interface IntentPattern {
  intent: string;
  patterns: string[];
}

export interface IntentResult {
  intent: string;
  confidence: number;
  entities: Record<string, string>;
}
```

### 4.5 æ•°æ®å±‚ (Data Layer)

#### 4.5.1 å¯¹è¯å†å²ç®¡ç†

```typescript
// src/services/ai/chatHistoryManager.ts
export class ChatHistoryManager {
  private storageKey = 'ai_chat_history';
  private maxHistorySize = 100;
  
  saveMessage(message: ChatMessage): void {
    const history = this.getHistory();
    history.push(message);
    
    if (history.length > this.maxHistorySize) {
      history.shift();
    }
    
    localStorage.setItem(this.storageKey, JSON.stringify(history));
  }
  
  getHistory(): ChatMessage[] {
    const history = localStorage.getItem(this.storageKey);
    return history ? JSON.parse(history) : [];
  }
  
  clearHistory(): void {
    localStorage.removeItem(this.storageKey);
  }
  
  getRecentMessages(count: number): ChatMessage[] {
    const history = this.getHistory();
    return history.slice(-count);
  }
}
```

#### 4.5.2 ç”¨æˆ·ç”»åƒç®¡ç†

```typescript
// src/services/ai/userProfileManager.ts
export class UserProfileManager {
  private storageKey = 'ai_user_profile';
  
  getUserProfile(): UserProfile {
    const profile = localStorage.getItem(this.storageKey);
    return profile ? JSON.parse(profile) : this.createDefaultProfile();
  }
  
  saveUserProfile(profile: UserProfile): void {
    localStorage.setItem(this.storageKey, JSON.stringify(profile));
  }
  
  updateProfile(updates: Partial<UserProfile>): void {
    const profile = this.getUserProfile();
    const updatedProfile = { ...profile, ...updates };
    this.saveUserProfile(updatedProfile);
  }
  
  private createDefaultProfile(): UserProfile {
    return {
      id: uuidv4(),
      name: '',
      age: 0,
      growthStage: '',
      recentTopics: [],
      userPreferences: {},
    };
  }
}

### 4.6 å±•ç¤ºå±‚ (Presentation Layer)

#### 4.6.1 AIæµ®çª—UIç»„ä»¶

```typescript
export interface AIFloatingWindowProps {
  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left';
  size?: 'small' | 'medium' | 'large';
  theme?: 'light' | 'dark' | 'auto';
  onOpen?: () => void;
  onClose?: () => void;
}

export const AIFloatingWindow: React.FC<AIFloatingWindowProps> = ({
  position = 'bottom-right',
  size = 'medium',
  theme = 'auto',
  onOpen,
  onClose,
}) => {
  const [isOpen, setIsOpen] = useState(false);
  const [isMinimized, setIsMinimized] = useState(false);
  const { aiState, dispatch } = useAIStore();
  
  const handleToggle = () => {
    if (isOpen) {
      setIsOpen(false);
      onClose?.();
    } else {
      setIsOpen(true);
      onOpen?.();
    }
  };
  
  const handleMinimize = () => {
    setIsMinimized(!isMinimized);
  };
  
  const positionStyles = {
    'bottom-right': 'bottom-6 right-6',
    'bottom-left': 'bottom-6 left-6',
    'top-right': 'top-6 right-6',
    'top-left': 'top-6 left-6',
  };
  
  const sizeStyles = {
    small: 'w-80 h-96',
    medium: 'w-96 h-[500px]',
    large: 'w-[500px] h-[600px]',
  };
  
  return (
    <div className={`fixed ${positionStyles[position]} z-50`}>
      {!isOpen && (
        <button
          onClick={handleToggle}
          className="w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-pink-500 shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center text-white text-2xl hover:scale-110"
        >
          ğŸ¤–
        </button>
      )}
      
      {isOpen && (
        <div
          className={`${sizeStyles[size]} bg-white rounded-2xl shadow-2xl overflow-hidden transition-all duration-300 ${theme === 'dark' ? 'dark' : ''}`}
        >
          <div className="bg-gradient-to-r from-purple-600 to-pink-500 p-4 text-white">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-3">
                <span className="text-2xl">ğŸ¤–</span>
                <div>
                  <Typography variant="h6" style={{ color: 'white' }}>å°è¯­AIåŠ©æ‰‹</Typography>
                  <Typography variant="caption" style={{ color: 'rgba(255, 255, 255, 0.9)' }}>
                    {aiState.isListening ? 'æ­£åœ¨è†å¬...' : aiState.isSpeaking ? 'æ­£åœ¨è¯´è¯...' : 'å‡†å¤‡å°±ç»ª'}
                  </Typography>
                </div>
              </div>
              <div className="flex gap-2">
                <button
                  onClick={handleMinimize}
                  className="w-8 h-8 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center"
                >
                  {isMinimized ? 'â–¡' : '_'}
                </button>
                <button
                  onClick={handleToggle}
                  className="w-8 h-8 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center"
                >
                  âœ•
                </button>
              </div>
            </div>
          </div>
          
          {!isMinimized && (
            <div className="flex flex-col h-full">
              <div className="flex-1 p-4 overflow-y-auto">
                {aiState.messages.map((message, index) => (
                  <div
                    key={index}
                    className={`mb-4 ${message.role === 'user' ? 'text-right' : 'text-left'}`}
                  >
                    <div
                      className={`inline-block max-w-[80%] p-3 rounded-2xl ${
                        message.role === 'user'
                          ? 'bg-purple-500 text-white'
                          : 'bg-gray-100 text-gray-800'
                      }`}
                    >
                      <Typography variant="body2">{message.content}</Typography>
                    </div>
                  </div>
                ))}
                {aiState.isProcessing && (
                  <div className="text-left mb-4">
                    <div className="inline-block p-3 rounded-2xl bg-gray-100">
                      <LoadingSpinner size="small" />
                    </div>
                  </div>
                )}
              </div>
              
              <div className="p-4 border-t">
                <div className="flex gap-2 mb-3">
                  <VoiceInputButton
                    isListening={aiState.isListening}
                    onStart={() => dispatch({ type: 'START_LISTENING' })}
                    onStop={() => dispatch({ type: 'STOP_LISTENING' })}
                  />
                  <TextInput
                    placeholder="è¾“å…¥æ¶ˆæ¯..."
                    value={aiState.inputText}
                    onChange={(value) => dispatch({ type: 'SET_INPUT_TEXT', payload: value })}
                    onSend={() => dispatch({ type: 'SEND_MESSAGE' })}
                  />
                </div>
                <div className="flex gap-2 overflow-x-auto">
                  {aiState.suggestions.map((suggestion, index) => (
                    <button
                      key={index}
                      onClick={() => dispatch({ type: 'SEND_MESSAGE', payload: suggestion })}
                      className="px-3 py-1.5 bg-purple-100 text-purple-700 rounded-full text-sm whitespace-nowrap hover:bg-purple-200 transition-colors"
                    >
                      {suggestion}
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}
        </div>
      )}
    </div>
  );
};
```

---

## äº”ã€å…¨é“¾è·¯é—­ç¯ç³»ç»Ÿ

### 5.1 ç”¨æˆ·æ—…ç¨‹è®¾è®¡

#### 5.1.1 ç”¨æˆ·æ—…ç¨‹åœ°å›¾

```
ç”¨æˆ·æ—…ç¨‹é˜¶æ®µï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é¦–æ¬¡è®¿é—®   â”‚   æ³¨å†Œç™»å½•   â”‚   æ¢ç´¢å†…å®¹   â”‚   æ·±åº¦ä½¿ç”¨   â”‚   æŒç»­æˆé•¿   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚              â”‚              â”‚              â”‚
      â–¼              â–¼              â–¼              â–¼              â–¼
  å¼•å¯¼é¡µé¢      ç”¨æˆ·ä¿¡æ¯æ”¶é›†    å†…å®¹æ¨è      ä¸ªæ€§åŒ–å­¦ä¹     æˆé•¿è¿½è¸ª
  AIäº’åŠ¨        æˆé•¿é˜¶æ®µè¯†åˆ«    æ™ºèƒ½é€‚é…      AIè¾…åŠ©        æˆå°±ç³»ç»Ÿ
  å¿«é€Ÿä¸Šæ‰‹      ä¸ªæ€§åŒ–è®¾ç½®      æ–‡åŒ–æ¢ç´¢      ç¤¾äº¤äº’åŠ¨      æ•°æ®åˆ†æ
```

#### 5.1.2 ç”¨æˆ·æ—…ç¨‹å…³é”®èŠ‚ç‚¹

| é˜¶æ®µ | å…³é”®èŠ‚ç‚¹ | ç”¨æˆ·ç›®æ ‡ | ç³»ç»Ÿå“åº” | æ•°æ®é‡‡é›† |
|------|---------|---------|---------|---------|
| é¦–æ¬¡è®¿é—® | æ¬¢è¿å¼•å¯¼ | äº†è§£åº”ç”¨åŠŸèƒ½ | å±•ç¤ºæ ¸å¿ƒåŠŸèƒ½ä»‹ç» | è®¿é—®æ¥æºã€è®¾å¤‡ä¿¡æ¯ |
| æ³¨å†Œç™»å½• | ä¿¡æ¯æ”¶é›† | å®Œæˆè´¦å·åˆ›å»º | æ”¶é›†åŸºæœ¬ä¿¡æ¯ | ç”¨æˆ·ä¿¡æ¯ã€å¹´é¾„ |
| æ¢ç´¢å†…å®¹ | å†…å®¹æ¨è | å‘ç°æ„Ÿå…´è¶£å†…å®¹ | åŸºäºå¹´é¾„æ¨èå†…å®¹ | æµè§ˆè¡Œä¸ºã€åœç•™æ—¶é—´ |
| æ·±åº¦ä½¿ç”¨ | ä¸ªæ€§åŒ–å­¦ä¹  | è·å¾—ä¸ªæ€§åŒ–ä½“éªŒ | AIè¾…åŠ©å­¦ä¹  | å­¦ä¹ è¿›åº¦ã€äº’åŠ¨æ•°æ® |
| æŒç»­æˆé•¿ | æˆé•¿è¿½è¸ª | æŸ¥çœ‹æˆé•¿è®°å½• | å±•ç¤ºæˆé•¿æ•°æ® | æˆå°±æ•°æ®ã€ä½¿ç”¨é¢‘ç‡ |

### 5.2 äº¤äº’æµç¨‹è®¾è®¡

#### 5.2.1 æ ¸å¿ƒäº¤äº’æµç¨‹

```typescript
export interface InteractionFlow {
  id: string;
  name: string;
  description: string;
  steps: InteractionStep[];
  triggers: InteractionTrigger[];
  conditions?: InteractionCondition[];
  actions?: InteractionAction[];
}

export interface InteractionStep {
  id: string;
  name: string;
  type: 'user_action' | 'system_response' | 'ai_interaction';
  component?: string;
  data?: Record<string, any>;
  nextSteps?: string[];
}

export interface InteractionTrigger {
  type: 'event' | 'condition' | 'time' | 'user_intent';
  value: string | number | boolean;
  description: string;
}

export interface InteractionCondition {
  field: string;
  operator: 'eq' | 'neq' | 'gt' | 'lt' | 'contains';
  value: any;
}

export interface InteractionAction {
  type: 'navigate' | 'show_modal' | 'update_state' | 'send_event';
  target: string;
  data?: Record<string, any>;
}

export const coreInteractionFlows: InteractionFlow[] = [
  {
    id: 'onboarding_flow',
    name: 'æ–°æ‰‹å¼•å¯¼æµç¨‹',
    description: 'ç”¨æˆ·é¦–æ¬¡è¿›å…¥åº”ç”¨æ—¶çš„å¼•å¯¼æµç¨‹',
    steps: [
      {
        id: 'welcome_screen',
        name: 'æ¬¢è¿é¡µé¢',
        type: 'system_response',
        component: 'WelcomeScreen',
        nextSteps: ['age_selection'],
      },
      {
        id: 'age_selection',
        name: 'å¹´é¾„é€‰æ‹©',
        type: 'user_action',
        component: 'AgeSelection',
        nextSteps: ['growth_stage_identification'],
      },
      {
        id: 'growth_stage_identification',
        name: 'æˆé•¿é˜¶æ®µè¯†åˆ«',
        type: 'system_response',
        component: 'GrowthStageIdentification',
        nextSteps: ['content_recommendation'],
      },
      {
        id: 'content_recommendation',
        name: 'å†…å®¹æ¨è',
        type: 'system_response',
        component: 'ContentRecommendation',
        nextSteps: ['ai_introduction'],
      },
      {
        id: 'ai_introduction',
        name: 'AIåŠ©æ‰‹ä»‹ç»',
        type: 'ai_interaction',
        component: 'AIIntroduction',
      },
    ],
    triggers: [
      {
        type: 'event',
        value: 'app_first_open',
        description: 'åº”ç”¨é¦–æ¬¡æ‰“å¼€',
      },
    ],
  },
  {
    id: 'learning_flow',
    name: 'å­¦ä¹ æµç¨‹',
    description: 'ç”¨æˆ·å­¦ä¹ å†…å®¹çš„å®Œæ•´æµç¨‹',
    steps: [
      {
        id: 'content_selection',
        name: 'å†…å®¹é€‰æ‹©',
        type: 'user_action',
        component: 'ContentSelection',
        nextSteps: ['content_display'],
      },
      {
        id: 'content_display',
        name: 'å†…å®¹å±•ç¤º',
        type: 'system_response',
        component: 'ContentDisplay',
        nextSteps: ['learning_interaction'],
      },
      {
        id: 'learning_interaction',
        name: 'å­¦ä¹ äº’åŠ¨',
        type: 'user_action',
        component: 'LearningInteraction',
        nextSteps: ['ai_assistance'],
      },
      {
        id: 'ai_assistance',
        name: 'AIè¾…åŠ©',
        type: 'ai_interaction',
        component: 'AIAssistance',
        nextSteps: ['progress_update'],
      },
      {
        id: 'progress_update',
        name: 'è¿›åº¦æ›´æ–°',
        type: 'system_response',
        component: 'ProgressUpdate',
      },
    ],
    triggers: [
      {
        type: 'user_intent',
        value: 'learn_content',
        description: 'ç”¨æˆ·æ„å›¾å­¦ä¹ å†…å®¹',
      },
    ],
  },
];
```

#### 5.2.2 äº¤äº’çŠ¶æ€ç®¡ç†

```typescript
export interface InteractionState {
  currentFlow: string | null;
  currentStep: string | null;
  history: InteractionHistoryEntry[];
  context: Record<string, any>;
  isProcessing: boolean;
  error: string | null;
}

export interface InteractionHistoryEntry {
  flowId: string;
  stepId: string;
  timestamp: number;
  data?: Record<string, any>;
}

export class InteractionFlowManager {
  private state: InteractionState = {
    currentFlow: null,
    currentStep: null,
    history: [],
    context: {},
    isProcessing: false,
    error: null,
  };
  
  private flows: Map<string, InteractionFlow> = new Map();
  
  registerFlow(flow: InteractionFlow): void {
    this.flows.set(flow.id, flow);
  }
  
  startFlow(flowId: string, initialContext?: Record<string, any>): boolean {
    const flow = this.flows.get(flowId);
    if (!flow) {
      this.state.error = `Flow not found: ${flowId}`;
      return false;
    }
    
    this.state.currentFlow = flowId;
    this.state.currentStep = flow.steps[0].id;
    this.state.context = { ...initialContext };
    this.state.isProcessing = true;
    this.state.error = null;
    
    this.recordHistory(flowId, flow.steps[0].id);
    return true;
  }
  
  nextStep(): boolean {
    const { currentFlow, currentStep } = this.state;
    if (!currentFlow || !currentStep) return false;
    
    const flow = this.flows.get(currentFlow);
    if (!flow) return false;
    
    const currentStepIndex = flow.steps.findIndex(s => s.id === currentStep);
    if (currentStepIndex === -1) return false;
    
    const currentStepData = flow.steps[currentStepIndex];
    const nextStepIds = currentStepData.nextSteps;
    
    if (!nextStepIds || nextStepIds.length === 0) {
      this.endFlow();
      return true;
    }
    
    const nextStepId = nextStepIds[0];
    this.state.currentStep = nextStepId;
    this.recordHistory(currentFlow, nextStepId);
    
    return true;
  }
  
  endFlow(): void {
    this.state.currentFlow = null;
    this.state.currentStep = null;
    this.state.isProcessing = false;
  }
  
  updateContext(updates: Record<string, any>): void {
    this.state.context = { ...this.state.context, ...updates };
  }
  
  getState(): InteractionState {
    return { ...this.state };
  }
  
  private recordHistory(flowId: string, stepId: string): void {
    this.state.history.push({
      flowId,
      stepId,
      timestamp: Date.now(),
      data: { ...this.state.context },
    });
  }
}
```

### 5.3 æ•°æ®æµè½¬è®¾è®¡

#### 5.3.1 æ•°æ®æµå‘å›¾

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ç»„ä»¶å±‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çŠ¶æ€ç®¡ç†å±‚  â”‚ (Redux Store)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AIæœåŠ¡å±‚   â”‚  â”‚  å†…å®¹æœåŠ¡å±‚  â”‚  â”‚  ç”¨æˆ·æœåŠ¡å±‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  APIç½‘å…³å±‚  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  åç«¯æœåŠ¡å±‚  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼              â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ PostgreSQL â”‚  â”‚  Redis  â”‚  â”‚  Qdrant â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.3.2 æ•°æ®åŒæ­¥æœºåˆ¶

```typescript
export interface DataSyncConfig {
  syncInterval: number;
  retryAttempts: number;
  retryDelay: number;
  conflictResolution: 'client' | 'server' | 'merge';
}

export class DataSyncManager {
  private config: DataSyncConfig;
  private syncQueue: Map<string, any> = new Map();
  private isSyncing: boolean = false;
  
  constructor(config: DataSyncConfig) {
    this.config = config;
  }
  
  async syncData(key: string, data: any): Promise<boolean> {
    this.syncQueue.set(key, data);
    
    if (!this.isSyncing) {
      return this.processSyncQueue();
    }
    
    return true;
  }
  
  private async processSyncQueue(): Promise<boolean> {
    this.isSyncing = true;
    
    try {
      for (const [key, data] of this.syncQueue.entries()) {
        await this.syncItem(key, data);
        this.syncQueue.delete(key);
      }
      
      return true;
    } catch (error) {
      console.error('Sync failed:', error);
      return false;
    } finally {
      this.isSyncing = false;
    }
  }
  
  private async syncItem(key: string, data: any): Promise<void> {
    let attempts = 0;
    
    while (attempts < this.config.retryAttempts) {
      try {
        await this.sendToServer(key, data);
        return;
      } catch (error) {
        attempts++;
        if (attempts < this.config.retryAttempts) {
          await this.delay(this.config.retryDelay);
        } else {
          throw error;
        }
      }
    }
  }
  
  private async sendToServer(key: string, data: any): Promise<void> {
    const response = await fetch('/api/sync', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ key, data }),
    });
    
    if (!response.ok) {
      throw new Error('Sync request failed');
    }
  }
  
  private delay(ms: number): Promise<void> {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}
```

### 5.4 åé¦ˆé—­ç¯è®¾è®¡

#### 5.4.1 ç”¨æˆ·åé¦ˆæ”¶é›†

```typescript
export interface UserFeedback {
  id: string;
  userId: string;
  type: 'rating' | 'comment' | 'bug' | 'suggestion';
  category: string;
  content: string;
  rating?: number;
  metadata?: Record<string, any>;
  timestamp: number;
}

export class FeedbackCollector {
  private feedbackQueue: UserFeedback[] = [];
  private isSubmitting: boolean = false;
  
  collectFeedback(feedback: Omit<UserFeedback, 'id' | 'timestamp'>): string {
    const fullFeedback: UserFeedback = {
      ...feedback,
      id: uuidv4(),
      timestamp: Date.now(),
    };
    
    this.feedbackQueue.push(fullFeedback);
    this.submitFeedback();
    
    return fullFeedback.id;
  }
  
  async submitFeedback(): Promise<void> {
    if (this.isSubmitting || this.feedbackQueue.length === 0) {
      return;
    }
    
    this.isSubmitting = true;
    
    try {
      const feedback = this.feedbackQueue.shift();
      if (feedback) {
        await this.sendFeedback(feedback);
      }
    } catch (error) {
      console.error('Failed to submit feedback:', error);
    } finally {
      this.isSubmitting = false;
    }
  }
  
  private async sendFeedback(feedback: UserFeedback): Promise<void> {
    const response = await fetch('/api/feedback', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(feedback),
    });
    
    if (!response.ok) {
      throw new Error('Feedback submission failed');
    }
  }
}
```

#### 5.4.2 ç³»ç»Ÿåé¦ˆæœºåˆ¶

```typescript
export interface SystemFeedback {
  type: 'success' | 'error' | 'warning' | 'info';
  title: string;
  message: string;
  duration?: number;
  actions?: FeedbackAction[];
}

export interface FeedbackAction {
  label: string;
  action: () => void;
  primary?: boolean;
}

export class SystemFeedbackManager {
  private listeners: Set<(feedback: SystemFeedback) => void> = new Set();
  
  showFeedback(feedback: SystemFeedback): void {
    this.listeners.forEach(listener => listener(feedback));
  }
  
  success(title: string, message: string, actions?: FeedbackAction[]): void {
    this.showFeedback({
      type: 'success',
      title,
      message,
      actions,
    });
  }
  
  error(title: string, message: string, actions?: FeedbackAction[]): void {
    this.showFeedback({
      type: 'error',
      title,
      message,
      duration: 5000,
      actions,
    });
  }
  
  warning(title: string, message: string, actions?: FeedbackAction[]): void {
    this.showFeedback({
      type: 'warning',
      title,
      message,
      actions,
    });
  }
  
  info(title: string, message: string, actions?: FeedbackAction[]): void {
    this.showFeedback({
      type: 'info',
      title,
      message,
      actions,
    });
  }
  
  subscribe(listener: (feedback: SystemFeedback) => void): () => void {
    this.listeners.add(listener);
    return () => this.listeners.delete(listener);
  }
}
```

---

## å…­ã€APIæ¥å£ä½“ç³»

### 6.1 æ¥å£æ¶æ„è®¾è®¡

#### 6.1.1 æ¥å£åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     APIç½‘å…³å±‚ (API Gateway)                  â”‚
â”‚  è·¯ç”±è½¬å‘ã€è®¤è¯æˆæƒã€é™æµç†”æ–­ã€æ—¥å¿—ç›‘æ§                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æœåŠ¡   â”‚       â”‚  å†…å®¹æœåŠ¡   â”‚       â”‚  AIæœåŠ¡     â”‚
â”‚  User API   â”‚       â”‚ Content API â”‚       â”‚  AI API     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL â”‚       â”‚  PostgreSQL â”‚       â”‚  Qdrant     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 6.1.2 æ¥å£è§„èŒƒ

```typescript
export interface APIResponse<T = any> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
  timestamp: number;
}

export interface APIRequest {
  method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';
  url: string;
  headers?: Record<string, string>;
  params?: Record<string, any>;
  body?: any;
}

export class APIClient {
  private baseURL: string;
  private defaultHeaders: Record<string, string>;
  
  constructor(baseURL: string, defaultHeaders?: Record<string, string>) {
    this.baseURL = baseURL;
    this.defaultHeaders = {
      'Content-Type': 'application/json',
      ...defaultHeaders,
    };
  }
  
  async request<T>(config: APIRequest): Promise<APIResponse<T>> {
    const url = new URL(config.url, this.baseURL);
    
    if (config.params) {
      Object.entries(config.params).forEach(([key, value]) => {
        url.searchParams.append(key, String(value));
      });
    }
    
    const response = await fetch(url.toString(), {
      method: config.method,
      headers: {
        ...this.defaultHeaders,
        ...config.headers,
      },
      body: config.body ? JSON.stringify(config.body) : undefined,
    });
    
    const data = await response.json();
    
    return {
      success: response.ok,
      data: response.ok ? data : undefined,
      error: response.ok ? undefined : data,
      timestamp: Date.now(),
    };
  }
  
  get<T>(url: string, params?: Record<string, any>): Promise<APIResponse<T>> {
    return this.request<T>({ method: 'GET', url, params });
  }
  
  post<T>(url: string, body?: any): Promise<APIResponse<T>> {
    return this.request<T>({ method: 'POST', url, body });
  }
  
  put<T>(url: string, body?: any): Promise<APIResponse<T>> {
    return this.request<T>({ method: 'PUT', url, body });
  }
  
  delete<T>(url: string): Promise<APIResponse<T>> {
    return this.request<T>({ method: 'DELETE', url });
  }
}
```

### 6.2 ç”¨æˆ·æœåŠ¡API

#### 6.2.1 ç”¨æˆ·ä¿¡æ¯æ¥å£

```typescript
export interface UserAPI {
  getUserProfile(userId: string): Promise<APIResponse<UserProfile>>;
  updateUserProfile(userId: string, updates: Partial<UserProfile>): Promise<APIResponse<UserProfile>>;
  createUserProfile(profile: Omit<UserProfile, 'id'>): Promise<APIResponse<UserProfile>>;
  deleteUserProfile(userId: string): Promise<APIResponse<void>>;
  getUserGrowthRecords(userId: string): Promise<APIResponse<GrowthRecord[]>>;
  updateUserGrowthRecord(userId: string, recordId: string, updates: Partial<GrowthRecord>): Promise<APIResponse<GrowthRecord>>;
}

export class UserService implements UserAPI {
  private client: APIClient;
  
  constructor(baseURL: string) {
    this.client = new APIClient(baseURL);
  }
  
  async getUserProfile(userId: string): Promise<APIResponse<UserProfile>> {
    return this.client.get<UserProfile>(`/api/users/${userId}`);
  }
  
  async updateUserProfile(userId: string, updates: Partial<UserProfile>): Promise<APIResponse<UserProfile>> {
    return this.client.put<UserProfile>(`/api/users/${userId}`, updates);
  }
  
  async createUserProfile(profile: Omit<UserProfile, 'id'>): Promise<APIResponse<UserProfile>> {
    return this.client.post<UserProfile>('/api/users', profile);
  }
  
  async deleteUserProfile(userId: string): Promise<APIResponse<void>> {
    return this.client.delete<void>(`/api/users/${userId}`);
  }
  
  async getUserGrowthRecords(userId: string): Promise<APIResponse<GrowthRecord[]>> {
    return this.client.get<GrowthRecord[]>(`/api/users/${userId}/growth-records`);
  }
  
  async updateUserGrowthRecord(userId: string, recordId: string, updates: Partial<GrowthRecord>): Promise<APIResponse<GrowthRecord>> {
    return this.client.put<GrowthRecord>(`/api/users/${userId}/growth-records/${recordId}`, updates);
  }
}
```

### 6.3 å†…å®¹æœåŠ¡API

#### 6.3.1 å†…å®¹ç®¡ç†æ¥å£

```typescript
export interface ContentAPI {
  getContentList(filters?: ContentFilters): Promise<APIResponse<ContentItem[]>>;
  getContentById(contentId: string): Promise<APIResponse<ContentItem>>;
  createContent(content: Omit<ContentItem, 'id'>): Promise<APIResponse<ContentItem>>;
  updateContent(contentId: string, updates: Partial<ContentItem>): Promise<APIResponse<ContentItem>>;
  deleteContent(contentId: string): Promise<APIResponse<void>>;
  getRecommendedContent(userId: string, limit?: number): Promise<APIResponse<ContentItem[]>>;
}

export interface ContentFilters {
  category?: string;
  ageRange?: [number, number];
  growthStage?: string;
  tags?: string[];
  searchQuery?: string;
}

export class ContentService implements ContentAPI {
  private client: APIClient;
  
  constructor(baseURL: string) {
    this.client = new APIClient(baseURL);
  }
  
  async getContentList(filters?: ContentFilters): Promise<APIResponse<ContentItem[]>> {
    return this.client.get<ContentItem[]>('/api/contents', filters);
  }
  
  async getContentById(contentId: string): Promise<APIResponse<ContentItem>> {
    return this.client.get<ContentItem>(`/api/contents/${contentId}`);
  }
  
  async createContent(content: Omit<ContentItem, 'id'>): Promise<APIResponse<ContentItem>> {
    return this.client.post<ContentItem>('/api/contents', content);
  }
  
  async updateContent(contentId: string, updates: Partial<ContentItem>): Promise<APIResponse<ContentItem>> {
    return this.client.put<ContentItem>(`/api/contents/${contentId}`, updates);
  }
  
  async deleteContent(contentId: string): Promise<APIResponse<void>> {
    return this.client.delete<void>(`/api/contents/${contentId}`);
  }
  
  async getRecommendedContent(userId: string, limit: number = 10): Promise<APIResponse<ContentItem[]>> {
    return this.client.get<ContentItem[]>(`/api/users/${userId}/recommended-contents`, { limit });
  }
}
```

### 6.4 AIæœåŠ¡API

#### 6.4.1 AIäº¤äº’æ¥å£

```typescript
export interface AIAPI {
  sendMessage(message: string, context?: AIContext): Promise<APIResponse<AIMessage>>;
  startVoiceRecognition(): Promise<APIResponse<string>>;
  stopVoiceRecognition(): Promise<APIResponse<void>>;
  textToSpeech(text: string, voice?: string): Promise<APIResponse<string>>;
  getRecommendations(userId: string, context?: AIContext): Promise<APIResponse<AIRecommendation[]>>;
  analyzeIntent(message: string): Promise<APIResponse<AIIntent>>;
}

export interface AIContext {
  userId: string;
  currentContent?: string;
  growthStage?: string;
  recentTopics?: string[];
  userPreferences?: Record<string, any>;
}

export interface AIMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: number;
  metadata?: Record<string, any>;
}

export interface AIRecommendation {
  id: string;
  type: 'content' | 'action' | 'question';
  title: string;
  description: string;
  relevanceScore: number;
  data?: any;
}

export interface AIIntent {
  intent: string;
  confidence: number;
  entities: Record<string, any>;
  suggestions: string[];
}

export class AIService implements AIAPI {
  private client: APIClient;
  
  constructor(baseURL: string) {
    this.client = new APIClient(baseURL);
  }
  
  async sendMessage(message: string, context?: AIContext): Promise<APIResponse<AIMessage>> {
    return this.client.post<AIMessage>('/api/ai/message', { message, context });
  }
  
  async startVoiceRecognition(): Promise<APIResponse<string>> {
    return this.client.post<string>('/api/ai/voice/start');
  }
  
  async stopVoiceRecognition(): Promise<APIResponse<void>> {
    return this.client.post<void>('/api/ai/voice/stop');
  }
  
  async textToSpeech(text: string, voice?: string): Promise<APIResponse<string>> {
    return this.client.post<string>('/api/ai/tts', { text, voice });
  }
  
  async getRecommendations(userId: string, context?: AIContext): Promise<APIResponse<AIRecommendation[]>> {
    return this.client.get<AIRecommendation[]>(`/api/ai/recommendations/${userId}`, context);
  }
  
  async analyzeIntent(message: string): Promise<APIResponse<AIIntent>> {
    return this.client.post<AIIntent>('/api/ai/intent', { message });
  }
}
```

---

## ä¸ƒã€ç”¨æˆ·ä¿¡æ¯åŠå…¨å±€å½¢è±¡ç³»ç»Ÿ

### 7.1 ç”¨æˆ·ç”»åƒç³»ç»Ÿ

#### 7.1.1 ç”¨æˆ·ç”»åƒæ•°æ®ç»“æ„

```typescript
export interface UserPersona {
  id: string;
  basicInfo: UserBasicInfo;
  growthInfo: UserGrowthInfo;
  preferences: UserPreferences;
  behaviorData: UserBehaviorData;
  achievements: UserAchievement[];
  socialData: UserSocialData;
  lastUpdated: string;
}

export interface UserBasicInfo {
  userId: string;
  name: string;
  age: number;
  gender?: 'male' | 'female' | 'other';
  avatar?: string;
  location?: string;
  timezone?: string;
  language: string;
}

export interface UserGrowthInfo {
  currentStage: string;
  stageProgress: number;
  completedStages: string[];
  growthRecords: GrowthRecord[];
  learningGoals: LearningGoal[];
  skillLevels: SkillLevel[];
}

export interface LearningGoal {
  id: string;
  title: string;
  description: string;
  targetDate: string;
  progress: number;
  status: 'active' | 'completed' | 'paused';
}

export interface SkillLevel {
  skill: string;
  level: number;
  lastAssessed: string;
}

export interface UserPreferences {
  theme: 'light' | 'dark' | 'auto';
  language: string;
  notificationSettings: NotificationSettings;
  contentPreferences: ContentPreferences;
  interactionPreferences: InteractionPreferences;
}

export interface NotificationSettings {
  email: boolean;
  push: boolean;
  inApp: boolean;
  frequency: 'immediate' | 'daily' | 'weekly';
}

export interface ContentPreferences {
  favoriteCategories: string[];
  preferredDifficulty: 'easy' | 'medium' | 'hard';
  contentTypes: string[];
  culturalInterests: string[];
}

export interface InteractionPreferences {
  voiceEnabled: boolean;
  autoPlay: boolean;
  textSize: 'small' | 'medium' | 'large';
  animationEnabled: boolean;
}

export interface UserBehaviorData {
  sessionHistory: SessionRecord[];
  contentInteractions: ContentInteraction[];
  searchHistory: SearchRecord[];
  clickHeatmap: HeatmapData;
}

export interface SessionRecord {
  sessionId: string;
  startTime: number;
  endTime: number;
  duration: number;
  pagesVisited: string[];
  actions: ActionRecord[];
}

export interface ActionRecord {
  type: string;
  target: string;
  timestamp: number;
  metadata?: Record<string, any>;
}

export interface ContentInteraction {
  contentId: string;
  interactionType: 'view' | 'like' | 'share' | 'comment' | 'complete';
  timestamp: number;
  duration?: number;
  rating?: number;
}

export interface SearchRecord {
  query: string;
  timestamp: number;
  resultsClicked: string[];
}

export interface HeatmapData {
  clicks: { x: number; y: number; count: number }[];
  scrolls: { depth: number; count: number }[];
  dwellTime: { element: string; time: number }[];
}

export interface UserAchievement {
  id: string;
  title: string;
  description: string;
  icon: string;
  earnedDate: string;
  rarity: 'common' | 'rare' | 'epic' | 'legendary';
  progress?: number;
  target?: number;
}

export interface UserSocialData {
  friends: string[];
  groups: string[];
  sharedContent: string[];
  receivedLikes: number;
  givenLikes: number;
  comments: Comment[];
}

export interface Comment {
  id: string;
  contentId: string;
  text: string;
  timestamp: number;
  likes: number;
}
```

#### 7.1.2 ç”¨æˆ·ç”»åƒç®¡ç†

```typescript
export class UserPersonaManager {
  private persona: UserPersona | null = null;
  private storageKey = 'user_persona';
  
  async loadPersona(userId: string): Promise<UserPersona> {
    const cached = localStorage.getItem(this.storageKey);
    if (cached) {
      this.persona = JSON.parse(cached);
      return this.persona;
    }
    
    const response = await fetch(`/api/users/${userId}/persona`);
    const data = await response.json();
    
    this.persona = data;
    this.savePersona();
    
    return this.persona;
  }
  
  updatePersona(updates: Partial<UserPersona>): void {
    if (!this.persona) return;
    
    this.persona = {
      ...this.persona,
      ...updates,
      lastUpdated: new Date().toISOString(),
    };
    
    this.savePersona();
  }
  
  updateBasicInfo(updates: Partial<UserBasicInfo>): void {
    if (!this.persona) return;
    
    this.persona.basicInfo = {
      ...this.persona.basicInfo,
      ...updates,
    };
    
    this.savePersona();
  }
  
  updatePreferences(updates: Partial<UserPreferences>): void {
    if (!this.persona) return;
    
    this.persona.preferences = {
      ...this.persona.preferences,
      ...updates,
    };
    
    this.savePersona();
  }
  
  addAchievement(achievement: UserAchievement): void {
    if (!this.persona) return;
    
    this.persona.achievements.push(achievement);
    this.savePersona();
  }
  
  recordBehavior(action: ActionRecord): void {
    if (!this.persona) return;
    
    const currentSession = this.persona.behaviorData.sessionHistory[0];
    if (currentSession) {
      currentSession.actions.push(action);
    }
    
    this.savePersona();
  }
  
  recordContentInteraction(interaction: ContentInteraction): void {
    if (!this.persona) return;
    
    this.persona.behaviorData.contentInteractions.push(interaction);
    this.savePersona();
  }
  
  getPersona(): UserPersona | null {
    return this.persona;
  }
  
  private savePersona(): void {
    if (this.persona) {
      localStorage.setItem(this.storageKey, JSON.stringify(this.persona));
    }
  }
}
```

### 7.2 å…¨å±€å½¢è±¡ç³»ç»Ÿ

#### 7.2.1 å½¢è±¡æ•°æ®ç»“æ„

```typescript
export interface GlobalAvatar {
  id: string;
  userId: string;
  name: string;
  type: 'character' | 'animal' | 'object' | 'abstract';
  baseAppearance: AvatarAppearance;
  customization: AvatarCustomization;
  accessories: AvatarAccessory[];
  animations: AvatarAnimation[];
  expressions: AvatarExpression[];
  voiceProfile: VoiceProfile;
  personality: AvatarPersonality;
  createdAt: string;
  updatedAt: string;
}

export interface AvatarAppearance {
  bodyType: 'slim' | 'normal' | 'chubby';
  skinColor: string;
  eyeColor: string;
  hairColor: string;
  hairStyle: string;
  height: number;
  weight: number;
}

export interface AvatarCustomization {
  clothing: ClothingItem[];
  accessories: AccessoryItem[];
  colors: ColorScheme;
  patterns: Pattern[];
}

export interface ClothingItem {
  id: string;
  type: 'top' | 'bottom' | 'shoes' | 'hat' | 'accessory';
  name: string;
  style: string;
  color: string;
  icon: string;
}

export interface AccessoryItem {
  id: string;
  name: string;
  type: string;
  icon: string;
  position: { x: number; y: number };
}

export interface ColorScheme {
  primary: string;
  secondary: string;
  accent: string;
  background: string;
}

export interface Pattern {
  id: string;
  name: string;
  type: string;
  icon: string;
}

export interface AvatarAccessory {
  id: string;
  name: string;
  type: string;
  icon: string;
  position: { x: number; y: number };
  scale: number;
  rotation: number;
}

export interface AvatarAnimation {
  id: string;
  name: string;
  type: 'idle' | 'walking' | 'running' | 'jumping' | 'dancing' | 'talking';
  duration: number;
  frames: AnimationFrame[];
}

export interface AnimationFrame {
  timestamp: number;
  position: { x: number; y: number };
  rotation: number;
  scale: number;
}

export interface AvatarExpression {
  id: string;
  name: string;
  type: 'happy' | 'sad' | 'angry' | 'surprised' | 'neutral' | 'excited';
  icon: string;
  facialFeatures: FacialFeatures;
}

export interface FacialFeatures {
  eyes: { open: number; shape: string };
  eyebrows: { position: number; angle: number };
  mouth: { open: number; shape: string };
  cheeks: { blush: boolean; intensity: number };
}

export interface VoiceProfile {
  id: string;
  name: string;
  type: 'male' | 'female' | 'child' | 'robot';
  pitch: number;
  speed: number;
  volume: number;
  accent?: string;
}

export interface AvatarPersonality {
  traits: PersonalityTrait[];
  mood: string;
  energyLevel: number;
  friendliness: number;
  curiosity: number;
}

export interface PersonalityTrait {
  name: string;
  value: number;
  description: string;
}
```

#### 7.2.2 å½¢è±¡ç®¡ç†

```typescript
export class AvatarManager {
  private avatar: GlobalAvatar | null = null;
  private storageKey = 'global_avatar';
  
  async loadAvatar(userId: string): Promise<GlobalAvatar> {
    const cached = localStorage.getItem(this.storageKey);
    if (cached) {
      this.avatar = JSON.parse(cached);
      return this.avatar;
    }
    
    const response = await fetch(`/api/users/${userId}/avatar`);
    const data = await response.json();
    
    this.avatar = data;
    this.saveAvatar();
    
    return this.avatar;
  }
  
  createAvatar(avatarData: Omit<GlobalAvatar, 'id' | 'userId' | 'createdAt' | 'updatedAt'>): GlobalAvatar {
    this.avatar = {
      ...avatarData,
      id: uuidv4(),
      userId: avatarData.userId,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString(),
    };
    
    this.saveAvatar();
    return this.avatar;
  }
  
  updateAppearance(appearance: Partial<AvatarAppearance>): void {
    if (!this.avatar) return;
    
    this.avatar.baseAppearance = {
      ...this.avatar.baseAppearance,
      ...appearance,
    };
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  updateCustomization(customization: Partial<AvatarCustomization>): void {
    if (!this.avatar) return;
    
    this.avatar.customization = {
      ...this.avatar.customization,
      ...customization,
    };
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  addAccessory(accessory: AvatarAccessory): void {
    if (!this.avatar) return;
    
    this.avatar.accessories.push(accessory);
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  removeAccessory(accessoryId: string): void {
    if (!this.avatar) return;
    
    this.avatar.accessories = this.avatar.accessories.filter(a => a.id !== accessoryId);
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  updateVoiceProfile(voiceProfile: Partial<VoiceProfile>): void {
    if (!this.avatar) return;
    
    this.avatar.voiceProfile = {
      ...this.avatar.voiceProfile,
      ...voiceProfile,
    };
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  updatePersonality(personality: Partial<AvatarPersonality>): void {
    if (!this.avatar) return;
    
    this.avatar.personality = {
      ...this.avatar.personality,
      ...personality,
    };
    this.avatar.updatedAt = new Date().toISOString();
    
    this.saveAvatar();
  }
  
  setExpression(expressionId: string): void {
    if (!this.avatar) return;
    
    const expression = this.avatar.expressions.find(e => e.id === expressionId);
    if (expression) {
      this.avatar.personality.mood = expression.type;
      this.saveAvatar();
    }
  }
  
  getAvatar(): GlobalAvatar | null {
    return this.avatar;
  }
  
  private saveAvatar(): void {
    if (this.avatar) {
      localStorage.setItem(this.storageKey, JSON.stringify(this.avatar));
    }
  }
}
```

---

## å…«ã€ä¿¡æ¯æ˜ å°„ç³»ç»Ÿ

### 8.1 å†…å®¹æ˜ å°„å¼•æ“

#### 8.1.1 æ˜ å°„è§„åˆ™å¼•æ“

```typescript
export interface MappingRule {
  id: string;
  name: string;
  description: string;
  sourceType: 'age' | 'growth_stage' | 'interest' | 'behavior' | 'time';
  targetType: 'content' | 'activity' | 'recommendation';
  conditions: MappingCondition[];
  actions: MappingAction[];
  priority: number;
  enabled: boolean;
}

export interface MappingCondition {
  field: string;
  operator: 'eq' | 'neq' | 'gt' | 'lt' | 'gte' | 'lte' | 'in' | 'contains';
  value: any;
}

export interface MappingAction {
  type: 'filter' | 'sort' | 'boost' | 'hide' | 'transform';
  target: string;
  parameters?: Record<string, any>;
}

export class MappingRuleEngine {
  private rules: Map<string, MappingRule> = new Map();
  
  registerRule(rule: MappingRule): void {
    this.rules.set(rule.id, rule);
  }
  
  unregisterRule(ruleId: string): void {
    this.rules.delete(ruleId);
  }
  
  applyRules(context: MappingContext): MappingResult {
    const enabledRules = Array.from(this.rules.values())
      .filter(rule => rule.enabled)
      .sort((a, b) => b.priority - a.priority);
    
    const result: MappingResult = {
      matchedRules: [],
      actions: [],
      transformedContext: { ...context },
    };
    
    for (const rule of enabledRules) {
      if (this.evaluateConditions(rule.conditions, context)) {
        result.matchedRules.push(rule.id);
        result.actions.push(...rule.actions);
        result.transformedContext = this.applyActions(
          rule.actions,
          result.transformedContext
        );
      }
    }
    
    return result;
  }
  
  private evaluateConditions(conditions: MappingCondition[], context: MappingContext): boolean {
    return conditions.every(condition => {
      const value = this.getFieldValue(condition.field, context);
      return this.compareValues(value, condition.operator, condition.value);
    });
  }
  
  private getFieldValue(field: string, context: MappingContext): any {
    return field.split('.').reduce((obj, key) => obj?.[key], context);
  }
  
  private compareValues(value1: any, operator: string, value2: any): boolean {
    switch (operator) {
      case 'eq': return value1 === value2;
      case 'neq': return value1 !== value2;
      case 'gt': return value1 > value2;
      case 'lt': return value1 < value2;
      case 'gte': return value1 >= value2;
      case 'lte': return value1 <= value2;
      case 'in': return Array.isArray(value2) && value2.includes(value1);
      case 'contains': return String(value1).includes(String(value2));
      default: return false;
    }
  }
  
  private applyActions(actions: MappingAction[], context: MappingContext): MappingContext {
    let result = { ...context };
    
    for (const action of actions) {
      switch (action.type) {
        case 'filter':
          result = this.applyFilter(result, action);
          break;
        case 'sort':
          result = this.applySort(result, action);
          break;
        case 'boost':
          result = this.applyBoost(result, action);
          break;
        case 'hide':
          result = this.applyHide(result, action);
          break;
        case 'transform':
          result = this.applyTransform(result, action);
          break;
      }
    }
    
    return result;
  }
  
  private applyFilter(context: MappingContext, action: MappingAction): MappingContext {
    return context;
  }
  
  private applySort(context: MappingContext, action: MappingAction): MappingContext {
    return context;
  }
  
  private applyBoost(context: MappingContext, action: MappingAction): MappingContext {
    return context;
  }
  
  private applyHide(context: MappingContext, action: MappingAction): MappingContext {
    return context;
  }
  
  private applyTransform(context: MappingContext, action: MappingAction): MappingContext {
    return context;
  }
}

export interface MappingContext {
  userId: string;
  age: number;
  growthStage: string;
  interests: string[];
  behavior: UserBehaviorData;
  timeContext: TimeContext;
  content?: ContentItem[];
}

export interface TimeContext {
  currentHour: number;
  dayOfWeek: number;
  season: string;
  holiday?: string;
}

export interface MappingResult {
  matchedRules: string[];
  actions: MappingAction[];
  transformedContext: MappingContext;
}
```

#### 8.1.2 å¹´é¾„é€‚é…æ˜ å°„

```typescript
export const ageMappingRules: MappingRule[] = [
  {
    id: 'age_3_6_content',
    name: '3-6å²å†…å®¹é€‚é…',
    description: 'ä¸º3-6å²å„¿ç«¥æ¨èé€‚åˆçš„å†…å®¹',
    sourceType: 'age',
    targetType: 'content',
    conditions: [
      { field: 'age', operator: 'gte', value: 3 },
      { field: 'age', operator: 'lte', value: 6 },
    ],
    actions: [
      {
        type: 'filter',
        target: 'content',
        parameters: {
          minAge: 3,
          maxAge: 6,
          difficulty: 'easy',
        },
      },
      {
        type: 'boost',
        target: 'content',
        parameters: {
          categories: ['æ•…äº‹', 'å„¿æ­Œ', 'æ¸¸æˆ'],
          boostFactor: 2.0,
        },
      },
    ],
    priority: 10,
    enabled: true,
  },
  {
    id: 'age_7_12_content',
    name: '7-12å²å†…å®¹é€‚é…',
    description: 'ä¸º7-12å²å„¿ç«¥æ¨èé€‚åˆçš„å†…å®¹',
    sourceType: 'age',
    targetType: 'content',
    conditions: [
      { field: 'age', operator: 'gte', value: 7 },
      { field: 'age', operator: 'lte', value: 12 },
    ],
    actions: [
      {
        type: 'filter',
        target: 'content',
        parameters: {
          minAge: 7,
          maxAge: 12,
          difficulty: 'medium',
        },
      },
      {
        type: 'boost',
        target: 'content',
        parameters: {
          categories: ['ç§‘æ™®', 'æ–‡åŒ–', 'å†å²'],
          boostFactor: 1.5,
        },
      },
    ],
    priority: 10,
    enabled: true,
  },
];
```

### 8.2 æ–‡åŒ–èåˆæ˜ å°„

#### 8.2.1 æ´›é˜³æ–‡åŒ–å…ƒç´ æ˜ å°„

```typescript
export interface CultureElement {
  id: string;
  name: string;
  category: string;
  description: string;
  images: string[];
  audio?: string;
  video?: string;
  relatedContent: string[];
  ageRanges: [number, number][];
  tags: string[];
}

export const luoyangCultureElements: CultureElement[] = [
  {
    id: 'longmen_grottoes',
    name: 'é¾™é—¨çŸ³çªŸ',
    category: 'å†å²é—è¿¹',
    description: 'é¾™é—¨çŸ³çªŸæ˜¯ä¸­å›½å››å¤§çŸ³çªŸä¹‹ä¸€ï¼Œå§‹å»ºäºåŒ—é­æ—¶æœŸï¼Œæ‹¥æœ‰ä¸°å¯Œçš„ä½›æ•™è‰ºæœ¯çå“ã€‚',
    images: ['longmen_1.jpg', 'longmen_2.jpg', 'longmen_3.jpg'],
    relatedContent: ['ä½›æ•™è‰ºæœ¯', 'åŒ—é­å†å²', 'çŸ³åˆ»è‰ºæœ¯'],
    ageRanges: [[7, 12], [13, 18]],
    tags: ['å†å²', 'è‰ºæœ¯', 'ä½›æ•™', 'ä¸–ç•Œé—äº§'],
  },
  {
    id: 'white_horse_temple',
    name: 'ç™½é©¬å¯º',
    category: 'å®—æ•™å»ºç­‘',
    description: 'ç™½é©¬å¯ºæ˜¯ä¸­å›½ç¬¬ä¸€åº§å®˜åŠä½›æ•™å¯ºé™¢ï¼Œè¢«èª‰ä¸º"ä¸­å›½ä½›æ•™çš„ç¥–åº­"ã€‚',
    images: ['baimasi_1.jpg', 'baimasi_2.jpg'],
    relatedContent: ['ä½›æ•™ä¼ å…¥', 'å¯ºé™¢å»ºç­‘', 'ä½›æ•™æ–‡åŒ–'],
    ageRanges: [[7, 12], [13, 18]],
    tags: ['å®—æ•™', 'å†å²', 'å»ºç­‘', 'ä½›æ•™'],
  },
  {
    id: 'peony_festival',
    name: 'ç‰¡ä¸¹èŠ±ä¼š',
    category: 'æ°‘ä¿—æ´»åŠ¨',
    description: 'æ´›é˜³ç‰¡ä¸¹èŠ±ä¼šæ˜¯æ¯å¹´æ˜¥å­£ä¸¾åŠçš„å¤§å‹æ–‡åŒ–æ´»åŠ¨ï¼Œå±•ç¤ºå„ç§åè´µç‰¡ä¸¹å“ç§ã€‚',
    images: ['peony_1.jpg', 'peony_2.jpg', 'peony_3.jpg'],
    audio: 'peony_introduction.mp3',
    relatedContent: ['èŠ±å‰çŸ¥è¯†', 'æ˜¥å­£ä¹ ä¿—', 'æ´›é˜³æ–‡åŒ–'],
    ageRanges: [[3, 6], [7, 12], [13, 18]],
    tags: ['èŠ±å‰', 'æ°‘ä¿—', 'æ˜¥å­£', 'æ–‡åŒ–'],
  },
];

export class CultureMappingEngine {
  private elements: Map<string, CultureElement> = new Map();
  
  constructor(elements: CultureElement[]) {
    elements.forEach(element => {
      this.elements.set(element.id, element);
    });
  }
  
  getElementsByCategory(category: string): CultureElement[] {
    return Array.from(this.elements.values()).filter(
      element => element.category === category
    );
  }
  
  getElementsByAge(age: number): CultureElement[] {
    return Array.from(this.elements.values()).filter(element =>
      element.ageRanges.some(([min, max]) => age >= min && age <= max)
    );
  }
  
  getElementsByTags(tags: string[]): CultureElement[] {
    return Array.from(this.elements.values()).filter(element =>
      tags.some(tag => element.tags.includes(tag))
    );
  }
  
  searchElements(query: string): CultureElement[] {
    const lowerQuery = query.toLowerCase();
    return Array.from(this.elements.values()).filter(element =>
      element.name.toLowerCase().includes(lowerQuery) ||
      element.description.toLowerCase().includes(lowerQuery) ||
      element.tags.some(tag => tag.toLowerCase().includes(lowerQuery))
    );
  }
  
  getRelatedContent(elementId: string): string[] {
    const element = this.elements.get(elementId);
    return element?.relatedContent || [];
  }
  
  getRecommendedElements(userId: string, userPersona: UserPersona): CultureElement[] {
    const age = userPersona.basicInfo.age;
    const interests = userPersona.preferences.contentPreferences.culturalInterests;
    
    let elements = this.getElementsByAge(age);
    
    if (interests.length > 0) {
      const interestElements = this.getElementsByTags(interests);
      elements = [...new Set([...elements, ...interestElements])];
    }
    
    return elements;
  }
}
```

---

## ä¹ã€æŠ€æœ¯å®ç°è§„èŒƒ

### 9.1 ä»£ç è§„èŒƒ

#### 9.1.1 TypeScriptè§„èŒƒ

```typescript
export const TypeScriptRules = {
  å‘½åè§„èŒƒ: {
    æ¥å£: 'ä½¿ç”¨PascalCaseï¼Œä»¥Iå¼€å¤´ï¼ˆå¯é€‰ï¼‰',
    ç±»å‹: 'ä½¿ç”¨PascalCase',
    ç±»: 'ä½¿ç”¨PascalCase',
    å‡½æ•°: 'ä½¿ç”¨camelCase',
    å˜é‡: 'ä½¿ç”¨camelCase',
    å¸¸é‡: 'ä½¿ç”¨UPPER_SNAKE_CASE',
    ç§æœ‰æˆå‘˜: 'ä½¿ç”¨ä¸‹åˆ’çº¿å‰ç¼€',
  },
  
  ç±»å‹å®šä¹‰: {
    ä¼˜å…ˆä½¿ç”¨æ¥å£: 'å¯¹äºå¯¹è±¡ç±»å‹ï¼Œä¼˜å…ˆä½¿ç”¨interface',
    ç±»å‹åˆ«å: 'ç”¨äºè”åˆç±»å‹ã€äº¤å‰ç±»å‹ç­‰',
    æ³›å‹: 'ä½¿ç”¨Tã€Uã€Vç­‰å•å­—æ¯æˆ–æè¿°æ€§åç§°',
    å¯é€‰å±æ€§: 'ä½¿ç”¨?æ ‡è®°',
    åªè¯»å±æ€§: 'ä½¿ç”¨readonlyæ ‡è®°',
  },
  
  æ³¨é‡Šè§„èŒƒ: {
    æ–‡ä»¶æ³¨é‡Š: 'æ¯ä¸ªæ–‡ä»¶é¡¶éƒ¨æ·»åŠ æ–‡ä»¶è¯´æ˜',
    å‡½æ•°æ³¨é‡Š: 'ä½¿ç”¨JSDocæ ¼å¼',
    å¤æ‚é€»è¾‘: 'æ·»åŠ è¯¦ç»†æ³¨é‡Šè¯´æ˜',
    TODO: 'ä½¿ç”¨// TODO: æ ‡è®°å¾…åŠäº‹é¡¹',
  },
  
  ä»£ç ç»„ç»‡: {
    å¯¼å…¥é¡ºåº: 'ç¬¬ä¸‰æ–¹åº“ -> å†…éƒ¨æ¨¡å— -> ç±»å‹å¯¼å…¥',
    å¯¼å‡º: 'ä½¿ç”¨å‘½åå¯¼å‡ºï¼Œé¿å…é»˜è®¤å¯¼å‡º',
    æ–‡ä»¶å¤§å°: 'å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡500è¡Œ',
    å‡½æ•°é•¿åº¦: 'å•ä¸ªå‡½æ•°ä¸è¶…è¿‡50è¡Œ',
  },
};
```

#### 9.1.2 Reactç»„ä»¶è§„èŒƒ

```typescript
export const ReactComponentRules = {
  ç»„ä»¶å®šä¹‰: {
    å‡½æ•°ç»„ä»¶: 'ä¼˜å…ˆä½¿ç”¨å‡½æ•°ç»„ä»¶',
    Hooks: 'åˆç†ä½¿ç”¨Hooksï¼Œé¿å…è¿‡åº¦ä½¿ç”¨',
    Props: 'ä½¿ç”¨interfaceå®šä¹‰Propsç±»å‹',
    é»˜è®¤Props: 'ä½¿ç”¨å‚æ•°é»˜è®¤å€¼ä»£æ›¿defaultProps',
  },
  
  çŠ¶æ€ç®¡ç†: {
    æœ¬åœ°çŠ¶æ€: 'ä½¿ç”¨useState',
    å¤æ‚çŠ¶æ€: 'ä½¿ç”¨useReducer',
    å…¨å±€çŠ¶æ€: 'ä½¿ç”¨Reduxæˆ–Context',
    å‰¯ä½œç”¨: 'ä½¿ç”¨useEffect',
  },
  
  æ€§èƒ½ä¼˜åŒ–: {
    è®°å¿†åŒ–: 'ä½¿ç”¨useMemoç¼“å­˜è®¡ç®—ç»“æœ',
    å›è°ƒ: 'ä½¿ç”¨useCallbackç¼“å­˜å‡½æ•°',
    åˆ—è¡¨æ¸²æŸ“: 'ä½¿ç”¨keyå±æ€§',
    æ‡’åŠ è½½: 'ä½¿ç”¨React.lazyå’ŒSuspense',
  },
  
  æ ·å¼å¤„ç†: {
    CSSæ¨¡å—: 'ä½¿ç”¨CSS Modulesæˆ–styled-components',
    Tailwind: 'ä½¿ç”¨Tailwind CSSå·¥å…·ç±»',
    å“åº”å¼: 'ä½¿ç”¨åª’ä½“æŸ¥è¯¢æˆ–å“åº”å¼ç»„ä»¶',
  },
};
```

### 9.2 æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

#### 9.2.1 åŠ è½½æ€§èƒ½

```typescript
export const PerformanceRules = {
  èµ„æºåŠ è½½: {
    å›¾ç‰‡ä¼˜åŒ–: 'ä½¿ç”¨WebPæ ¼å¼ï¼Œè®¾ç½®æ‡’åŠ è½½',
    ä»£ç åˆ†å‰²: 'ä½¿ç”¨åŠ¨æ€importè¿›è¡Œä»£ç åˆ†å‰²',
    é¢„åŠ è½½: 'å¯¹å…³é”®èµ„æºä½¿ç”¨preload',
    CDN: 'ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº',
  },
  
  æ¸²æŸ“æ€§èƒ½: {
    è™šæ‹Ÿåˆ—è¡¨: 'é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨',
    é˜²æŠ–èŠ‚æµ: 'ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµä¼˜åŒ–é¢‘ç¹æ“ä½œ',
    é¿å…é‡æ¸²æŸ“: 'ä½¿ç”¨React.memoé¿å…ä¸å¿…è¦çš„æ¸²æŸ“',
    æ‰¹é‡æ›´æ–°: 'ä½¿ç”¨æ‰¹é‡æ›´æ–°å‡å°‘æ¸²æŸ“æ¬¡æ•°',
  },
  
  ç½‘ç»œæ€§èƒ½: {
    è¯·æ±‚åˆå¹¶: 'åˆå¹¶å¤šä¸ªè¯·æ±‚',
    ç¼“å­˜ç­–ç•¥: 'ä½¿ç”¨HTTPç¼“å­˜å’Œæœ¬åœ°ç¼“å­˜',
    æ•°æ®å‹ç¼©: 'å¯ç”¨gzipå‹ç¼©',
    WebSocket: 'å®æ—¶æ•°æ®ä½¿ç”¨WebSocket',
  },
  
  ç›‘æ§æŒ‡æ ‡: {
    FCP: 'é¦–æ¬¡å†…å®¹ç»˜åˆ¶æ—¶é—´ < 1.8s',
    LCP: 'æœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´ < 2.5s',
    FID: 'é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ < 100ms',
    CLS: 'ç´¯ç§¯å¸ƒå±€åç§» < 0.1',
  },
};
```

---

## åã€è®¾è®¡è§„èŒƒä¸æ ‡å‡†

### 10.1 è§†è§‰è®¾è®¡è§„èŒƒ

#### 10.1.1 è‰²å½©ç³»ç»Ÿ

```typescript
export const ColorSystem = {
  ä¸»è‰²è°ƒ: {
    primary: {
      50: '#F5F3FF',
      100: '#EDE9FE',
      200: '#DDD6FE',
      300: '#C4B5FD',
      400: '#A78BFA',
      500: '#8B5CF6',
      600: '#7C3AED',
      700: '#6D28D9',
      800: '#5B21B6',
      900: '#4C1D95',
    },
    secondary: {
      50: '#FDF2F8',
      100: '#FCE7F3',
      200: '#FBCFE8',
      300: '#F9A8D4',
      400: '#F472B6',
      500: '#EC4899',
      600: '#DB2777',
      700: '#BE185D',
      800: '#9D174D',
      900: '#831843',
    },
  },
  
  ä¸­æ€§è‰²: {
    gray: {
      50: '#F9FAFB',
      100: '#F3F4F6',
      200: '#E5E7EB',
      300: '#D1D5DB',
      400: '#9CA3AF',
      500: '#6B7280',
      600: '#4B5563',
      700: '#374151',
      800: '#1F2937',
      900: '#111827',
    },
  },
  
  è¯­ä¹‰è‰²: {
    success: '#10B981',
    warning: '#F59E0B',
    error: '#EF4444',
    info: '#3B82F6',
  },
  
  æ¸å˜è‰²: {
    primary: 'linear-gradient(135deg, #7C3AED 0%, #DB2777 100%)',
    secondary: 'linear-gradient(135deg, #8B5CF6 0%, #EC4899 100%)',
    background: 'linear-gradient(180deg, #F5F3FF 0%, #FDF2F8 100%)',
  },
};
```

#### 10.1.2 å­—ä½“ç³»ç»Ÿ

```typescript
export const TypographySystem = {
  å­—ä½“å®¶æ—: {
    primary: '"PingFang SC", "Microsoft YaHei", "Helvetica Neue", Arial, sans-serif',
    secondary: '"Georgia", "Times New Roman", serif',
    monospace: '"Menlo", "Monaco", "Courier New", monospace',
  },
  
  å­—å·: {
    xs: '0.75rem',
    sm: '0.875rem',
    base: '1rem',
    lg: '1.125rem',
    xl: '1.25rem',
    '2xl': '1.5rem',
    '3xl': '1.875rem',
    '4xl': '2.25rem',
    '5xl': '3rem',
    '6xl': '3.75rem',
  },
  
  å­—é‡: {
    light: 300,
    normal: 400,
    medium: 500,
    semibold: 600,
    bold: 700,
  },
  
  è¡Œé«˜: {
    tight: 1.25,
    normal: 1.5,
    relaxed: 1.75,
    loose: 2,
  },
  
  å­—é—´è·: {
    tighter: '-0.05em',
    tight: '-0.025em',
    normal: '0',
    wide: '0.025em',
    wider: '0.05em',
    widest: '0.1em',
  },
};
```

#### 10.1.3 é—´è·ç³»ç»Ÿ

```typescript
export const SpacingSystem = {
  é—´è·å•ä½: {
    0: '0',
    1: '0.25rem',
    2: '0.5rem',
    3: '0.75rem',
    4: '1rem',
    5: '1.25rem',
    6: '1.5rem',
    8: '2rem',
    10: '2.5rem',
    12: '3rem',
    16: '4rem',
    20: '5rem',
    24: '6rem',
  },
  
  å®¹å™¨å®½åº¦: {
    sm: '640px',
    md: '768px',
    lg: '1024px',
    xl: '1280px',
    '2xl': '1536px',
  },
  
  åœ†è§’: {
    none: '0',
    sm: '0.125rem',
    default: '0.25rem',
    md: '0.375rem',
    lg: '0.5rem',
    xl: '0.75rem',
    '2xl': '1rem',
    '3xl': '1.5rem',
    full: '9999px',
  },
  
  é˜´å½±: {
    sm: '0 1px 2px 0 rgba(0, 0, 0, 0.05)',
    default: '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
    md: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
    lg: '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
    xl: '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
  },
};
```

### 10.2 äº¤äº’è®¾è®¡è§„èŒƒ

#### 10.2.1 åŠ¨ç”»è§„èŒƒ

```typescript
export const AnimationSystem = {
  æ—¶é•¿: {
    fast: '150ms',
    normal: '300ms',
    slow: '500ms',
  },
  
  ç¼“åŠ¨å‡½æ•°: {
    easeIn: 'cubic-bezier(0.4, 0, 1, 1)',
    easeOut: 'cubic-bezier(0, 0, 0.2, 1)',
    easeInOut: 'cubic-bezier(0.4, 0, 0.2, 1)',
    bounce: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)',
  },
  
  åŠ¨ç”»ç±»å‹: {
    fade: 'opacity',
    slide: 'transform',
    scale: 'transform',
    rotate: 'transform',
  },
  
  è¿‡æ¸¡æ•ˆæœ: {
    default: 'all 300ms cubic-bezier(0.4, 0, 0.2, 1)',
    fast: 'all 150ms cubic-bezier(0.4, 0, 0.2, 1)',
    slow: 'all 500ms cubic-bezier(0.4, 0, 0.2, 1)',
  },
};
```

#### 10.2.2 æ‰‹åŠ¿è§„èŒƒ

```typescript
export const GestureSystem = {
  ç‚¹å‡»: {
    æœ€å°ç‚¹å‡»åŒºåŸŸ: '44px Ã— 44px',
    ç‚¹å‡»åé¦ˆ: '100mså†…æ˜¾ç¤ºåé¦ˆ',
    åŒå‡»: 'é—´éš” < 300ms',
  },
  
  æ»‘åŠ¨: {
    æœ€å°æ»‘åŠ¨è·ç¦»: '10px',
    æ»‘åŠ¨é€Ÿåº¦é˜ˆå€¼: '0.3px/ms',
    æ»‘åŠ¨æ–¹å‘: 'æ°´å¹³ã€å‚ç›´ã€å¯¹è§’',
  },
  
  ç¼©æ”¾: {
    æœ€å°ç¼©æ”¾æ¯”ä¾‹: '0.5',
    æœ€å¤§ç¼©æ”¾æ¯”ä¾‹: '3.0',
    ç¼©æ”¾ä¸­å¿ƒ: 'åŒæŒ‡ä¸­å¿ƒç‚¹',
  },
  
  é•¿æŒ‰: {
    æœ€å°é•¿æŒ‰æ—¶é•¿: '500ms',
    é•¿æŒ‰åé¦ˆ: 'éœ‡åŠ¨æˆ–è§†è§‰åé¦ˆ',
    é•¿æŒ‰åŠ¨ä½œ: 'æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•',
  },
};
```

### 10.3 å¯è®¿é—®æ€§è§„èŒƒ

#### 10.3.1 WCAGæ ‡å‡†

```typescript
export const AccessibilityRules = {
  æ„ŸçŸ¥æ€§: {
    æ–‡æœ¬æ›¿ä»£: 'æ‰€æœ‰éæ–‡æœ¬å†…å®¹æä¾›æ›¿ä»£æ–‡æœ¬',
    éŸ³é¢‘æ§åˆ¶: 'æä¾›æ’­æ”¾æ§åˆ¶',
    è§†é¢‘å­—å¹•: 'æä¾›å­—å¹•å’Œæ‰‹è¯­',
    å¯¹æ¯”åº¦: 'æ–‡æœ¬å¯¹æ¯”åº¦è‡³å°‘4.5:1',
  },
  
  å¯æ“ä½œæ€§: {
    é”®ç›˜è®¿é—®: 'æ‰€æœ‰åŠŸèƒ½å¯é€šè¿‡é”®ç›˜è®¿é—®',
    ç„¦ç‚¹ç®¡ç†: 'æ¸…æ™°çš„ç„¦ç‚¹æŒ‡ç¤º',
    æ—¶é—´é™åˆ¶: 'æä¾›å…³é—­æˆ–å»¶é•¿æ—¶é—´é™åˆ¶çš„é€‰é¡¹',
    é—ªçƒå†…å®¹: 'é¿å…è¶…è¿‡3æ¬¡/ç§’çš„é—ªçƒ',
  },
  
  å¯ç†è§£æ€§: {
    è¯­è¨€å£°æ˜: 'æ˜ç¡®å£°æ˜é¡µé¢è¯­è¨€',
    é”™è¯¯æç¤º: 'æ¸…æ™°çš„é”™è¯¯è¯´æ˜å’Œå»ºè®®',
    ä¸€è‡´æ€§: 'ä¸€è‡´çš„å¯¼èˆªå’Œæ ‡è¯†',
    å¸®åŠ©æ–‡æ¡£: 'æä¾›å¸®åŠ©å’Œè¯´æ˜',
  },
  
  å¥å£®æ€§: {
    HTMLæ ‡å‡†: 'ä½¿ç”¨æ ‡å‡†HTMLå…ƒç´ ',
    ARIA: 'æ­£ç¡®ä½¿ç”¨ARIAå±æ€§',
    å…¼å®¹æ€§: 'ä¸è¾…åŠ©æŠ€æœ¯å…¼å®¹',
  },
};
```

---

## é™„å½•

### A. ç»„ä»¶ç´¢å¼•

| ç»„ä»¶åç§° | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|---------|---------|------|
| Button | /components/foundation/Button.tsx | åŸºç¡€æŒ‰é’®ç»„ä»¶ |
| Card | /components/foundation/Card.tsx | å¡ç‰‡ç»„ä»¶ |
| Input | /components/foundation/Input.tsx | è¾“å…¥æ¡†ç»„ä»¶ |
| LoadingSpinner | /components/foundation/LoadingSpinner.tsx | åŠ è½½å™¨ç»„ä»¶ |
| Toast | /components/foundation/Toast.tsx | æç¤ºæ¡†ç»„ä»¶ |
| GrowthCard | /components/business/GrowthCard.tsx | æˆé•¿å¡ç‰‡ç»„ä»¶ |
| CultureCarousel | /components/business/CultureCarousel.tsx | æ–‡åŒ–è½®æ’­ç»„ä»¶ |
| AIFloatingWindow | /components/system/AIFloatingWindow.tsx | AIæµ®çª—ç»„ä»¶ |

### B. APIç«¯ç‚¹ç´¢å¼•

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| /api/users/{userId} | GET | è·å–ç”¨æˆ·ä¿¡æ¯ |
| /api/users/{userId} | PUT | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ |
| /api/users/{userId}/growth-records | GET | è·å–æˆé•¿è®°å½• |
| /api/contents | GET | è·å–å†…å®¹åˆ—è¡¨ |
| /api/contents/{contentId} | GET | è·å–å†…å®¹è¯¦æƒ… |
| /api/ai/message | POST | å‘é€AIæ¶ˆæ¯ |
| /api/ai/voice/start | POST | å¼€å§‹è¯­éŸ³è¯†åˆ« |
| /api/ai/voice/stop | POST | åœæ­¢è¯­éŸ³è¯†åˆ« |

### C. å‚è€ƒæ–‡æ¡£

- [Next.js 14æ–‡æ¡£](https://nextjs.org/docs)
- [React 18æ–‡æ¡£](https://react.dev)
- [TypeScriptæ–‡æ¡£](https://www.typescriptlang.org/docs)
- [Tailwind CSSæ–‡æ¡£](https://tailwindcss.com/docs)
- [Redux Toolkitæ–‡æ¡£](https://redux-toolkit.js.org)
- [WCAG 2.1æŒ‡å—](https://www.w3.org/WAI/WCAG21/quickref/)

---

**æ–‡æ¡£ç»“æŸ**

> ã€Œ***YanYuCloudCube***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for the Future***ã€
> ã€Œ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***ã€
