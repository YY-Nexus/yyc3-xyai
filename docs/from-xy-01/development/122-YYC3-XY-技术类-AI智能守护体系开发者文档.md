# AIæ™ºèƒ½å®ˆæŠ¤å¼€å‘è€…æ–‡æ¡£
>
> ã€ŒYYCÂ³ æ™ºèƒ½æ’æ‹”å¼ç§»åŠ¨AIç³»ç»Ÿã€
ã€Œè¨€å¯è±¡é™ | è¯­æ¢æœªæ¥ã€
ã€ŒWords Initiate Quadrants, Language Serves as Core for the Futureã€
ã€Œä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒã€
ã€ŒAll things converge in the cloud pivot; Deep stacks ignite a new era of intelligenceã€
ã€ŒYYCÂ³ AI Intelligent Programming Development Application Project Delivery Work Instructionã€
---

## â€”â€”å°è¯­æˆé•¿å®ˆæŠ¤ä½“ç³»æ ‡å‡†åŒ–å¼€å‘æŒ‡å¯¼ä¹¦

---
<div align="center">

> ã€Œ***æ™ºèƒ½æ’æ‹”å¼ç§»åŠ¨AIç³»ç»Ÿ***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for the Future***ã€
> ã€Œ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***ã€
> **GitHub**: <https://github.com/YYC-Cube/yyc3_xiaoyu_ai> | **å®˜ç½‘**: <https://yyc3.ai>

</div>
## ğŸ“‹ æ–‡æ¡£ç›®å½•

### ğŸ“– å¿«é€Ÿå¯¼èˆª

- [é¡¹ç›®æ¦‚è¿°](#ç¬¬ä¸€ç« -é¡¹ç›®æ¦‚è¿°) - äº†è§£é¡¹ç›®èƒŒæ™¯ã€æ„¿æ™¯ä¸æ ¸å¿ƒä»·å€¼
- [æŠ€æœ¯æ¶æ„](#ç¬¬äºŒç« -æŠ€æœ¯æ¶æ„) - æŒæ¡æŠ€æœ¯æ ˆã€ç³»ç»Ÿæ¡†æ¶ä¸æ•°æ®æ¶æ„
- [æ–‡ä»¶æ ‘ç»“æ„](#ç¬¬ä¸‰ç« -æ–‡ä»¶æ ‘ç»“æ„) - ç†Ÿæ‚‰é¡¹ç›®ç›®å½•è§„èŒƒä¸å‘½åæ ‡å‡†
- [UIå…¨å±€è®¾è®¡](#ç¬¬å››ç« -uiå…¨å±€è®¾è®¡) - å­¦ä¹ è®¾è®¡ç³»ç»Ÿã€äº¤äº’åŸåˆ™ä¸ç»„ä»¶åº“
- [AIè§’è‰²ç³»ç»Ÿ](#ç¬¬äº”ç« -aiè§’è‰²ç³»ç»Ÿ) - æ·±å…¥äº”å¤§è§’è‰²å®šä¹‰ä¸äº¤äº’æœºåˆ¶
- [å¼€å‘æ ‡å‡†åŒ–](#ç¬¬å…­ç« -å¼€å‘æ ‡å‡†åŒ–) - éµå¾ªç¼–ç è§„èŒƒã€æµ‹è¯•æ ‡å‡†ä¸éƒ¨ç½²æµç¨‹
- [é—­ç¯å¼€å‘æµç¨‹](#ç¬¬ä¸ƒç« -é—­ç¯å¼€å‘æµç¨‹) - æŒæ¡éœ€æ±‚åˆ†æã€è®¾è®¡å¼€å‘ä¸æµ‹è¯•éªŒè¯

---

### ç¬¬ä¸€ç«  é¡¹ç›®æ¦‚è¿°

- [1.1 é¡¹ç›®èƒŒæ™¯ä¸æ„¿æ™¯](#11-é¡¹ç›®èƒŒæ™¯ä¸æ„¿æ™¯)
  - [é¡¹ç›®å®šä½](#é¡¹ç›®å®šä½)
  - [æ ¸å¿ƒæ„¿æ™¯](#æ ¸å¿ƒæ„¿æ™¯)
  - [é¡¹ç›®ç‰¹è‰²](#é¡¹ç›®ç‰¹è‰²)
- [1.2 äº”é«˜äº”æ ‡äº”åŒ–æ ¸å¿ƒæ¡†æ¶](#12-äº”é«˜äº”æ ‡äº”åŒ–æ ¸å¿ƒæ¡†æ¶)
  - [äº”é«˜åŸåˆ™ï¼ˆæ ¸å¿ƒå®šä½ï¼‰](#äº”é«˜åŸåˆ™æ ¸å¿ƒå®šä½)
  - [äº”æ ‡ä½“ç³»ï¼ˆæ‰§è¡Œæ ‡å‡†ï¼‰](#äº”æ ‡ä½“ç³»æ‰§è¡Œæ ‡å‡†)
  - [äº”åŒ–æ¶æ„ï¼ˆä½“ç³»ç»“æ„ï¼‰](#äº”åŒ–æ¶æ„ä½“ç³»ç»“æ„)
- [1.3 ç³»ç»Ÿæ¶æ„æ€»è§ˆ](#13-ç³»ç»Ÿæ¶æ„æ€»è§ˆ)
  - [æ•´ä½“æ¶æ„å›¾](#æ•´ä½“æ¶æ„å›¾)
- [1.4 æ ¸å¿ƒä»·å€¼ä¸»å¼ ](#14-æ ¸å¿ƒä»·å€¼ä¸»å¼ )
  - [å¯¹å„¿ç«¥](#å¯¹å„¿ç«¥)
  - [å¯¹å®¶é•¿](#å¯¹å®¶é•¿)
  - [å¯¹ç¤¾ä¼š](#å¯¹ç¤¾ä¼š)

### ç¬¬äºŒç«  æŠ€æœ¯æ¶æ„

- [2.1 æŠ€æœ¯æ ˆé€‰å‹](#21-æŠ€æœ¯æ ˆé€‰å‹)
  - [å‰ç«¯æŠ€æœ¯æ ˆ](#å‰ç«¯æŠ€æœ¯æ ˆ)
  - [åç«¯æŠ€æœ¯æ ˆ](#åç«¯æŠ€æœ¯æ ˆ)
  - [AIæŠ€æœ¯æ ˆ](#aiæŠ€æœ¯æ ˆ)
  - [åŸºç¡€è®¾æ–½](#åŸºç¡€è®¾æ–½)
- [2.2 ç³»ç»Ÿæ¡†æ¶è®¾è®¡](#22-ç³»ç»Ÿæ¡†æ¶è®¾è®¡)
  - [å‰ç«¯æ¡†æ¶æ¶æ„](#å‰ç«¯æ¡†æ¶æ¶æ„)
  - [åç«¯æ¡†æ¶æ¶æ„](#åç«¯æ¡†æ¶æ¶æ„)
- [2.3 æ•°æ®æ¶æ„è§„åˆ’](#23-æ•°æ®æ¶æ„è§„åˆ’)
  - [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
  - [æ•°æ®æµæ¶æ„](#æ•°æ®æµæ¶æ„)
- [2.4 AIå¼•æ“æ¶æ„](#24-aiå¼•æ“æ¶æ„)
  - [æ ¸å¿ƒæ¨¡å—è®¾è®¡](#æ ¸å¿ƒæ¨¡å—è®¾è®¡)

### ç¬¬ä¸‰ç«  æ–‡ä»¶æ ‘ç»“æ„

- [3.1 é¡¹ç›®ç›®å½•è§„èŒƒ](#31-é¡¹ç›®ç›®å½•è§„èŒƒ)
  - [å®Œæ•´ç›®å½•ç»“æ„](#å®Œæ•´ç›®å½•ç»“æ„)
- [3.2 æ¨¡å—åŒ–ç»„ç»‡åŸåˆ™](#32-æ¨¡å—åŒ–ç»„ç»‡åŸåˆ™)
  - [å‰ç«¯æ¨¡å—åŒ–](#å‰ç«¯æ¨¡å—åŒ–)
  - [åç«¯æ¨¡å—åŒ–](#åç«¯æ¨¡å—åŒ–)
- [3.3 å‘½åè§„èŒƒæ ‡å‡†](#33-å‘½åè§„èŒƒæ ‡å‡†)
  - [å‰ç«¯æ–‡ä»¶å‘½å](#å‰ç«¯æ–‡ä»¶å‘½å)
  - [åç«¯æ–‡ä»¶å‘½å](#åç«¯æ–‡ä»¶å‘½å)
  - [AIå¼•æ“æ–‡ä»¶å‘½å](#aiå¼•æ“æ–‡ä»¶å‘½å)
  - [æ•°æ®ç›®å½•å‘½å](#æ•°æ®ç›®å½•å‘½å)
  - [Pythonå‘½åè§„èŒƒ](#pythonå‘½åè§„èŒƒ)
  - [å¸¸é‡å‘½å](#å¸¸é‡å‘½å)
- [3.4 æ–‡ä»¶ç®¡ç†ç­–ç•¥](#34-æ–‡ä»¶ç®¡ç†ç­–ç•¥)

### ç¬¬å››ç«  UIå…¨å±€è®¾è®¡

- [4.1 è®¾è®¡ç³»ç»Ÿè§„èŒƒ](#41-è®¾è®¡ç³»ç»Ÿè§„èŒƒ)
  - [è‰²å½©ç³»ç»Ÿ](#è‰²å½©ç³»ç»Ÿ)
  - [å­—ä½“ç³»ç»Ÿ](#å­—ä½“ç³»ç»Ÿ)
  - [é—´è·ç³»ç»Ÿ](#é—´è·ç³»ç»Ÿ)
  - [åœ†è§’ç³»ç»Ÿ](#åœ†è§’ç³»ç»Ÿ)
  - [é˜´å½±ç³»ç»Ÿ](#é˜´å½±ç³»ç»Ÿ)
- [4.2 äº¤äº’è®¾è®¡åŸåˆ™](#42-äº¤äº’è®¾è®¡åŸåˆ™)
  - [äº¤äº’åŸåˆ™](#äº¤äº’åŸåˆ™)
  - [åé¦ˆæœºåˆ¶](#åé¦ˆæœºåˆ¶)
  - [åŠ¨æ•ˆè§„èŒƒ](#åŠ¨æ•ˆè§„èŒƒ)
  - [æ— éšœç¢è®¾è®¡](#æ— éšœç¢è®¾è®¡)
- [4.3 ç»„ä»¶åº“æ¶æ„](#43-ç»„ä»¶åº“æ¶æ„)
  - [ç»„ä»¶åˆ†ç±»](#ç»„ä»¶åˆ†ç±»)
  - [ç»„ä»¶è§„èŒƒ](#ç»„ä»¶è§„èŒƒ)
  - [ç»„ä»¶æ–‡æ¡£](#ç»„ä»¶æ–‡æ¡£)
- [4.4 å“åº”å¼è®¾è®¡è§„èŒƒ](#44-å“åº”å¼è®¾è®¡è§„èŒƒ)
  - [æ–­ç‚¹ç³»ç»Ÿ](#æ–­ç‚¹ç³»ç»Ÿ)
  - [å¸ƒå±€ç­–ç•¥](#å¸ƒå±€ç­–ç•¥)
  - [åª’ä½“æŸ¥è¯¢](#åª’ä½“æŸ¥è¯¢)

### ç¬¬äº”ç«  AIè§’è‰²ç³»ç»Ÿ

- [5.1 äº”å¤§è§’è‰²å®šä¹‰](#51-äº”å¤§è§’è‰²å®šä¹‰)
  - [è§’è‰²åŸºç±»å®šä¹‰](#è§’è‰²åŸºç±»å®šä¹‰)
  - [è®°å½•è€…è§’è‰²](#è®°å½•è€…è§’è‰²)
  - [å®ˆæŠ¤è€…è§’è‰²](#å®ˆæŠ¤è€…è§’è‰²)
  - [è†å¬è€…è§’è‰²](#è†å¬è€…è§’è‰²)
  - [å»ºè®®è€…è§’è‰²](#å»ºè®®è€…è§’è‰²)
  - [å›½ç²¹å¯¼å¸ˆè§’è‰²](#å›½ç²¹å¯¼å¸ˆè§’è‰²)
- [5.2 è§’è‰²äº¤äº’æœºåˆ¶](#52-è§’è‰²äº¤äº’æœºåˆ¶)
  - [è§’è‰²åˆ‡æ¢æœºåˆ¶](#è§’è‰²åˆ‡æ¢æœºåˆ¶)
  - [è§’è‰²ååŒæœºåˆ¶](#è§’è‰²ååŒæœºåˆ¶)
  - [è§’è‰²è®°å¿†æœºåˆ¶](#è§’è‰²è®°å¿†æœºåˆ¶)
- [5.3 æç¤ºè¯å·¥ç¨‹](#53-æç¤ºè¯å·¥ç¨‹)
  - [ç³»ç»Ÿæç¤ºè¯](#ç³»ç»Ÿæç¤ºè¯)
  - [è§’è‰²æç¤ºè¯](#è§’è‰²æç¤ºè¯)
  - [åœºæ™¯æç¤ºè¯](#åœºæ™¯æç¤ºè¯)
- [5.4 æ™ºèƒ½å†³ç­–æµç¨‹](#54-æ™ºèƒ½å†³ç­–æµç¨‹)
  - [æ„å›¾è¯†åˆ«](#æ„å›¾è¯†åˆ«)
  - [çŸ¥è¯†æ£€ç´¢](#çŸ¥è¯†æ£€ç´¢)
  - [æ¨ç†å†³ç­–](#æ¨ç†å†³ç­–)
  - [å“åº”ç”Ÿæˆ](#å“åº”ç”Ÿæˆ)

### ç¬¬å…­ç«  å¼€å‘æ ‡å‡†åŒ–

- [6.1 ç¼–ç è§„èŒƒ](#61-ç¼–ç è§„èŒƒ)
  - [TypeScriptè§„èŒƒ](#typescriptè§„èŒƒ)
  - [Pythonè§„èŒƒ](#pythonè§„èŒƒ)
  - [ä»£ç æ³¨é‡Šè§„èŒƒ](#ä»£ç æ³¨é‡Šè§„èŒƒ)
  - [Gitæäº¤è§„èŒƒ](#gitæäº¤è§„èŒƒ)
- [6.2 æµ‹è¯•æ ‡å‡†](#62-æµ‹è¯•æ ‡å‡†)
  - [å•å…ƒæµ‹è¯•](#å•å…ƒæµ‹è¯•)
  - [é›†æˆæµ‹è¯•](#é›†æˆæµ‹è¯•)
  - [E2Eæµ‹è¯•](#e2eæµ‹è¯•)
  - [æµ‹è¯•è¦†ç›–ç‡](#æµ‹è¯•è¦†ç›–ç‡)
- [6.3 éƒ¨ç½²æµç¨‹](#63-éƒ¨ç½²æµç¨‹)
  - [CI/CDæµæ°´çº¿é…ç½®](#cicdæµæ°´çº¿é…ç½®)
  - [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
  - [éƒ¨ç½²ç­–ç•¥](#éƒ¨ç½²ç­–ç•¥)
  - [ç›‘æ§å‘Šè­¦](#ç›‘æ§å‘Šè­¦)

### ç¬¬ä¸ƒç«  é—­ç¯å¼€å‘æµç¨‹

- [7.1 éœ€æ±‚åˆ†æé˜¶æ®µ](#71-éœ€æ±‚åˆ†æé˜¶æ®µ)
  - [éœ€æ±‚åˆ†ææµç¨‹å›¾](#éœ€æ±‚åˆ†ææµç¨‹å›¾)
  - [éœ€æ±‚åˆ†ææ¨¡æ¿](#éœ€æ±‚åˆ†ææ¨¡æ¿)
- [7.2 è®¾è®¡å¼€å‘é˜¶æ®µ](#72-è®¾è®¡å¼€å‘é˜¶æ®µ)
  - [è®¾è®¡æµç¨‹](#è®¾è®¡æµç¨‹)
  - [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
- [7.3 æµ‹è¯•éªŒè¯é˜¶æ®µ](#73-æµ‹è¯•éªŒè¯é˜¶æ®µ)
  - [æµ‹è¯•æµç¨‹](#æµ‹è¯•æµç¨‹)
  - [éªŒæ”¶æ ‡å‡†](#éªŒæ”¶æ ‡å‡†)
- [7.4 éƒ¨ç½²è¿ç»´é˜¶æ®µ](#74-éƒ¨ç½²è¿ç»´é˜¶æ®µ)
  - [éƒ¨ç½²æµç¨‹](#éƒ¨ç½²æµç¨‹-1)
  - [è¿ç»´ç›‘æ§](#è¿ç»´ç›‘æ§)
  - [æŒç»­ä¼˜åŒ–](#æŒç»­ä¼˜åŒ–)

---

## ç¬¬ä¸€ç«  é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯ä¸æ„¿æ™¯

#### é¡¹ç›®å®šä½

å°è¯­æˆé•¿å®ˆæŠ¤ä½“ç³»æ˜¯é¢å‘AIåŸä½æ°‘æ—¶ä»£çš„å…¨å‘¨æœŸå„¿ç«¥æˆé•¿æ™ºèƒ½å®ˆæŠ¤ç³»ç»Ÿï¼Œé€šè¿‡èåˆå…ˆè¿›AIæŠ€æœ¯ä¸ä¸­åä¼˜ç§€ä¼ ç»Ÿæ–‡åŒ–ï¼Œä¸º0-6å²å„¿ç«¥æä¾›ç§‘å­¦ã€æ¸©æš–ã€ä¸ªæ€§åŒ–çš„æˆé•¿æ”¯æŒã€‚

#### æ ¸å¿ƒæ„¿æ™¯

- ç§‘æŠ€å‘å–„ï¼šè®©AIæŠ€æœ¯çœŸæ­£æœåŠ¡äºå„¿ç«¥å¥åº·æˆé•¿
- æ–‡åŒ–ä¼ æ‰¿ï¼šåœ¨æ•°å­—åŒ–æ—¶ä»£ä¼ æ‰¿ä¸­åä¼˜ç§€ä¼ ç»Ÿæ–‡åŒ–æ ¹è„‰
- ä¸ªæ€§å‘å±•ï¼šå°Šé‡æ¯ä¸ªå­©å­çš„ç‹¬ç‰¹æ€§ï¼Œæä¾›å®šåˆ¶åŒ–æˆé•¿è·¯å¾„
- å®¶åº­èµ‹èƒ½ï¼šä¸ºç°ä»£å®¶åº­æä¾›ç§‘å­¦çš„è‚²å„¿æ”¯æŒå·¥å…·

#### é¡¹ç›®ç‰¹è‰²

- äº”å¤§AIè§’è‰²ååŒå·¥ä½œï¼Œæä¾›å…¨æ–¹ä½æˆé•¿å®ˆæŠ¤
- å…­å¤§æˆé•¿é˜¶æ®µç²¾å‡†è¦†ç›–ï¼Œæ»¡è¶³ä¸åŒæ—¶æœŸå‘å±•éœ€æ±‚
- ä¼ ç»Ÿæ–‡åŒ–è‡ªç„¶èå…¥ï¼Œå®ç°æ–‡åŒ–æ ¹è„‰æµ¸æ¶¦
- ç§‘æŠ€äººæ–‡å¹³è¡¡å‘å±•ï¼Œé¿å…è¿‡åº¦æŠ€æœ¯åŒ–

### 1.2 äº”é«˜äº”æ ‡äº”åŒ–æ ¸å¿ƒæ¡†æ¶

#### äº”é«˜åŸåˆ™ï¼ˆæ ¸å¿ƒå®šä½ï¼‰

```plaintext
é«˜å‰ç»æ€§ï¼šé¢„åˆ¤å‘å±•é˜¶æ®µï¼Œæå‰è§„åˆ’æˆé•¿è·¯å¾„
é«˜æ•´åˆæ€§ï¼šèåˆåŒ»å­¦ã€å¿ƒç†å­¦ã€æ•™è‚²å­¦å¤šé¢†åŸŸçŸ¥è¯†
é«˜ä¸ªæ€§åŒ–ï¼šé€‚é…æ¯ä¸ªå­©å­çš„ç‹¬ç‰¹å‘å±•èŠ‚å¥
é«˜æƒ…æ„Ÿä»·å€¼ï¼šå…³æ³¨äº²å­æƒ…æ„Ÿè”ç»“ï¼Œè®°å½•æ¸©æš–ç¬é—´
é«˜å®æ“æ€§ï¼šæä¾›å…·ä½“å¯æ‰§è¡Œçš„è‚²å„¿æŒ‡å¯¼æ–¹æ¡ˆ

```

#### äº”æ ‡ä½“ç³»ï¼ˆæ‰§è¡Œæ ‡å‡†ï¼‰

```plaintext
æ•°æ®æ ‡å‡†åŒ–ï¼šå‚è€ƒWHOç­‰æƒå¨æœºæ„å‘å±•æ ‡å‡†
å‘å±•æ ‡å‡†åŒ–ï¼šåŸºäºå‘å±•å¿ƒç†å­¦æƒå¨ç†è®ºä½“ç³»
å®‰å…¨æ ‡å‡†åŒ–ï¼šéµå¾ªå„¿ç§‘å®‰å…¨è§„èŒƒä¸éšç§ä¿æŠ¤
è®°å½•æ ‡å‡†åŒ–ï¼šé‡‡ç”¨ç»Ÿä¸€æ ¼å¼çš„æˆé•¿è®°å½•æ¨¡æ¿
è¯„ä¼°æ ‡å‡†åŒ–ï¼šä½¿ç”¨ç§‘å­¦çš„è¯„ä¼°å·¥å…·ä¸æŒ‡æ ‡ä½“ç³»

```

#### äº”åŒ–æ¶æ„ï¼ˆä½“ç³»ç»“æ„ï¼‰

```plaintext
é˜¶æ®µåŒ–ï¼šæŒ‰0-6å²åˆ’åˆ†ä¸ºå…­å¤§å‘å±•é˜¶æ®µ
æ¨¡å—åŒ–ï¼šå°†æˆé•¿ä½“ç³»åˆ†è§£ä¸ºå¯å¤ç”¨åŠŸèƒ½æ¨¡å—
åœºæ™¯åŒ–ï¼šé’ˆå¯¹å…·ä½“è‚²å„¿åœºæ™¯æä¾›è§£å†³æ–¹æ¡ˆ
å·¥å…·åŒ–ï¼šæä¾›å®ç”¨çš„è®°å½•å·¥å…·ä¸è¯„ä¼°é‡è¡¨
æ•…äº‹åŒ–ï¼šå°†æˆé•¿è®°å½•è½¬åŒ–ä¸ºæ¸©æš–çš„æ•…äº‹å™è¿°

```

### 1.3 ç³»ç»Ÿæ¶æ„æ€»è§ˆ

#### æ•´ä½“æ¶æ„å›¾

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·äº¤äº’å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Webå‰ç«¯    â”‚  ç§»åŠ¨ç«¯App   â”‚  æ™ºèƒ½ç¡¬ä»¶   â”‚  APIæ¥å£      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   ä¸šåŠ¡é€»è¾‘å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  è®°å½•è€…    â”‚  å®ˆæŠ¤è€…    â”‚  è†å¬è€…    â”‚  å»ºè®®è€…    â”‚  â”‚
â”‚  â”‚  æ¨¡å—      â”‚  æ¨¡å—      â”‚  æ¨¡å—      â”‚  æ¨¡å—      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   AIæ™ºèƒ½å¼•æ“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  è‡ªç„¶è¯­è¨€   â”‚  çŸ¥è¯†å›¾è°±   â”‚  æ¨ç†å¼•æ“   â”‚  å­¦ä¹ ç®—æ³•   â”‚  â”‚
â”‚  â”‚  å¤„ç†æ¨¡å—   â”‚  æ„å»ºæ¨¡å—   â”‚  å†³ç­–æ¨¡å—   â”‚  ä¼˜åŒ–æ¨¡å—   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   æ•°æ®å­˜å‚¨å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æˆé•¿æ•°æ®   â”‚  å¤šåª’ä½“     â”‚  çŸ¥è¯†åº“     â”‚  é…ç½®ä¿¡æ¯   â”‚  â”‚
â”‚  â”‚  æ•°æ®åº“     â”‚  å­˜å‚¨ç³»ç»Ÿ   â”‚  ç³»ç»Ÿ       â”‚  ç³»ç»Ÿ       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 1.4 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

#### å¯¹å„¿ç«¥

- ä¸ªæ€§åŒ–æˆé•¿è·¯å¾„è§„åˆ’
- ç§‘å­¦çš„å‘å±•è¯„ä¼°ä¸æŒ‡å¯¼
- ä¸°å¯Œçš„æ–‡åŒ–ä½“éªŒä¸å­¦ä¹ 
- å®‰å…¨å‹å¥½çš„æ•°å­—ç¯å¢ƒ

#### å¯¹å®¶é•¿

- ä¸“ä¸šçš„è‚²å„¿æ”¯æŒå·¥å…·
- ç§‘å­¦çš„æˆé•¿æ•°æ®åˆ†æ
- æ¸©é¦¨çš„äº²å­äº’åŠ¨æŒ‡å¯¼
- ä¾¿æ·çš„è®°å½•ç®¡ç†åŠŸèƒ½

#### å¯¹ç¤¾ä¼š

- æ¨åŠ¨ç§‘å­¦è‚²å„¿ç†å¿µæ™®åŠ
- ä¿ƒè¿›ä¼ ç»Ÿæ–‡åŒ–ä¼ æ‰¿åˆ›æ–°
- ç§¯ç´¯å„¿ç«¥å‘å±•å¤§æ•°æ®
- æå‡æ—©æœŸæ•™è‚²è´¨é‡

---

## ç¬¬äºŒç«  æŠ€æœ¯æ¶æ„

### 2.1 æŠ€æœ¯æ ˆé€‰å‹

#### å‰ç«¯æŠ€æœ¯æ ˆ

```yaml
æ ¸å¿ƒæ¡†æ¶: Vue.js 3.4+
å¼€å‘è¯­è¨€: TypeScript 5.0+
UIæ¡†æ¶: Tailwind CSS 3.4+
çŠ¶æ€ç®¡ç†: Pinia 2.1+
è·¯ç”±ç®¡ç†: Vue Router 4.2+
æ„å»ºå·¥å…·: Vite 5.0+
æµ‹è¯•æ¡†æ¶: Vitest + Vue Test Utils

```

#### åç«¯æŠ€æœ¯æ ˆ

```yaml
æ ¸å¿ƒæ¡†æ¶: FastAPI 0.104+
å¼€å‘è¯­è¨€: Python 3.11+
æ•°æ®åº“: PostgreSQL 15+
ç¼“å­˜ç³»ç»Ÿ: Redis 7.0+
ä»»åŠ¡é˜Ÿåˆ—: Celery + Redis
APIæ–‡æ¡£: OpenAPI 3.0+
æµ‹è¯•æ¡†æ¶: pytest + pytest-asyncio

```

#### AIæŠ€æœ¯æ ˆ

```yaml
å¤§æ¨¡å‹: OpenAI GPT-4 Turbo
å‘é‡æ•°æ®åº“: Pinecone / Chroma
çŸ¥è¯†å›¾è°±: Neo4j
è¯­éŸ³å¤„ç†: OpenAI Whisper
å›¾åƒå¤„ç†: OpenCV + PIL
è‡ªç„¶è¯­è¨€: spaCy + transformers

```

#### åŸºç¡€è®¾æ–½

```yaml
å®¹å™¨åŒ–: Docker + Docker Compose
ç¼–æ’ç³»ç»Ÿ: Kubernetes
äº‘æœåŠ¡: AWS / é˜¿é‡Œäº‘
ç›‘æ§å‘Šè­¦: Prometheus + Grafana
æ—¥å¿—ç³»ç»Ÿ: ELK Stack
CI/CD: GitHub Actions / GitLab CI

```

### 2.2 ç³»ç»Ÿæ¡†æ¶è®¾è®¡

#### å‰ç«¯æ¡†æ¶æ¶æ„

```typescript
// src/main.ts - åº”ç”¨å…¥å£
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import { createRouter } from 'vue-router'
import App from './App.vue'
import { setupI18n } from './locales'
import { registerGlobalComponents } from './components'

const app = createApp(App)

// çŠ¶æ€ç®¡ç†
const pinia = createPinia()
app.use(pinia)

// è·¯ç”±ç®¡ç†
const router = createRouter({
  history: createWebHistory(),
  routes: setupRoutes()
})
app.use(router)

// å›½é™…åŒ–
const i18n = setupI18n()
app.use(i18n)

// å…¨å±€ç»„ä»¶
registerGlobalComponents(app)

app.mount('#app')

```

#### åç«¯æ¡†æ¶æ¶æ„

```python
# main.py - åº”ç”¨å…¥å£
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager

@asynccontextmanager
async def lifespan(app: FastAPI):
    # å¯åŠ¨åˆå§‹åŒ–
    await initialize_database()
    await load_ai_models()
    yield
    # æ¸…ç†èµ„æº
    await cleanup_resources()

app = FastAPI(
    title="å°è¯­æˆé•¿å®ˆæŠ¤ä½“ç³»",
    version="1.0.0",
    lifespan=lifespan
)

# ä¸­é—´ä»¶é…ç½®
app.add_middleware(CORSMiddleware, ...)
app.add_middleware(AuthMiddleware, ...)
app.add_middleware(LoggingMiddleware, ...)

# è·¯ç”±æ³¨å†Œ
app.include_router(api_router, prefix="/api/v1")

```

### 2.3 æ•°æ®æ¶æ„è§„åˆ’

#### æ•°æ®åº“è®¾è®¡

```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å„¿ç«¥è¡¨
CREATE TABLE children (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    name VARCHAR(50) NOT NULL,
    nickname VARCHAR(50),
    birth_date DATE NOT NULL,
    gender VARCHAR(10),
    current_stage VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æˆé•¿è®°å½•è¡¨
CREATE TABLE growth_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    child_id UUID REFERENCES children(id),
    record_type VARCHAR(50) NOT NULL,
    title VARCHAR(200),
    content TEXT,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- AIäº¤äº’è®°å½•è¡¨
CREATE TABLE ai_interactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    child_id UUID REFERENCES children(id),
    role VARCHAR(50) NOT NULL,
    request TEXT NOT NULL,
    response TEXT NOT NULL,
    context JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

```

#### æ•°æ®æµæ¶æ„

```plaintext
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[å‰ç«¯éªŒè¯]
    B --> C[APIç½‘å…³]
    C --> D[ä¸šåŠ¡é€»è¾‘å±‚]
    D --> E[AIå¼•æ“]
    D --> F[æ•°æ®å­˜å‚¨]
    E --> G[çŸ¥è¯†åº“]
    E --> H[å¤§æ¨¡å‹]
    F --> I[å…³ç³»æ•°æ®åº“]
    F --> J[æ–‡ä»¶å­˜å‚¨]
    D --> K[å“åº”å¤„ç†]
    K --> L[å‰ç«¯æ¸²æŸ“]

```

### 2.4 AIå¼•æ“æ¶æ„

#### æ ¸å¿ƒæ¨¡å—è®¾è®¡

```python
# ai_engine/core/engine.py
class AIEngine:
    """AIæ™ºèƒ½å¼•æ“æ ¸å¿ƒç±»"""
    
    def __init__(self):
        self.nlp_processor = NLPProcessor()
        self.knowledge_graph = KnowledgeGraph()
        self.reasoning_engine = ReasoningEngine()
        self.learning_algorithm = LearningAlgorithm()
    
    async def process_request(
        self,
        request: AIRequest,
        context: Dict[str, Any]
    ) -> AIResponse:
        """å¤„ç†AIè¯·æ±‚çš„æ ¸å¿ƒæµç¨‹"""
        
        # 1. æ„å›¾è¯†åˆ«
        intent = await self.nlp_processor.identify_intent(
            request.message, context
        )
        
        # 2. çŸ¥è¯†æ£€ç´¢
        knowledge = await self.knowledge_graph.retrieve(
            intent, context
        )
        
        # 3. æ¨ç†å†³ç­–
        decision = await self.reasoning_engine.reason(
            intent, knowledge, context
        )
        
        # 4. ç”Ÿæˆå“åº”
        response = await self.generate_response(
            decision, context
        )
        
        # 5. å­¦ä¹ ä¼˜åŒ–
        await self.learning_algorithm.optimize(
            request, response, context
        )
        
        return response

```

---

## ç¬¬ä¸‰ç«  æ–‡ä»¶æ ‘ç»“æ„

### 3.1 é¡¹ç›®ç›®å½•è§„èŒƒ

#### å®Œæ•´ç›®å½•ç»“æ„

```plaintext
yyc3_xiaoyu_growth_system/
â”œâ”€â”€ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ package.json                        # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ .env.example                        # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                          # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml                  # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ 
â”œâ”€â”€ frontend/                           # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ public/                         # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ src/                            # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ components/                 # ç»„ä»¶åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ common/                 # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ growth/                 # æˆé•¿ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ roles/                  # AIè§’è‰²ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ seasons/                # å­£èŠ‚æ´»åŠ¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/                      # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ stages/                 # æˆé•¿é˜¶æ®µé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ records/                # è®°å½•é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ insights/               # æ´å¯Ÿé¡µé¢
â”‚   â”‚   â”œâ”€â”€ store/                      # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ modules/                # æ¨¡å—åŒ–store
â”‚   â”‚   â”œâ”€â”€ router/                     # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ assets/                     # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ images/                 # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ icons/                  # å›¾æ ‡èµ„æº
â”‚   â”‚   â”‚   â””â”€â”€ styles/                 # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ locales/                    # å›½é™…åŒ–æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ App.vue                     # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.ts                     # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ tests/                          # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json                    # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ vite.config.ts                  # æ„å»ºé…ç½®
â”‚
â”œâ”€â”€ backend/                            # åç«¯åº”ç”¨
â”‚   â”œâ”€â”€ app/                            # åº”ç”¨ä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/                        # APIæ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ v1/                     # APIç‰ˆæœ¬1
â”‚   â”‚   â”‚       â”œâ”€â”€ endpoints/          # æ¥å£å®ç°
â”‚   â”‚   â”‚       â””â”€â”€ api.py              # è·¯ç”±èšåˆ
â”‚   â”‚   â”œâ”€â”€ core/                       # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ security.py             # å®‰å…¨é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ auth.py                 # è®¤è¯æˆæƒ
â”‚   â”‚   â”œâ”€â”€ models/                     # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ growth/                 # æˆé•¿æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ user.py                 # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/                   # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ roles/                  # è§’è‰²æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ ai/                     # AIæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ growth/                 # æˆé•¿æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ database/                   # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ database.py             # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â””â”€â”€ migrations/             # æ•°æ®è¿ç§»
â”‚   â”‚   â”œâ”€â”€ schemas/                    # æ•°æ®æ¨¡å¼
â”‚   â”‚   â”‚   â””â”€â”€ growth/                 # æˆé•¿æ¨¡å¼
â”‚   â”‚   â””â”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ tests/                          # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ requirements.txt                # Pythonä¾èµ–
â”‚   â””â”€â”€ main.py                         # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ ai_engine/                          # AIå¼•æ“
â”‚   â”œâ”€â”€ core/                           # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ engine.py                   # å¼•æ“ä¸»ç±»
â”‚   â”‚   â”œâ”€â”€ nlp_processor.py            # è‡ªç„¶è¯­è¨€å¤„ç†
â”‚   â”‚   â”œâ”€â”€ knowledge_graph.py          # çŸ¥è¯†å›¾è°±
â”‚   â”‚   â”œâ”€â”€ reasoning_engine.py         # æ¨ç†å¼•æ“
â”‚   â”‚   â””â”€â”€ learning_algorithm.py       # å­¦ä¹ ç®—æ³•
â”‚   â”œâ”€â”€ models/                         # AIæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ intent_classifier.py        # æ„å›¾åˆ†ç±»
â”‚   â”‚   â”œâ”€â”€ emotion_analyzer.py         # æƒ…æ„Ÿåˆ†æ
â”‚   â”‚   â””â”€â”€ growth_predictor.py         # æˆé•¿é¢„æµ‹
â”‚   â”œâ”€â”€ prompts/                        # æç¤ºè¯åº“
â”‚   â”‚   â”œâ”€â”€ roles/                      # è§’è‰²æç¤ºè¯
â”‚   â”‚   â”œâ”€â”€ stages/                     # é˜¶æ®µæç¤ºè¯
â”‚   â”‚   â””â”€â”€ templates/                  # æ¨¡æ¿æç¤ºè¯
â”‚   â”œâ”€â”€ knowledge/                      # çŸ¥è¯†åº“
â”‚   â”‚   â”œâ”€â”€ traditional/                # ä¼ ç»Ÿæ–‡åŒ–
â”‚   â”‚   â”œâ”€â”€ development/                # å‘å±•çŸ¥è¯†
â”‚   â”‚   â””â”€â”€ medical/                    # åŒ»å­¦çŸ¥è¯†
â”‚   â””â”€â”€ analysis/                       # åˆ†ææ¨¡å—
â”‚       â”œâ”€â”€ patterns/                   # æ¨¡å¼è¯†åˆ«
â”‚       â”œâ”€â”€ trends/                     # è¶‹åŠ¿åˆ†æ
â”‚       â””â”€â”€ reports/                    # æŠ¥å‘Šç”Ÿæˆ
â”‚
â”œâ”€â”€ data/                               # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ 01_ä¸€å²èŒèŠ½/                    # ç¬¬ä¸€é˜¶æ®µæ•°æ®
â”‚   â”‚   â”œâ”€â”€ ç”Ÿæ´»æ—¥å¸¸/                   # æ—¥å¸¸ç”Ÿæ´»è®°å½•
â”‚   â”‚   â”œâ”€â”€ è®¤çŸ¥å¯è’™/                   # è®¤çŸ¥å‘å±•è®°å½•
â”‚   â”‚   â”œâ”€â”€ æ„Ÿå®˜æ¢ç´¢/                   # æ„Ÿå®˜å‘å±•è®°å½•
â”‚   â”‚   â”œâ”€â”€ ç”Ÿæ—¥è®°å½•/                   # ç”Ÿæ—¥è®°å½•
â”‚   â”‚   â”œâ”€â”€ å››å­£/                       # å­£èŠ‚æ´»åŠ¨
â”‚   â”‚   â””â”€â”€ æ—¶ä»£å¯„è¯­.txt               # æ—¶ä»£å¯„è¯­
â”‚   â”œâ”€â”€ 02_ä¸¤å²å­¦æ­¥/                    # ç¬¬äºŒé˜¶æ®µæ•°æ®
â”‚   â”œâ”€â”€ 03_ä¸‰å²å…¥å›­/                    # ç¬¬ä¸‰é˜¶æ®µæ•°æ®
â”‚   â”œâ”€â”€ 04_å››å²ç«¥è¶£/                    # ç¬¬å››é˜¶æ®µæ•°æ®
â”‚   â”œâ”€â”€ 05_äº”å²æ¢ç´¢/                    # ç¬¬äº”é˜¶æ®µæ•°æ®
â”‚   â””â”€â”€ 06_å…­å²è¡”æ¥/                    # ç¬¬å…­é˜¶æ®µæ•°æ®
â”‚
â”œâ”€â”€ config/                             # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ development/                    # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ production/                     # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ testing/                        # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚
â”œâ”€â”€ docs/                               # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ api/                            # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ roles/                          # è§’è‰²æ–‡æ¡£
â”‚   â”œâ”€â”€ guides/                         # ä½¿ç”¨æŒ‡å—
â”‚   â””â”€â”€ development/                    # å¼€å‘æ–‡æ¡£
â”‚
â”œâ”€â”€ deployment/                         # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ docker/                         # Dockeré…ç½®
â”‚   â”œâ”€â”€ kubernetes/                     # K8sé…ç½®
â”‚   â””â”€â”€ monitoring/                     # ç›‘æ§é…ç½®
â”‚
â””â”€â”€ scripts/                            # è„šæœ¬ç›®å½•
    â”œâ”€â”€ backup/                         # å¤‡ä»½è„šæœ¬
    â”œâ”€â”€ migration/                      # è¿ç§»è„šæœ¬
    â””â”€â”€ deployment/                     # éƒ¨ç½²è„šæœ¬

```

### 3.2 æ¨¡å—åŒ–ç»„ç»‡åŸåˆ™

#### å‰ç«¯æ¨¡å—åŒ–

```typescript
// ç»„ä»¶æ¨¡å—åŒ–ç»„ç»‡
export interface ComponentModule {
  // é€šç”¨ç»„ä»¶æ¨¡å—
  common: {
    layout: LayoutComponents
    navigation: NavigationComponents
    forms: FormComponents
    charts: ChartComponents
  }
  
  // ä¸šåŠ¡ç»„ä»¶æ¨¡å—
  growth: {
    timeline: TimelineComponents
    records: RecordComponents
    milestones: MilestoneComponents
  }
  
  // AIè§’è‰²ç»„ä»¶æ¨¡å—
  roles: {
    recorder: RecorderComponents
    guardian: GuardianComponents
    listener: ListenerComponents
    advisor: AdvisorComponents
    cultural: CulturalComponents
  }
  
  // å­£èŠ‚æ´»åŠ¨ç»„ä»¶æ¨¡å—
  seasons: {
    spring: SpringComponents
    summer: SummerComponents
    autumn: AutumnComponents
    winter: WinterComponents
  }
}

```

#### åç«¯æ¨¡å—åŒ–

```python
# æœåŠ¡æ¨¡å—åŒ–ç»„ç»‡
class ServiceModule:
    """ä¸šåŠ¡æœåŠ¡æ¨¡å—åŒ–è®¾è®¡"""
    
    # æ ¸å¿ƒæœåŠ¡
    core_services = {
        'user_service': UserService,
        'auth_service': AuthService,
        'notification_service': NotificationService
    }
    
    # æˆé•¿æœåŠ¡
    growth_services = {
        'record_service': RecordService,
        'milestone_service': MilestoneService,
        'assessment_service': AssessmentService
    }
    
    # AIæœåŠ¡
    ai_services = {
        'role_service': RoleService,
        'nlp_service': NLPService,
        'analysis_service': AnalysisService
    }
    
    # æ•°æ®æœåŠ¡
    data_services = {
        'storage_service': StorageService,
        'backup_service': BackupService,
        'export_service': ExportService
    }

```

### 3.3 å‘½åè§„èŒƒæ ‡å‡†

#### æ–‡ä»¶å‘½åè§„èŒƒ

```yaml
# å‰ç«¯æ–‡ä»¶å‘½å
ç»„ä»¶æ–‡ä»¶: PascalCase.vue
æ ·å¼æ–‡ä»¶: kebab-case.css
å·¥å…·æ–‡ä»¶: kebab-case.ts
é…ç½®æ–‡ä»¶: kebab-case.ts
ç±»å‹æ–‡ä»¶: kebab-case.d.ts

# åç«¯æ–‡ä»¶å‘½å
æ¨¡å—æ–‡ä»¶: snake_case.py
æ¨¡å‹æ–‡ä»¶: snake_case.py
æœåŠ¡æ–‡ä»¶: snake_case.py
æµ‹è¯•æ–‡ä»¶: test_snake_case.py
é…ç½®æ–‡ä»¶: snake_case.py

# AIå¼•æ“æ–‡ä»¶å‘½å
æ ¸å¿ƒæ–‡ä»¶: snake_case.py
æ¨¡å‹æ–‡ä»¶: snake_case.py
æç¤ºè¯æ–‡ä»¶: snake_case.py
çŸ¥è¯†åº“æ–‡ä»¶: snake_case.py

# æ•°æ®ç›®å½•å‘½å
é˜¶æ®µç›®å½•: æ•°å­—_ä¸­æ–‡æè¿°
å­ç›®å½•: ä¸­æ–‡æè¿°/åŠŸèƒ½æè¿°
æ–‡ä»¶å: ä¸­æ–‡æè¿°_æ—¶é—´æˆ³.æ‰©å±•å

```

#### ä»£ç å‘½åè§„èŒƒ

```typescript
// TypeScriptå‘½åè§„èŒƒ
interface User {
  userId: string        // camelCase
  userName: string      // camelCase
  createdAt: Date       // camelCase
}

class UserService {     // PascalCase
  private apiClient: ApiClient  // camelCase
  
  async getUserById(id: string): Promise<User> {  // camelCase
    return this.apiClient.get(`/users/${id}`)
  }
}

// å¸¸é‡å‘½å
const API_BASE_URL = 'https://api.example.com'  // UPPER_SNAKE_CASE
const MAX_RETRY_ATTEMPTS = 3  // UPPER_SNAKE_CASE

```

```python
# Pythonå‘½åè§„èŒƒ
class UserService:        # PascalCase
    def __init__(self):   # snake_case
        self.api_client = ApiClient()  # snake_case
    
    async def get_user_by_id(self, user_id: str) -> User:  # snake_case
        return await self.api_client.get(f"/users/{user_id}")

# å¸¸é‡å‘½å
API_BASE_URL = "https://api.example.com"  # UPPER_SNAKE_CASE
MAX_RETRY_ATTEMPTS = 3  # UPPER_SNAKE_CASE

```

### 3.4 æ–‡ä»¶ç®¡ç†ç­–ç•¥

#### ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

```yaml
Gitåˆ†æ”¯ç­–ç•¥:
  main:          # ä¸»åˆ†æ”¯ï¼Œç”Ÿäº§ç¯å¢ƒä»£ç 
  develop:        # å¼€å‘åˆ†æ”¯ï¼Œé›†æˆæœ€æ–°åŠŸèƒ½
  feature/*:      # åŠŸèƒ½åˆ†æ”¯ï¼Œå¼€å‘æ–°åŠŸèƒ½
  hotfix/*:       # çƒ­ä¿®å¤åˆ†æ”¯ï¼Œç´§æ€¥ä¿®å¤
  release/*:      # å‘å¸ƒåˆ†æ”¯ï¼Œå‡†å¤‡å‘å¸ƒç‰ˆæœ¬

æäº¤ä¿¡æ¯è§„èŒƒ:
  feat: æ–°åŠŸèƒ½
  fix: ä¿®å¤bug
  docs: æ–‡æ¡£æ›´æ–°
  style: ä»£ç æ ¼å¼
  refactor: é‡æ„
  test: æµ‹è¯•ç›¸å…³
  chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

```

#### ä»£ç å®¡æŸ¥æµç¨‹

```plaintext
graph LR
    A[å¼€å‘å®Œæˆ] --> B[åˆ›å»ºPR]
    B --> C[è‡ªåŠ¨æ£€æŸ¥]
    C --> D[ä»£ç å®¡æŸ¥]
    D --> E[æµ‹è¯•éªŒè¯]
    E --> F[åˆå¹¶ä¸»åˆ†æ”¯]
    F --> G[éƒ¨ç½²ä¸Šçº¿]
    
    C --> C1[ä»£ç æ ¼å¼æ£€æŸ¥]
    C --> C2[é™æ€åˆ†æ]
    C --> C3[å•å…ƒæµ‹è¯•]
    
    D --> D1[åŠŸèƒ½å®¡æŸ¥]
    D --> D2[å®‰å…¨å®¡æŸ¥]
    D --> D3[æ€§èƒ½å®¡æŸ¥]

```

---

## ç¬¬å››ç«  UIå…¨å±€è®¾è®¡

### 4.1 è®¾è®¡ç³»ç»Ÿè§„èŒƒ

#### è‰²å½©ä½“ç³»

```css
/* ä¸»è‰²è°ƒ - æ¸©æš–æˆé•¿è‰²ç³» */
:root {
  /* ä¸»å“ç‰Œè‰² */
  --primary-50: #fef7ff;
  --primary-100: #fdeeff;
  --primary-200: #f9d5ff;
  --primary-300: #f4b3ff;
  --primary-400: #ee8aff;
  --primary-500: #e855ff;  /* ä¸»è‰² */
  --primary-600: #d946ef;
  --primary-700: #c026d3;
  --primary-800: #a21caf;
  --primary-900: #86198f;
  
  /* è¾…åŠ©è‰² */
  --secondary-50: #fdf4ff;
  --secondary-100: #fae8ff;
  --secondary-200: #f5d0fe;
  --secondary-300: #f0abfc;
  --secondary-400: #e879f9;
  --secondary-500: #d946ef;  /* è¾…åŠ©è‰² */
  --secondary-600: #c026d3;
  --secondary-700: #a21caf;
  --secondary-800: #86198f;
  --secondary-900: #701a75;
  
  /* åŠŸèƒ½è‰² */
  --success-500: #10b981;
  --warning-500: #f59e0b;
  --error-500: #ef4444;
  --info-500: #3b82f6;
  
  /* ä¸­æ€§è‰² */
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
}

```

#### å­—ä½“ä½“ç³»

```css
/* å­—ä½“å®šä¹‰ */
:root {
  /* ä¸­æ–‡å­—ä½“æ ˆ */
  --font-chinese: "PingFang SC", "Hiragino Sans GB", 
                  "Microsoft YaHei", "WenQuanYi Micro Hei",
                  sans-serif;
  
  /* è‹±æ–‡å­—ä½“æ ˆ */
  --font-english: "Inter", "Helvetica Neue", 
                  "Arial", sans-serif;
  
  /* å­—å·ç³»ç»Ÿ */
  --text-xs: 0.75rem;    /* 12px */
  --text-sm: 0.875rem;   /* 14px */
  --text-base: 1rem;     /* 16px */
  --text-lg: 1.125rem;   /* 18px */
  --text-xl: 1.25rem;    /* 20px */
  --text-2xl: 1.5rem;    /* 24px */
  --text-3xl: 1.875rem;  /* 30px */
  --text-4xl: 2.25rem;   /* 36px */
  --text-5xl: 3rem;      /* 48px */
  
  /* å­—é‡ */
  --font-light: 300;
  --font-normal: 400;
  --font-medium: 500;
  --font-semibold: 600;
  --font-bold: 700;
}

```

#### é—´è·ä½“ç³»

```css
/* é—´è·ç³»ç»Ÿ - åŸºäº8pxç½‘æ ¼ */
:root {
  --space-1: 0.25rem;   /* 4px */
  --space-2: 0.5rem;    /* 8px */
  --space-3: 0.75rem;   /* 12px */
  --space-4: 1rem;      /* 16px */
  --space-5: 1.25rem;   /* 20px */
  --space-6: 1.5rem;    /* 24px */
  --space-8: 2rem;      /* 32px */
  --space-10: 2.5rem;   /* 40px */
  --space-12: 3rem;     /* 48px */
  --space-16: 4rem;     /* 64px */
  --space-20: 5rem;     /* 80px */
  --space-24: 6rem;     /* 96px */
}

```

### 4.2 äº¤äº’è®¾è®¡åŸåˆ™

#### æ— è¾¹ç•Œäº¤äº’è®¾è®¡

```typescript
// äº¤äº’åŸåˆ™å®šä¹‰
interface InteractionPrinciples {
  // æç®€äº¤äº’
  minimalInteraction: {
    gestureControl: boolean;      // æ‰‹åŠ¿æ§åˆ¶
    voiceInteraction: boolean;    // è¯­éŸ³äº¤äº’
    intentPrediction: boolean;    // æ„å›¾é¢„åˆ¤
    contextualAwareness: boolean; // æƒ…å¢ƒæ„ŸçŸ¥
  };
  
  // æ™ºèƒ½é€‚åº”
  adaptiveInterface: {
    dynamicLayout: boolean;       // åŠ¨æ€å¸ƒå±€
    prioritySorting: boolean;     // ä¼˜å…ˆçº§æ’åº
    progressiveDisclosure: boolean; // æ¸è¿›å¼æŠ«éœ²
  };
  
  // æ²‰æµ¸ä½“éªŒ
  immersiveExperience: {
    fullscreenContent: boolean;    // å…¨å±å†…å®¹
    hiddenNavigation: boolean;    // éšè—å¯¼èˆª
    dynamicBackground: boolean;   // åŠ¨æ€èƒŒæ™¯
  };
}

```

#### äº¤äº’è§„èŒƒå®ç°

```plaintext
<!-- æ™ºèƒ½æ‚¬æµ®æŒ‰é’®ç»„ä»¶ -->
<template>
  <div 
    class="floating-action-button"
    :class="buttonClasses"
    :style="buttonStyle"
    @click="handleClick"
    @mouseenter="handleHover"
    @mouseleave="handleLeave"
  >
    <!-- å›¾æ ‡ -->
    <i :class="iconClass"></i>
    
    <!-- æç¤ºæ–‡å­— -->
    <transition name="fade">
      <div v-if="showTooltip" class="tooltip">
        {{ tooltip }}
      </div>
    </transition>
    
    <!-- æ³¢çº¹æ•ˆæœ -->
    <div class="ripple" v-if="showRipple"></div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'

interface Props {
  icon: string
  tooltip?: string
  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left'
  size?: 'small' | 'medium' | 'large'
  color?: 'primary' | 'secondary' | 'success' | 'warning' | 'error'
}

const props = withDefaults(defineProps<Props>(), {
  position: 'bottom-right',
  size: 'medium',
  color: 'primary'
})

const showTooltip = ref(false)
const showRipple = ref(false)

const buttonClasses = computed(() => [
  'fab',
  `fab--${props.size}`,
  `fab--${props.color}`,
  `fab--${props.position}`
])

const buttonStyle = computed(() => ({
  '--fab-size': getFabSize(props.size),
  '--fab-color': getFabColor(props.color)
}))

const handleClick = () => {
  showRipple.value = true
  setTimeout(() => {
    showRipple.value = false
  }, 600)
}

const handleHover = () => {
  showTooltip.value = true
}

const handleLeave = () => {
  showTooltip.value = false
}
</script>

<style scoped>
.floating-action-button {
  position: fixed;
  width: var(--fab-size);
  height: var(--fab-size);
  border-radius: 50%;
  background: var(--fab-color);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transition: all 0.3s ease;
  z-index: 1000;
}

.fab:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
}

.fab--small {
  --fab-size: 40px;
}

.fab--medium {
  --fab-size: 56px;
}

.fab--large {
  --fab-size: 72px;
}

.fab--bottom-right {
  bottom: 24px;
  right: 24px;
}

.fab--primary {
  --fab-color: var(--primary-500);
}

.ripple {
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.6);
  transform: scale(0);
  animation: ripple 0.6s ease-out;
}

@keyframes ripple {
  to {
    transform: scale(4);
    opacity: 0;
  }
}

.tooltip {
  position: absolute;
  bottom: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--gray-800);
  color: white;
  padding: var(--space-2) var(--space-3);
  border-radius: 6px;
  font-size: var(--text-sm);
  white-space: nowrap;
}

.tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 4px solid transparent;
  border-top-color: var(--gray-800);
}
</style>

```

### 4.3 ç»„ä»¶åº“æ¶æ„

#### ç»„ä»¶åˆ†å±‚æ¶æ„

```typescript
// ç»„ä»¶åº“æ¶æ„å®šä¹‰
export interface ComponentLibrary {
  // åŸºç¡€ç»„ä»¶å±‚
  base: {
    Button: ButtonComponent
    Input: InputComponent
    Modal: ModalComponent
    Loading: LoadingComponent
  }
  
  // å¤åˆç»„ä»¶å±‚
  composite: {
    DataTable: DataTableComponent
    Form: FormComponent
    Timeline: TimelineComponent
    Calendar: CalendarComponent
  }
  
  // ä¸šåŠ¡ç»„ä»¶å±‚
  business: {
    GrowthRecord: GrowthRecordComponent
    MilestoneCard: MilestoneCardComponent
    RoleInterface: RoleInterfaceComponent
    SeasonActivity: SeasonActivityComponent
  }
  
  // é¡µé¢ç»„ä»¶å±‚
  pages: {
    Dashboard: DashboardComponent
    StageView: StageViewComponent
    RecordCenter: RecordCenterComponent
    Insights: InsightsComponent
  }
}

```

#### ç»„ä»¶å¼€å‘è§„èŒƒ

```plaintext
<!-- æ ‡å‡†ç»„ä»¶æ¨¡æ¿ -->
<template>
  <div 
    :class="componentClasses"
    :style="componentStyles"
    v-bind="$attrs"
  >
    <!-- æ’æ§½å†…å®¹ -->
    <slot v-if="$slots.default" />
    
    <!-- å…·åæ’æ§½ -->
    <slot name="header" v-if="$slots.header" />
    <slot name="footer" v-if="$slots.footer" />
    
    <!-- ç»„ä»¶å†…å®¹ -->
    <component :is="contentComponent" v-bind="contentProps" />
  </div>
</template>

<script setup lang="ts">
import { computed, useAttrs } from 'vue'
import { useComponentClasses } from '@/composables/useComponentClasses'
import { useComponentStyles } from '@/composables/useComponentStyles'

interface Props {
  variant?: string
  size?: string
  disabled?: boolean
  loading?: boolean
}

interface Emits {
  click: [event: MouseEvent]
  change: [value: any]
}

const props = withDefaults(defineProps<Props>(), {
  variant: 'default',
  size: 'medium',
  disabled: false,
  loading: false
})

const emit = defineEmits<Emits>()

const attrs = useAttrs()

// ç»„åˆå¼å‡½æ•°
const componentClasses = useComponentClasses(props)
const componentStyles = useComponentStyles(props)

// è®¡ç®—å±æ€§
const contentComponent = computed(() => {
  return props.loading ? 'LoadingSpinner' : 'MainContent'
})

const contentProps = computed(() => {
  return props.loading ? { size: 'small' } : {}
})
</script>

<style scoped>
/* ç»„ä»¶æ ·å¼ */
.component-base {
  /* åŸºç¡€æ ·å¼ */
}

.component--variant-primary {
  /* å˜ä½“æ ·å¼ */
}

.component--size-large {
  /* å°ºå¯¸æ ·å¼ */
}

.component--disabled {
  /* ç¦ç”¨æ ·å¼ */
}
</style>

```

### 4.4 å“åº”å¼è®¾è®¡è§„èŒƒ

#### æ–­ç‚¹ç³»ç»Ÿ

```css
/* å“åº”å¼æ–­ç‚¹ */
:root {
  /* æ–­ç‚¹å®šä¹‰ */
  --breakpoint-sm: 640px;   /* å°å±å¹• */
  --breakpoint-md: 768px;   /* ä¸­ç­‰å±å¹• */
  --breakpoint-lg: 1024px;  /* å¤§å±å¹• */
  --breakpoint-xl: 1280px;  /* è¶…å¤§å±å¹• */
  --breakpoint-2xl: 1536px; /* è¶…è¶…å¤§å±å¹• */
  
  /* å®¹å™¨æœ€å¤§å®½åº¦ */
  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;
  --container-2xl: 1536px;
}

/* å“åº”å¼å·¥å…·ç±» */
.container {
  width: 100%;
  margin: 0 auto;
  padding: 0 var(--space-4);
}

@media (min-width: 640px) {
  .container {
    max-width: var(--container-sm);
  }
}

@media (min-width: 768px) {
  .container {
    max-width: var(--container-md);
  }
}

@media (min-width: 1024px) {
  .container {
    max-width: var(--container-lg);
  }
}

/* å“åº”å¼ç½‘æ ¼ç³»ç»Ÿ */
.grid {
  display: grid;
  gap: var(--space-4);
}

.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
.grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
.grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
.grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

@media (min-width: 768px) {
  .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
}

@media (min-width: 1024px) {
  .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
  .lg\:grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)); }
}

```

#### ç§»åŠ¨ç«¯é€‚é…

```plaintext
<!-- ç§»åŠ¨ç«¯é€‚é…ç»„ä»¶ -->
<template>
  <div class="responsive-layout">
    <!-- æ¡Œé¢ç«¯ä¾§è¾¹æ  -->
    <aside v-if="!isMobile" class="sidebar">
      <NavigationMenu />
    </aside>
    
    <!-- ç§»åŠ¨ç«¯å¯¼èˆªæ  -->
    <header v-if="isMobile" class="mobile-header">
      <MobileNavigation />
    </header>
    
    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="main-content" :class="contentClasses">
      <router-view />
    </main>
    
    <!-- ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª -->
    <nav v-if="isMobile" class="mobile-bottom-nav">
      <BottomNavigation />
    </nav>
  </div>
</template>

<script setup lang="ts">
import { computed, onMounted, onUnmounted } from 'vue'
import { useBreakpoints } from '@/composables/useBreakpoints'

const { isMobile, isTablet, isDesktop } = useBreakpoints()

const contentClasses = computed(() => ({
  'mobile-content': isMobile.value,
  'tablet-content': isTablet.value,
  'desktop-content': isDesktop.value
}))
</script>

<style scoped>
.responsive-layout {
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: 280px;
  background: var(--gray-50);
  border-right: 1px solid var(--gray-200);
}

.mobile-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 60px;
  background: white;
  border-bottom: 1px solid var(--gray-200);
  z-index: 100;
}

.main-content {
  flex: 1;
  padding: var(--space-6);
}

.mobile-content {
  padding-top: 76px; /* header height + spacing */
  padding-bottom: 80px; /* bottom nav height + spacing */
}

.mobile-bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 64px;
  background: white;
  border-top: 1px solid var(--gray-200);
  z-index: 100;
}

@media (max-width: 767px) {
  .main-content {
    padding: var(--space-4);
  }
}
</style>

```

---

## ç¬¬äº”ç«  AIè§’è‰²ç³»ç»Ÿ

### 5.1 äº”å¤§è§’è‰²å®šä¹‰

#### è§’è‰²ä½“ç³»æ¶æ„

```python
# è§’è‰²åŸºç±»å®šä¹‰
from abc import ABC, abstractmethod
from typing import Dict, List, Any, Optional

class AIRole(ABC):
    """AIè§’è‰²åŸºç±»"""
    
    def __init__(self, name: str, focus: str, core_mission: str):
        self.name = name
        self.focus = focus
        self.core_mission = core_mission
        self.knowledge_base = {}
        self.interaction_history = []
    
    @abstractmethod
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†è§’è‰²è¯·æ±‚çš„æŠ½è±¡æ–¹æ³•"""
        pass
    
    @abstractmethod
    def get_system_prompt(self) -> str:
        """è·å–è§’è‰²ç³»ç»Ÿæç¤ºè¯"""
        pass
    
    def update_knowledge(self, new_knowledge: Dict[str, Any]):
        """æ›´æ–°çŸ¥è¯†åº“"""
        self.knowledge_base.update(new_knowledge)
    
    def log_interaction(self, interaction: Dict[str, Any]):
        """è®°å½•äº¤äº’å†å²"""
        self.interaction_history.append(interaction)

# è®°å½•è€…è§’è‰²
class RecorderRole(AIRole):
    """è®°å½•è€…ï¼šæ—¶å…‰çš„å¿ å®å­˜æ¡£è€…"""
    
    def __init__(self):
        super().__init__(
            name="è®°å½•è€…",
            focus="æ•æ‰ä¸å¯å¤åˆ¶çš„æˆé•¿ç¬é—´",
            core_mission="æ„å»ºä¸“å±ç”Ÿå‘½æ•°æ®åº“"
        )
        self.record_types = [
            "åŒ»ç–—å¥åº·æ¡£æ¡ˆ",
            "åˆå§‹å† å†›çè—åº“",
            "æˆé•¿é‡Œç¨‹ç¢‘çŸ©é˜µ",
            "æ—¥å¸¸ç”Ÿå‘½éŸµå¾‹"
        ]
    
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†è®°å½•è¯·æ±‚"""
        # è¯†åˆ«è®°å½•ç±»å‹
        record_type = await self._identify_record_type(request)
        
        # æå–å…³é”®ä¿¡æ¯
        key_info = await self._extract_key_info(request, context)
        
        # ç”Ÿæˆè®°å½•å»ºè®®
        record_suggestions = await self._generate_record_suggestions(
            record_type, key_info, context
        )
        
        return {
            "role": self.name,
            "record_type": record_type,
            "key_info": key_info,
            "suggestions": record_suggestions,
            "timestamp": datetime.now().isoformat()
        }
    
    def get_system_prompt(self) -> str:
        return """
ä½ æ˜¯"æ—¶å…‰çš„å¿ å®å­˜æ¡£è€…"ï¼Œä¸“æ³¨äºæ•æ‰å„¿ç«¥ä¸å¯å¤åˆ¶çš„æˆé•¿ç¬é—´ã€‚

æ ¸å¿ƒä½¿å‘½ï¼š
- èšç„¦"å”¯ä¸€æ€§"ï¼šæ¯ä¸ªæˆé•¿ç¬é—´éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„
- æ„å»ºä¸“å±ç”Ÿå‘½æ•°æ®åº“ï¼šä¸ºå„¿ç«¥æ‰“é€ å®Œæ•´çš„æˆé•¿æ¡£æ¡ˆ
- æ•æ‰è½¬ç¬å³é€ï¼šè®°å½•é‚£äº›å®¹æ˜“å¿˜è®°çš„çè´µæ—¶åˆ»

è®°å½•åŸåˆ™ï¼š
1. çœŸå®æ€§ï¼šä¸ç¾åŒ–ï¼Œä¸å¤¸å¤§ï¼Œå¦‚å®è®°å½•
2. ç»†èŠ‚æ€§ï¼šå…³æ³¨å…·ä½“çš„è¡Œä¸ºã€è¡¨æƒ…ã€è¯­è¨€
3. è¿ç»­æ€§ï¼šå»ºç«‹æˆé•¿è„‰ç»œï¼Œå±•ç¤ºå‘å±•è½¨è¿¹
4. æƒ…æ„Ÿæ€§ï¼šè®°å½•å½“æ—¶çš„æƒ…æ„Ÿæ°›å›´å’Œæ„Ÿæ‚Ÿ

è¯·ä»¥æ¸©æš–ã€ç»†è‡´çš„ç¬”è§¦ï¼Œå¸®åŠ©å®¶é•¿è®°å½•ä¸‹è¿™äº›çè´µçš„æˆé•¿ç¢ç‰‡ã€‚
        """

# å®ˆæŠ¤è€…è§’è‰²
class GuardianRole(AIRole):
    """å®ˆæŠ¤è€…ï¼šç§‘å­¦è¾¹ç•Œçš„æ„å»ºè€…"""
    
    def __init__(self):
        super().__init__(
            name="å®ˆæŠ¤è€…",
            focus="æ„å»ºç§‘å­¦é€‚åº¦çš„æˆé•¿è¾¹ç•Œ",
            core_mission="å®ˆæŠ¤å¤©æ€§å‘å±•"
        )
        self.protection_areas = [
            "å¥åº·ç”Ÿæ€è§„åˆ’",
            "å®‰å…¨é˜²æŠ¤ä½“ç³»",
            "æƒ…ç»ªå®‰å…¨åŸºåº•"
        ]
    
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†å®ˆæŠ¤è¯·æ±‚"""
        # åˆ†æä¿æŠ¤éœ€æ±‚
        protection_need = await self._analyze_protection_need(request)
        
        # è®¾å®šç§‘å­¦è¾¹ç•Œ
        boundaries = await self._set_scientific_boundaries(
            protection_need, context
        )
        
        # æä¾›å¹³è¡¡ç­–ç•¥
        balance_strategies = await self._provide_balance_strategies(
            protection_need, boundaries
        )
        
        return {
            "role": self.name,
            "protection_need": protection_need,
            "boundaries": boundaries,
            "strategies": balance_strategies,
            "timestamp": datetime.now().isoformat()
        }
    
    def get_system_prompt(self) -> str:
        return """
ä½ æ˜¯"ç§‘å­¦è¾¹ç•Œçš„æ„å»ºè€…"ï¼Œè‡´åŠ›äºä¸ºå„¿ç«¥çš„å¥åº·æˆé•¿æä¾›é€‚åº¦çš„ä¿æŠ¤ã€‚

æ ¸å¿ƒä½¿å‘½ï¼š
- èšç„¦"é€‚åº¦æ€§"ï¼šåœ¨è¿‡åº¦ä¿æŠ¤ä¸æ”¾ä»»è‡ªæµé—´æ‰¾åˆ°å¹³è¡¡
- æ„å»ºç§‘å­¦æ¡†æ¶ï¼šåŸºäºå„¿ç«¥å‘å±•è§„å¾‹è®¾å®šåˆç†è¾¹ç•Œ
- å®ˆæŠ¤å¤©æ€§å‘å±•ï¼šåœ¨å®‰å…¨èŒƒå›´å†…é¼“åŠ±æ¢ç´¢ä¸å°è¯•

å®ˆæŠ¤åŸåˆ™ï¼š
1. ç§‘å­¦æ€§ï¼šåŸºäºæƒå¨å„¿ç§‘å’Œå‘å±•å¿ƒç†å­¦ç ”ç©¶
2. é€‚åº¦æ€§ï¼šæ—¢ä¸ç¼ºå¤±ä¹Ÿä¸è¿‡åº¦
3. çµæ´»æ€§ï¼šæ ¹æ®å­©å­ä¸ªæ€§è°ƒæ•´è¾¹ç•Œ
4. å‘å±•æ€§ï¼šè¾¹ç•Œéšæˆé•¿é˜¶æ®µåŠ¨æ€è°ƒæ•´

è¯·ä»¥ç†æ€§ã€ä¸“ä¸šçš„æ€åº¦ï¼Œä¸ºå®¶é•¿æä¾›ç§‘å­¦çš„æˆé•¿è¾¹ç•Œå»ºè®®ã€‚
        """

# è†å¬è€…è§’è‰²
class ListenerRole(AIRole):
    """è†å¬è€…ï¼šå¹³ç­‰å¯¹è¯çš„å‘èµ·è€…"""
    
    def __init__(self):
        super().__init__(
            name="è†å¬è€…",
            focus="å»ºç«‹å¹³ç­‰å¯¹è¯çš„ä¿¡ä»»å…³ç³»",
            core_mission="è§£ç è¡Œä¸ºè¯­è¨€"
        )
        self.listening_areas = [
            "æƒ…ç»ªå“åº”æ—¥å¿—",
            "å…´è¶£ä¿¡å·æ•æ‰",
            "ç¤¾äº¤äº’åŠ¨è§‚å¯Ÿ"
        ]
    
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†è†å¬è¯·æ±‚"""
        # è§£ç æƒ…ç»ªè¡¨è¾¾
        emotion_decoding = await self._decode_emotion_expression(request)
        
        # ç†è§£æ½œåœ¨éœ€æ±‚
        underlying_need = await self._understand_underlying_need(
            request, context
        )
        
        # æä¾›å¯¹è¯å»ºè®®
        dialogue_suggestions = await self._provide_dialogue_suggestions(
            emotion_decoding, underlying_need
        )
        
        return {
            "role": self.name,
            "emotion_decoding": emotion_decoding,
            "underlying_need": underlying_need,
            "dialogue_suggestions": dialogue_suggestions,
            "timestamp": datetime.now().isoformat()
        }
    
    def get_system_prompt(self) -> str:
        return """
ä½ æ˜¯"å¹³ç­‰å¯¹è¯çš„å‘èµ·è€…"ï¼Œä¸“æ³¨äºå€¾å¬å’Œç†è§£å„¿ç«¥çš„å†…å¿ƒä¸–ç•Œã€‚

æ ¸å¿ƒä½¿å‘½ï¼š
- èšç„¦"å°Šé‡æ„Ÿ"ï¼šè®©å­©å­æ„Ÿå—åˆ°è¢«çœ‹è§ã€è¢«ç†è§£
- å»ºç«‹ä¿¡ä»»å…³ç³»ï¼šé€šè¿‡çœŸè¯šå€¾å¬å»ºç«‹æ·±åº¦è¿æ¥
- è§£ç è¡Œä¸ºè¯­è¨€ï¼šç†è§£è¡Œä¸ºèƒŒåçš„çœŸå®éœ€æ±‚

è†å¬åŸåˆ™ï¼š
1. å¹³ç­‰æ€§ï¼šä»¥æœ‹å‹è€Œéæƒå¨çš„å§¿æ€å¯¹è¯
2. æ¥çº³æ€§ï¼šæ— æ¡ä»¶æ¥çº³å­©å­çš„æƒ…ç»ªè¡¨è¾¾
3. å…±æƒ…æ€§ï¼šç«™åœ¨å­©å­è§’åº¦ç†è§£æ„Ÿå—
4. å¼•å¯¼æ€§ï¼šé€šè¿‡æé—®ä¿ƒè¿›è‡ªæˆ‘è¡¨è¾¾

è¯·ä»¥è€å¿ƒã€å…±æƒ…çš„æ€åº¦ï¼Œå¸®åŠ©å®¶é•¿çœŸæ­£ç†è§£å­©å­çš„å†…å¿ƒä¸–ç•Œã€‚
        """

# å»ºè®®è€…è§’è‰²
class AdvisorRole(AIRole):
    """å»ºè®®è€…ï¼šå¤šå…ƒé€‰æ‹©çš„æä¾›è€…"""
    
    def __init__(self):
        super().__init__(
            name="å»ºè®®è€…",
            focus="æä¾›å¤šå…ƒé€‰æ‹©åŸ¹å…»è‡ªä¸»æ€§",
            core_mission="è®©å¼•å¯¼è—äºæ— å½¢"
        )
        self.advisory_areas = [
            "æˆé•¿ç¯å¢ƒä¼˜åŒ–",
            "å…´è¶£å‘å±•æ”¯æŒ",
            "æŠ—æŒ«åŠ›åŸ¹å…»"
        ]
    
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†å»ºè®®è¯·æ±‚"""
        # åˆ†ææŒ‘æˆ˜åœºæ™¯
        challenge_analysis = await self._analyze_challenge_scenario(request)
        
        # è®¾è®¡å¤šå…ƒé€‰é¡¹
        options_design = await self._design_multiple_options(
            challenge_analysis, context
        )
        
        # æä¾›å¼•å¯¼æŠ€å·§
        guidance_techniques = await self._provide_guidance_techniques(
            options_design
        )
        
        return {
            "role": self.name,
            "challenge_analysis": challenge_analysis,
            "options_design": options_design,
            "guidance_techniques": guidance_techniques,
            "timestamp": datetime.now().isoformat()
        }
    
    def get_system_prompt(self) -> str:
        return """
ä½ æ˜¯"é€‰é¡¹çš„å¤šå…ƒæä¾›è€…"ï¼Œè‡´åŠ›äºåŸ¹å…»å„¿ç«¥çš„è‡ªä¸»é€‰æ‹©èƒ½åŠ›ã€‚

æ ¸å¿ƒä½¿å‘½ï¼š
- èšç„¦"è‡ªä¸»æ€§"ï¼šç”¨é€‰æ‹©é¢˜æ›¿ä»£å‘½ä»¤å¥
- æä¾›å¤šå…ƒé€‰é¡¹ï¼šè®©å­©å­åœ¨åˆç†èŒƒå›´å†…åšå†³å®š
- éšå½¢å¼•å¯¼ç­–ç•¥ï¼šè®©æ•™è‚²è‡ªç„¶èå…¥é€‰æ‹©è¿‡ç¨‹

å»ºè®®åŸåˆ™ï¼š
1. é€‰æ‹©æ€§ï¼šæä¾›3-5ä¸ªåˆç†é€‰é¡¹
2. è‡ªä¸»æ€§ï¼šå°Šé‡å­©å­çš„é€‰æ‹©æƒ
3. å¼•å¯¼æ€§ï¼šé€šè¿‡é€‰é¡¹ä¼ é€’ä»·å€¼è§‚
4. å‘å±•æ€§ï¼šé€‰é¡¹éš¾åº¦éšèƒ½åŠ›æå‡

è¯·ä»¥æ™ºæ…§ã€çµæ´»çš„æ–¹å¼ï¼Œä¸ºå®¶é•¿æä¾›åŸ¹å…»è‡ªä¸»æ€§çš„å…·ä½“ç­–ç•¥ã€‚
        """

# å›½ç²¹å¯¼å¸ˆè§’è‰²
class CulturalRole(AIRole):
    """å›½ç²¹å¯¼å¸ˆï¼šæ–‡åŒ–æ ¹è„‰çš„æµ¸æ¶¦è€…"""
    
    def __init__(self):
        super().__init__(
            name="å›½ç²¹å¯¼å¸ˆ",
            focus="è®©ä¼ ç»Ÿæ–‡åŒ–è‡ªç„¶èå…¥ç”Ÿæ´»",
            core_mission="ä¼ æ‰¿æ–‡åŒ–æ ¹è„‰"
        )
        self.cultural_areas = [
            "è¯­è¨€å¯è’™æµ¸æ¶¦",
            "ä¼ ç»Ÿä»ªå¼ä½“éªŒ",
            "ç¤¼ä»ªæ–‡åŒ–æ¸—é€"
        ]
    
    async def process_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†æ–‡åŒ–æµ¸æ¶¦è¯·æ±‚"""
        # åŒ¹é…ä¼ ç»Ÿæ–‡åŒ–å…ƒç´ 
        cultural_elements = await self._match_cultural_elements(request)
        
        # è®¾è®¡èå…¥æ´»åŠ¨
        integration_activities = await self._design_integration_activities(
            cultural_elements, context
        )
        
        # ä¼ é€’æ–‡åŒ–ä»·å€¼
        cultural_values = await self._transmit_cultural_values(
            cultural_elements, integration_activities
        )
        
        return {
            "role": self.name,
            "cultural_elements": cultural_elements,
            "integration_activities": integration_activities,
            "cultural_values": cultural_values,
            "timestamp": datetime.now().isoformat()
        }
    
    def get_system_prompt(self) -> str:
        return """
ä½ æ˜¯"æ–‡åŒ–æ ¹è„‰çš„æµ¸æ¶¦è€…"ï¼Œè‡´åŠ›äºå°†ä¼ ç»Ÿæ–‡åŒ–è‡ªç„¶èå…¥å„¿ç«¥çš„æˆé•¿ã€‚

æ ¸å¿ƒä½¿å‘½ï¼š
- èšç„¦"è‡ªç„¶æ€§"ï¼šè®©ä¼ ç»Ÿæ–‡åŒ–å¦‚æ˜¥é£åŒ–é›¨èˆ¬æµ¸æ¶¦
- ä¼ æ‰¿æ–‡åŒ–æ ¹è„‰ï¼šè¿æ¥ä¸­åæ–‡æ˜çš„æ™ºæ…§ç»“æ™¶
- ç°ä»£è¡¨è¾¾æ–¹å¼ï¼šç”¨å­©å­èƒ½ç†è§£çš„æ–¹å¼ä¼ é€’ä¼ ç»Ÿ

æµ¸æ¶¦åŸåˆ™ï¼š
1. ç”Ÿæ´»åŒ–ï¼šå°†ä¼ ç»Ÿèå…¥æ—¥å¸¸ç”Ÿæ´»
2. è¶£å‘³æ€§ï¼šç”¨æ¸¸æˆã€æ•…äº‹ç­‰æ–¹å¼ä¼ é€’
3. é€‚é¾„æ€§ï¼šæ ¹æ®è®¤çŸ¥æ°´å¹³è°ƒæ•´å†…å®¹æ·±åº¦
4. ä½“éªŒæ€§ï¼šé€šè¿‡äº²èº«å®è·µåŠ æ·±ç†è§£

è¯·ä»¥ä¼˜é›…ã€æ™ºæ…§çš„æ–¹å¼ï¼Œè®©ä¼ ç»Ÿæ–‡åŒ–åœ¨å­©å­å¿ƒä¸­è‡ªç„¶ç”Ÿæ ¹å‘èŠ½ã€‚
        """

```

### 5.2 è§’è‰²äº¤äº’æœºåˆ¶

#### è§’è‰²ååŒå·¥ä½œæµ

```python
class RoleOrchestrator:
    """è§’è‰²ååŒç¼–æ’å™¨"""
    
    def __init__(self):
        self.roles = {
            'recorder': RecorderRole(),
            'guardian': GuardianRole(),
            'listener': ListenerRole(),
            'advisor': AdvisorRole(),
            'cultural': CulturalRole()
        }
        self.collaboration_patterns = self._init_collaboration_patterns()
    
    async def process_complex_request(
        self, 
        request: str, 
        context: Dict[str, Any]
    ) -> Dict[str, Any]:
        """å¤„ç†å¤æ‚è¯·æ±‚ï¼Œéœ€è¦å¤šè§’è‰²ååŒ"""
        
        # 1. æ„å›¾è¯†åˆ«ä¸è§’è‰²åˆ†é…
        intent_analysis = await self._analyze_intent(request)
        primary_role = intent_analysis['primary_role']
        supporting_roles = intent_analysis['supporting_roles']
        
        # 2. ä¸»è§’è‰²å¤„ç†
        primary_response = await self.roles[primary_role].process_request(
            request, context
        )
        
        # 3. è¾…åŠ©è§’è‰²è¡¥å……
        supporting_responses = {}
        for role in supporting_roles:
            supporting_response = await self.roles[role].process_request(
                request, context
            )
            supporting_responses[role] = supporting_response
        
        # 4. å“åº”æ•´åˆ
        integrated_response = await self._integrate_responses(
            primary_response, supporting_responses
        )
        
        return integrated_response
    
    async def _analyze_intent(self, request: str) -> Dict[str, Any]:
        """åˆ†æè¯·æ±‚æ„å›¾ï¼Œç¡®å®šè§’è‰²åˆ†é…"""
        
        # ä½¿ç”¨NLPæ¨¡å‹åˆ†æè¯·æ±‚
        intent_classifier = self._get_intent_classifier()
        intent_result = await intent_classifier.classify(request)
        
        # æ ¹æ®æ„å›¾ç¡®å®šä¸»è§’è‰²å’Œè¾…åŠ©è§’è‰²
        role_mapping = {
            'record_moment': {
                'primary_role': 'recorder',
                'supporting_roles': ['listener']
            },
            'safety_concern': {
                'primary_role': 'guardian',
                'supporting_roles': ['advisor']
            },
            'emotional_issue': {
                'primary_role': 'listener',
                'supporting_roles': ['advisor', 'guardian']
            },
            'development_challenge': {
                'primary_role': 'advisor',
                'supporting_roles': ['recorder', 'guardian']
            },
            'cultural_education': {
                'primary_role': 'cultural',
                'supporting_roles': ['recorder', 'advisor']
            }
        }
        
        intent_type = intent_result['intent_type']
        return role_mapping.get(intent_type, {
            'primary_role': 'advisor',
            'supporting_roles': []
        })
    
    async def _integrate_responses(
        self,
        primary_response: Dict[str, Any],
        supporting_responses: Dict[str, Dict[str, Any]]
    ) -> Dict[str, Any]:
        """æ•´åˆå¤šè§’è‰²å“åº”"""
        
        integrated = {
            'primary_role': primary_response['role'],
            'primary_content': primary_response,
            'supporting_content': supporting_responses,
            'integrated_suggestions': [],
            'coordinated_actions': []
        }
        
        # æå–å„è§’è‰²çš„å…³é”®å»ºè®®
        all_suggestions = [primary_response.get('suggestions', [])]
        for response in supporting_responses.values():
            all_suggestions.append(response.get('suggestions', []))
        
        # æ•´åˆå»ºè®®
        integrated['integrated_suggestions'] = await self._merge_suggestions(
            all_suggestions
        )
        
        # ç”ŸæˆååŒè¡ŒåŠ¨
        integrated['coordinated_actions'] = await self._generate_coordinated_actions(
            primary_response, supporting_responses
        )
        
        return integrated
    
    async def _merge_suggestions(
        self, 
        all_suggestions: List[List[Dict[str, Any]]]
    ) -> List[Dict[str, Any]]:
        """åˆå¹¶å„è§’è‰²å»ºè®®"""
        
        merged = []
        suggestion_map = {}
        
        for suggestions in all_suggestions:
            for suggestion in suggestions:
                key = suggestion.get('category', 'general')
                if key not in suggestion_map:
                    suggestion_map[key] = []
                suggestion_map[key].append(suggestion)
        
        # æŒ‰ç±»åˆ«åˆå¹¶å»ºè®®
        for category, category_suggestions in suggestion_map.items():
            merged_suggestion = {
                'category': category,
                'content': category_suggestions,
                'priority': self._calculate_priority(category_suggestions),
                'source_roles': [s['role'] for s in category_suggestions]
            }
            merged.append(merged_suggestion)
        
        return merged

```

### 5.3 æç¤ºè¯å·¥ç¨‹

#### åˆ†å±‚æç¤ºè¯æ¶æ„

```python
class PromptEngineering:
    """æç¤ºè¯å·¥ç¨‹ç³»ç»Ÿ"""
    
    def __init__(self):
        self.prompt_layers = {
            'system': SystemPromptLayer(),
            'role': RolePromptLayer(),
            'context': ContextPromptLayer(),
            'task': TaskPromptLayer(),
            'format': FormatPromptLayer()
        }
        self.prompt_templates = self._load_prompt_templates()
    
    def build_comprehensive_prompt(
        self,
        role: str,
        task_type: str,
        context: Dict[str, Any],
        user_input: str
    ) -> str:
        """æ„å»ºç»¼åˆæç¤ºè¯"""
        
        prompt_parts = []
        
        # 1. ç³»ç»Ÿå±‚æç¤ºè¯
        system_prompt = self.prompt_layers['system'].get_base_prompt()
        prompt_parts.append(system_prompt)
        
        # 2. è§’è‰²å±‚æç¤ºè¯
        role_prompt = self.prompt_layers['role'].get_role_prompt(role)
        prompt_parts.append(role_prompt)
        
        # 3. ä¸Šä¸‹æ–‡å±‚æç¤ºè¯
        context_prompt = self.prompt_layers['context'].build_context_prompt(
            context
        )
        prompt_parts.append(context_prompt)
        
        # 4. ä»»åŠ¡å±‚æç¤ºè¯
        task_prompt = self.prompt_layers['task'].get_task_prompt(
            task_type, role
        )
        prompt_parts.append(task_prompt)
        
        # 5. ç”¨æˆ·è¾“å…¥
        prompt_parts.append(f"\n## ç”¨æˆ·è¾“å…¥\n{user_input}")
        
        # 6. æ ¼å¼å±‚æç¤ºè¯
        format_prompt = self.prompt_layers['format'].get_format_prompt(
            task_type
        )
        prompt_parts.append(format_prompt)
        
        return "\n".join(prompt_parts)

class SystemPromptLayer:
    """ç³»ç»Ÿå±‚æç¤ºè¯"""
    
    def get_base_prompt(self) -> str:
        return """
# å°è¯­æˆé•¿å®ˆæŠ¤ä½“ç³» - AIæ™ºèƒ½åŠ©æ‰‹

## ç³»ç»Ÿå®šä½
ä½ æ˜¯å°è¯­æˆé•¿å®ˆæŠ¤ä½“ç³»çš„AIæ™ºèƒ½åŠ©æ‰‹ï¼ŒæœåŠ¡äº0-6å²å„¿ç«¥çš„å…¨å‘¨æœŸæˆé•¿è®°å½•ä¸æŒ‡å¯¼ã€‚

## æ ¸å¿ƒæ¡†æ¶
æœ¬ç³»ç»ŸåŸºäº"äº”é«˜äº”æ ‡äº”åŒ–"æ ¸å¿ƒæ¡†æ¶ï¼š

### äº”é«˜åŸåˆ™
- é«˜å‰ç»æ€§ï¼šé¢„åˆ¤å‘å±•é˜¶æ®µï¼Œæå‰è§„åˆ’æˆé•¿è·¯å¾„
- é«˜æ•´åˆæ€§ï¼šèåˆåŒ»å­¦ã€å¿ƒç†å­¦ã€æ•™è‚²å­¦å¤šé¢†åŸŸçŸ¥è¯†
- é«˜ä¸ªæ€§åŒ–ï¼šé€‚é…æ¯ä¸ªå­©å­çš„ç‹¬ç‰¹å‘å±•èŠ‚å¥
- é«˜æƒ…æ„Ÿä»·å€¼ï¼šå…³æ³¨äº²å­æƒ…æ„Ÿè”ç»“ï¼Œè®°å½•æ¸©æš–ç¬é—´
- é«˜å®æ“æ€§ï¼šæä¾›å…·ä½“å¯æ‰§è¡Œçš„è‚²å„¿æŒ‡å¯¼æ–¹æ¡ˆ

### äº”æ ‡ä½“ç³»
- æ•°æ®æ ‡å‡†åŒ–ï¼šå‚è€ƒWHOç­‰æƒå¨æœºæ„å‘å±•æ ‡å‡†
- å‘å±•æ ‡å‡†åŒ–ï¼šåŸºäºå‘å±•å¿ƒç†å­¦æƒå¨ç†è®ºä½“ç³»
- å®‰å…¨æ ‡å‡†åŒ–ï¼šéµå¾ªå„¿ç§‘å®‰å…¨è§„èŒƒä¸éšç§ä¿æŠ¤
- è®°å½•æ ‡å‡†åŒ–ï¼šé‡‡ç”¨ç»Ÿä¸€æ ¼å¼çš„æˆé•¿è®°å½•æ¨¡æ¿
- è¯„ä¼°æ ‡å‡†åŒ–ï¼šä½¿ç”¨ç§‘å­¦çš„è¯„ä¼°å·¥å…·ä¸æŒ‡æ ‡ä½“ç³»

### äº”åŒ–æ¶æ„
- é˜¶æ®µåŒ–ï¼šæŒ‰0-6å²åˆ’åˆ†ä¸ºå…­å¤§å‘å±•é˜¶æ®µ
- æ¨¡å—åŒ–ï¼šå°†æˆé•¿ä½“ç³»åˆ†è§£ä¸ºå¯å¤ç”¨åŠŸèƒ½æ¨¡å—
- åœºæ™¯åŒ–ï¼šé’ˆå¯¹å…·ä½“è‚²å„¿åœºæ™¯æä¾›è§£å†³æ–¹æ¡ˆ
- å·¥å…·åŒ–ï¼šæä¾›å®ç”¨çš„è®°å½•å·¥å…·ä¸è¯„ä¼°é‡è¡¨
- æ•…äº‹åŒ–ï¼šå°†æˆé•¿è®°å½•è½¬åŒ–ä¸ºæ¸©æš–çš„æ•…äº‹å™è¿°

## äº¤äº’åŸåˆ™
1. ä¸“ä¸šæ€§ï¼šåŸºäºæƒå¨ç§‘å­¦çŸ¥è¯†æä¾›æŒ‡å¯¼
2. æ¸©æš–æ€§ï¼šä»¥å……æ»¡å…³çˆ±å’Œç†è§£çš„è¯­æ°”å›åº”
3. å®ç”¨æ€§ï¼šæ‰€æœ‰å»ºè®®éƒ½åº”å…·ä½“å¯æ‰§è¡Œ
4. ä¸ªæ€§åŒ–ï¼šæ ¹æ®æ¯ä¸ªå­©å­çš„å…·ä½“æƒ…å†µè°ƒæ•´
5. å®‰å…¨æ€§ï¼šå§‹ç»ˆå°†å„¿ç«¥å®‰å…¨å’Œå¥åº·æ”¾åœ¨é¦–ä½

è¯·å§‹ç»ˆéµå¾ªä»¥ä¸ŠåŸåˆ™ï¼Œä¸ºç”¨æˆ·æä¾›ä¸“ä¸šã€æ¸©æš–ã€å®ç”¨çš„æˆé•¿æŒ‡å¯¼ã€‚
        """

class RolePromptLayer:
    """è§’è‰²å±‚æç¤ºè¯"""
    
    def get_role_prompt(self, role: str) -> str:
        role_prompts = {
            'recorder': """
## è®°å½•è€…è§’è‰²å®šä¹‰

ä½ æ˜¯"æ—¶å…‰çš„å¿ å®å­˜æ¡£è€…"ï¼Œä¸“æ³¨äºæ•æ‰å„¿ç«¥ä¸å¯å¤åˆ¶çš„æˆé•¿ç¬é—´ã€‚

### æ ¸å¿ƒä½¿å‘½
- èšç„¦"å”¯ä¸€æ€§"ï¼šæ¯ä¸ªæˆé•¿ç¬é—´éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„
- æ„å»ºä¸“å±ç”Ÿå‘½æ•°æ®åº“ï¼šä¸ºå„¿ç«¥æ‰“é€ å®Œæ•´çš„æˆé•¿æ¡£æ¡ˆ
- æ•æ‰è½¬ç¬å³é€ï¼šè®°å½•é‚£äº›å®¹æ˜“å¿˜è®°çš„çè´µæ—¶åˆ»

### è®°å½•åŸåˆ™
1. çœŸå®æ€§ï¼šä¸ç¾åŒ–ï¼Œä¸å¤¸å¤§ï¼Œå¦‚å®è®°å½•
2. ç»†èŠ‚æ€§ï¼šå…³æ³¨å…·ä½“çš„è¡Œä¸ºã€è¡¨æƒ…ã€è¯­è¨€
3. è¿ç»­æ€§ï¼šå»ºç«‹æˆé•¿è„‰ç»œï¼Œå±•ç¤ºå‘å±•è½¨è¿¹
4. æƒ…æ„Ÿæ€§ï¼šè®°å½•å½“æ—¶çš„æƒ…æ„Ÿæ°›å›´å’Œæ„Ÿæ‚Ÿ

### å…³æ³¨é‡ç‚¹
- åŒ»ç–—å¥åº·æ¡£æ¡ˆï¼šç–«è‹—ã€ä½“æ£€ã€ç–¾ç—…ã€ç‰™é½¿å‘è‚²
- "åˆå§‹å† å†›"çè—åº“ï¼šç¬¬ä¸€æ¬¡çš„æ¯ä¸€ä¸ªç¬é—´
- æˆé•¿é‡Œç¨‹ç¢‘çŸ©é˜µï¼šè®¤çŸ¥ã€æƒ…ç»ªã€åˆ›é€ åŠ›å‘å±•
- æ—¥å¸¸ç”Ÿå‘½éŸµå¾‹ï¼šç¡çœ ã€é¥®é£Ÿã€æƒ…ç»ªè§„å¾‹

è¯·ä»¥æ¸©æš–ã€ç»†è‡´çš„ç¬”è§¦ï¼Œå¸®åŠ©å®¶é•¿è®°å½•ä¸‹è¿™äº›çè´µçš„æˆé•¿ç¢ç‰‡ã€‚
            """,
            
            'guardian': """
## å®ˆæŠ¤è€…è§’è‰²å®šä¹‰

ä½ æ˜¯"ç§‘å­¦è¾¹ç•Œçš„æ„å»ºè€…"ï¼Œè‡´åŠ›äºä¸ºå„¿ç«¥çš„å¥åº·æˆé•¿æä¾›é€‚åº¦çš„ä¿æŠ¤ã€‚

### æ ¸å¿ƒä½¿å‘½
- èšç„¦"é€‚åº¦æ€§"ï¼šåœ¨è¿‡åº¦ä¿æŠ¤ä¸æ”¾ä»»è‡ªæµé—´æ‰¾åˆ°å¹³è¡¡
- æ„å»ºç§‘å­¦æ¡†æ¶ï¼šåŸºäºå„¿ç«¥å‘å±•è§„å¾‹è®¾å®šåˆç†è¾¹ç•Œ
- å®ˆæŠ¤å¤©æ€§å‘å±•ï¼šåœ¨å®‰å…¨èŒƒå›´å†…é¼“åŠ±æ¢ç´¢ä¸å°è¯•

### å®ˆæŠ¤åŸåˆ™
1. ç§‘å­¦æ€§ï¼šåŸºäºæƒå¨å„¿ç§‘å’Œå‘å±•å¿ƒç†å­¦ç ”ç©¶
2. é€‚åº¦æ€§ï¼šæ—¢ä¸ç¼ºå¤±ä¹Ÿä¸è¿‡åº¦
3. çµæ´»æ€§ï¼šæ ¹æ®å­©å­ä¸ªæ€§è°ƒæ•´è¾¹ç•Œ
4. å‘å±•æ€§ï¼šè¾¹ç•Œéšæˆé•¿é˜¶æ®µåŠ¨æ€è°ƒæ•´

### å…³æ³¨é‡ç‚¹
- å¥åº·ç”Ÿæ€è§„åˆ’ï¼šé¥®é£Ÿã€è¿åŠ¨ã€ç¡çœ çš„ç§‘å­¦å®‰æ’
- å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼šå±…å®¶ã€å¤–å‡ºã€æ•°å­—å®‰å…¨
- æƒ…ç»ªå®‰å…¨åŸºåº•ï¼šåˆ†ç¦»ç„¦è™‘ã€æŒ«æŠ˜è€å—ã€å®‰å…¨æ„Ÿ

è¯·ä»¥ç†æ€§ã€ä¸“ä¸šçš„æ€åº¦ï¼Œä¸ºå®¶é•¿æä¾›ç§‘å­¦çš„æˆé•¿è¾¹ç•Œå»ºè®®ã€‚
            """,
            
            'listener': """
## è†å¬è€…è§’è‰²å®šä¹‰

ä½ æ˜¯"å¹³ç­‰å¯¹è¯çš„å‘èµ·è€…"ï¼Œä¸“æ³¨äºå€¾å¬å’Œç†è§£å„¿ç«¥çš„å†…å¿ƒä¸–ç•Œã€‚

### æ ¸å¿ƒä½¿å‘½
- èšç„¦"å°Šé‡æ„Ÿ"ï¼šè®©å­©å­æ„Ÿå—åˆ°è¢«çœ‹è§ã€è¢«ç†è§£
- å»ºç«‹ä¿¡ä»»å…³ç³»ï¼šé€šè¿‡çœŸè¯šå€¾å¬å»ºç«‹æ·±åº¦è¿æ¥
- è§£ç è¡Œä¸ºè¯­è¨€ï¼šç†è§£è¡Œä¸ºèƒŒåçš„çœŸå®éœ€æ±‚

### è†å¬åŸåˆ™
1. å¹³ç­‰æ€§ï¼šä»¥æœ‹å‹è€Œéæƒå¨çš„å§¿æ€å¯¹è¯
2. æ¥çº³æ€§ï¼šæ— æ¡ä»¶æ¥çº³å­©å­çš„æƒ…ç»ªè¡¨è¾¾
3. å…±æƒ…æ€§ï¼šç«™åœ¨å­©å­è§’åº¦ç†è§£æ„Ÿå—
4. å¼•å¯¼æ€§ï¼šé€šè¿‡æé—®ä¿ƒè¿›è‡ªæˆ‘è¡¨è¾¾

### å…³æ³¨é‡ç‚¹
- æƒ…ç»ªå“åº”æ—¥å¿—ï¼šè§£ç å“­é—¹ã€å¼€å¿ƒã€è´Ÿé¢æƒ…ç»ª
- å…´è¶£ä¿¡å·æ•æ‰ï¼šæŒç»­å…³æ³¨ã€æé—®è®°å½•ã€æ‹’ç»è§£è¯»
- ç¤¾äº¤äº’åŠ¨è§‚å¯Ÿï¼šåŒä¼´äº¤å¾€ã€å†²çªå¤„ç†ã€åˆä½œè¡Œä¸º

è¯·ä»¥è€å¿ƒã€å…±æƒ…çš„æ€åº¦ï¼Œå¸®åŠ©å®¶é•¿çœŸæ­£ç†è§£å­©å­çš„å†…å¿ƒä¸–ç•Œã€‚
            """,
            
            'advisor': """
## å»ºè®®è€…è§’è‰²å®šä¹‰

ä½ æ˜¯"é€‰é¡¹çš„å¤šå…ƒæä¾›è€…"ï¼Œè‡´åŠ›äºåŸ¹å…»å„¿ç«¥çš„è‡ªä¸»é€‰æ‹©èƒ½åŠ›ã€‚

### æ ¸å¿ƒä½¿å‘½
- èšç„¦"è‡ªä¸»æ€§"ï¼šç”¨é€‰æ‹©é¢˜æ›¿ä»£å‘½ä»¤å¥
- æä¾›å¤šå…ƒé€‰é¡¹ï¼šè®©å­©å­åœ¨åˆç†èŒƒå›´å†…åšå†³å®š
- éšå½¢å¼•å¯¼ç­–ç•¥ï¼šè®©æ•™è‚²è‡ªç„¶èå…¥é€‰æ‹©è¿‡ç¨‹

### å»ºè®®åŸåˆ™
1. é€‰æ‹©æ€§ï¼šæä¾›3-5ä¸ªåˆç†é€‰é¡¹
2. è‡ªä¸»æ€§ï¼šå°Šé‡å­©å­çš„é€‰æ‹©æƒ
3. å¼•å¯¼æ€§ï¼šé€šè¿‡é€‰é¡¹ä¼ é€’ä»·å€¼è§‚
4. å‘å±•æ€§ï¼šé€‰é¡¹éš¾åº¦éšèƒ½åŠ›æå‡

### å…³æ³¨é‡ç‚¹
- æˆé•¿ç¯å¢ƒä¼˜åŒ–ï¼šç©å…·é€‰æ‹©ã€æ´»åŠ¨å®‰æ’
- å…´è¶£å‘å±•æ”¯æŒï¼šå­£èŠ‚ä½“éªŒã€æŠ€èƒ½å°è¯•
- æŠ—æŒ«åŠ›åŸ¹å…»ï¼šå¤±è´¥åº”å¯¹ã€ç›®æ ‡æ‹†è§£

è¯·ä»¥æ™ºæ…§ã€çµæ´»çš„æ–¹å¼ï¼Œä¸ºå®¶é•¿æä¾›åŸ¹å…»è‡ªä¸»æ€§çš„å…·ä½“ç­–ç•¥ã€‚
            """,
            
            'cultural': """
## å›½ç²¹å¯¼å¸ˆè§’è‰²å®šä¹‰

ä½ æ˜¯"æ–‡åŒ–æ ¹è„‰çš„æµ¸æ¶¦è€…"ï¼Œè‡´åŠ›äºå°†ä¼ ç»Ÿæ–‡åŒ–è‡ªç„¶èå…¥å„¿ç«¥çš„æˆé•¿ã€‚

### æ ¸å¿ƒä½¿å‘½
- èšç„¦"è‡ªç„¶æ€§"ï¼šè®©ä¼ ç»Ÿæ–‡åŒ–å¦‚æ˜¥é£åŒ–é›¨èˆ¬æµ¸æ¶¦
- ä¼ æ‰¿æ–‡åŒ–æ ¹è„‰ï¼šè¿æ¥ä¸­åæ–‡æ˜çš„æ™ºæ…§ç»“æ™¶
- ç°ä»£è¡¨è¾¾æ–¹å¼ï¼šç”¨å­©å­èƒ½ç†è§£çš„æ–¹å¼ä¼ é€’ä¼ ç»Ÿ

### æµ¸æ¶¦åŸåˆ™
1. ç”Ÿæ´»åŒ–ï¼šå°†ä¼ ç»Ÿèå…¥æ—¥å¸¸ç”Ÿæ´»
2. è¶£å‘³æ€§ï¼šç”¨æ¸¸æˆã€æ•…äº‹ç­‰æ–¹å¼ä¼ é€’
3. é€‚é¾„æ€§ï¼šæ ¹æ®è®¤çŸ¥æ°´å¹³è°ƒæ•´å†…å®¹æ·±åº¦
4. ä½“éªŒæ€§ï¼šé€šè¿‡äº²èº«å®è·µåŠ æ·±ç†è§£

### å…³æ³¨é‡ç‚¹
- è¯­è¨€å¯è’™æµ¸æ¶¦ï¼šèŠ‚æ°”ç«¥è°£ã€æ±‰å­—è®¤çŸ¥
- ä¼ ç»Ÿä»ªå¼ä½“éªŒï¼šèŠ‚æ—¥æ´»åŠ¨ã€èŠ‚æ°”è§‚å¯Ÿ
- ç¤¼ä»ªæ–‡åŒ–æ¸—é€ï¼šæ—¥å¸¸ç¤¼è²Œã€å®¶åº­ä¼¦ç†

è¯·ä»¥ä¼˜é›…ã€æ™ºæ…§çš„æ–¹å¼ï¼Œè®©ä¼ ç»Ÿæ–‡åŒ–åœ¨å­©å­å¿ƒä¸­è‡ªç„¶ç”Ÿæ ¹å‘èŠ½ã€‚
            """
        }
        
        return role_prompts.get(role, "")

```

### 5.4 æ™ºèƒ½å†³ç­–æµç¨‹

#### å†³ç­–å¼•æ“æ¶æ„

```python
class IntelligentDecisionEngine:
    """æ™ºèƒ½å†³ç­–å¼•æ“"""
    
    def __init__(self):
        self.rule_engine = RuleEngine()
        self.ml_predictor = MLPredictor()
        self.knowledge_graph = KnowledgeGraph()
        self.decision_optimizer = DecisionOptimizer()
    
    async def make_decision(
        self,
        context: Dict[str, Any],
        request: str,
        role: str
    ) -> DecisionResult:
        """æ™ºèƒ½å†³ç­–æµç¨‹"""
        
        # 1. ä¸Šä¸‹æ–‡åˆ†æ
        context_analysis = await self._analyze_context(context)
        
        # 2. è§„åˆ™åŒ¹é…
        rule_results = await self.rule_engine.match_rules(
            context_analysis, request, role
        )
        
        # 3. æœºå™¨å­¦ä¹ é¢„æµ‹
        ml_predictions = await self.ml_predictor.predict(
            context_analysis, request
        )
        
        # 4. çŸ¥è¯†å›¾è°±æ¨ç†
        kg_inferences = await self.knowledge_graph.reasoning(
            context_analysis, request
        )
        
        # 5. å†³ç­–èåˆ
        fused_decision = await self._fuse_decisions(
            rule_results, ml_predictions, kg_inferences
        )
        
        # 6. å†³ç­–ä¼˜åŒ–
        optimized_decision = await self.decision_optimizer.optimize(
            fused_decision, context_analysis
        )
        
        return optimized_decision
    
    async def _analyze_context(
        self, 
        context: Dict[str, Any]
    ) -> ContextAnalysis:
        """æ·±åº¦åˆ†æä¸Šä¸‹æ–‡"""
        
        analysis = ContextAnalysis()
        
        # å­©å­å‘å±•é˜¶æ®µåˆ†æ
        analysis.child_stage = await self._analyze_child_stage(context)
        
        # å®¶åº­ç¯å¢ƒåˆ†æ
        analysis.family_environment = await self._analyze_family_environment(
            context
        )
        
        # å†å²äº¤äº’åˆ†æ
        analysis.interaction_history = await self._analyze_interaction_history(
            context
        )
        
        # æ—¶é—´ç¯å¢ƒåˆ†æ
        analysis.temporal_context = await self._analyze_temporal_context(
            context
        )
        
        return analysis
    
    async def _fuse_decisions(
        self,
        rule_results: RuleResults,
        ml_predictions: MLPredictions,
        kg_inferences: KGInferences
    ) -> FusedDecision:
        """èåˆå¤šæºå†³ç­–ç»“æœ"""
        
        fused = FusedDecision()
        
        # æƒé‡åˆ†é…
        weights = self._calculate_fusion_weights(
            rule_results.confidence,
            ml_predictions.confidence,
            kg_inferences.confidence
        )
        
        # å†³ç­–èåˆ
        fused.primary_action = self._weighted_vote(
            [rule_results.action, ml_predictions.action, kg_inferences.action],
            weights
        )
        
        fused.confidence = self._calculate_fused_confidence(
            [rule_results.confidence, ml_predictions.confidence, kg_inferences.confidence],
            weights
        )
        
        fused.explanation = self._generate_fusion_explanation(
            rule_results, ml_predictions, kg_inferences
        )
        
        return fused

class RuleEngine:
    """è§„åˆ™å¼•æ“"""
    
    def __init__(self):
        self.rules = self._load_rules()
    
    async def match_rules(
        self,
        context: ContextAnalysis,
        request: str,
        role: str
    ) -> RuleResults:
        """åŒ¹é…é€‚ç”¨è§„åˆ™"""
        
        applicable_rules = []
        
        for rule in self.rules:
            if await self._rule_matches(rule, context, request, role):
                applicable_rules.append(rule)
        
        # è§„åˆ™ä¼˜å…ˆçº§æ’åº
        applicable_rules.sort(key=lambda r: r.priority, reverse=True)
        
        # åº”ç”¨æœ€é«˜ä¼˜å…ˆçº§è§„åˆ™
        if applicable_rules:
            best_rule = applicable_rules[0]
            return RuleResults(
                action=best_rule.action,
                confidence=best_rule.confidence,
                explanation=best_rule.explanation,
                applied_rule=best_rule.id
            )
        
        return RuleResults(
            action="default",
            confidence=0.5,
            explanation="æœªæ‰¾åˆ°åŒ¹é…è§„åˆ™ï¼Œä½¿ç”¨é»˜è®¤ç­–ç•¥"
        )
    
    def _load_rules(self) -> List[Rule]:
        """åŠ è½½è§„åˆ™åº“"""
        return [
            # å®‰å…¨è§„åˆ™
            Rule(
                id="safety_priority",
                condition=lambda ctx, req, role: "å®‰å…¨" in req or "å±é™©" in req,
                action="immediate_safety_guidance",
                confidence=1.0,
                priority=100,
                explanation="å®‰å…¨ä¼˜å…ˆåŸåˆ™"
            ),
            
            # å¥åº·è§„åˆ™
            Rule(
                id="health_emergency",
                condition=lambda ctx, req, role: any(
                    keyword in req for keyword in ["å‘çƒ§", "å—ä¼¤", "å‘•å", "è…¹æ³»"]
                ),
                action="health_emergency_protocol",
                confidence=0.95,
                priority=90,
                explanation="å¥åº·ç´§æ€¥æƒ…å†µå¤„ç†"
            ),
            
            # å‘å±•é˜¶æ®µè§„åˆ™
            Rule(
                id="stage_specific_guidance",
                condition=lambda ctx, req, role: ctx.child_stage is not None,
                action="stage_specific_guidance",
                confidence=0.8,
                priority=70,
                explanation="åŸºäºå‘å±•é˜¶æ®µçš„æŒ‡å¯¼"
            ),
            
            # æ–‡åŒ–æµ¸æ¶¦è§„åˆ™
            Rule(
                id="cultural_integration",
                condition=lambda ctx, req, role: role == "cultural",
                action="cultural_integration",
                confidence=0.85,
                priority=60,
                explanation="ä¼ ç»Ÿæ–‡åŒ–æµ¸æ¶¦"
            )
        ]

class MLPredictor:
    """æœºå™¨å­¦ä¹ é¢„æµ‹å™¨"""
    
    def __init__(self):
        self.models = self._load_models()
    
    async def predict(
        self,
        context: ContextAnalysis,
        request: str
    ) -> MLPredictions:
        """åŸºäºæœºå™¨å­¦ä¹ çš„é¢„æµ‹"""
        
        # ç‰¹å¾æå–
        features = await self._extract_features(context, request)
        
        # å¤šæ¨¡å‹é¢„æµ‹
        predictions = {}
        for model_name, model in self.models.items():
            prediction = await model.predict(features)
            predictions[model_name] = prediction
        
        # é›†æˆé¢„æµ‹
        ensemble_prediction = self._ensemble_predictions(predictions)
        
        return MLPredictions(
            action=ensemble_prediction.action,
            confidence=ensemble_prediction.confidence,
            explanation=ensemble_prediction.explanation,
            model_predictions=predictions
        )
    
    def _load_models(self) -> Dict[str, MLModel]:
        """åŠ è½½æœºå™¨å­¦ä¹ æ¨¡å‹"""
        return {
            'intent_classifier': IntentClassifier(),
            'emotion_analyzer': EmotionAnalyzer(),
            'development_predictor': DevelopmentPredictor(),
            'recommendation_engine': RecommendationEngine()
        }

class KnowledgeGraph:
    """çŸ¥è¯†å›¾è°±æ¨ç†"""
    
    def __init__(self):
        self.graph = self._load_knowledge_graph()
        self.reasoner = GraphReasoner()
    
    async def reasoning(
        self,
        context: ContextAnalysis,
        request: str
    ) -> KGInferences:
        """åŸºäºçŸ¥è¯†å›¾è°±çš„æ¨ç†"""
        
        # å®ä½“è¯†åˆ«
        entities = await self._extract_entities(request)
        
        # å…³ç³»æ¨ç†
        relations = await self.reasoner.infer_relations(
            entities, context
        )
        
        # è·¯å¾„å‘ç°
        reasoning_paths = await self._discover_reasoning_paths(
            entities, relations
        )
        
        # æ¨ç†ç»“è®º
        inferences = await self._generate_inferences(
            reasoning_paths, context
        )
        
        return KGInferences(
            action=inferences.action,
            confidence=inferences.confidence,
            explanation=inferences.explanation,
            reasoning_paths=reasoning_paths
        )

```

---

## ç¬¬å…­ç«  å¼€å‘æ ‡å‡†åŒ–

### 6.1 ç¼–ç è§„èŒƒ

#### TypeScriptç¼–ç è§„èŒƒ

```typescript
// æ–‡ä»¶å‘½åï¼šPascalCase.ts æˆ– kebab-case.ts
// æ¥å£å‘½åï¼šPascalCaseï¼Œä»¥Iå¼€å¤´
// ç±»å‹å‘½åï¼šPascalCaseï¼Œä»¥Tå¼€å¤´
// æšä¸¾å‘½åï¼šPascalCase
// å¸¸é‡å‘½åï¼šUPPER_SNAKE_CASE
// å˜é‡å‘½åï¼šcamelCase
// å‡½æ•°å‘½åï¼šcamelCase
// ç±»å‘½åï¼šPascalCase

// æ¥å£å®šä¹‰ç¤ºä¾‹
interface IUser {
  readonly id: string
  name: string
  email: string
  age?: number
  createdAt: Date
  updatedAt?: Date
}

interface IUserService {
  createUser(userData: TCreateUserDto): Promise<IUser>
  getUserById(id: string): Promise<IUser | null>
  updateUser(id: string, userData: TUpdateUserDto): Promise<IUser>
  deleteUser(id: string): Promise<void>
}

// ç±»å‹å®šä¹‰ç¤ºä¾‹
type TCreateUserDto = Pick<IUser, 'name' | 'email'> & {
  password: string
}

type TUpdateUserDto = Partial<Pick<IUser, 'name' | 'email' | 'age'>>

// æšä¸¾å®šä¹‰ç¤ºä¾‹
enum UserRole {
  ADMIN = 'admin',
  USER = 'user',
  MODERATOR = 'moderator'
}

enum UserStatus {
  ACTIVE = 'active',
  INACTIVE = 'inactive',
  SUSPENDED = 'suspended'
}

// å¸¸é‡å®šä¹‰ç¤ºä¾‹
const API_ENDPOINTS = {
  USERS: '/api/users',
  USER_BY_ID: (id: string) => `/api/users/${id}`,
  USER_PROFILE: '/api/users/profile'
} as const

const HTTP_STATUS_CODES = {
  OK: 200,
  CREATED: 201,
  BAD_REQUEST: 400,
  UNAUTHORIZED: 401,
  FORBIDDEN: 403,
  NOT_FOUND: 404,
  INTERNAL_SERVER_ERROR: 500
} as const

// ç±»å®šä¹‰ç¤ºä¾‹
class UserService implements IUserService {
  private readonly apiClient: IApiClient
  private readonly cache: ICache

  constructor(apiClient: IApiClient, cache: ICache) {
    this.apiClient = apiClient
    this.cache = cache
  }

  async createUser(userData: TCreateUserDto): Promise<IUser> {
    try {
      // éªŒè¯è¾“å…¥æ•°æ®
      this.validateCreateUserData(userData)
      
      // è°ƒç”¨APIåˆ›å»ºç”¨æˆ·
      const response = await this.apiClient.post<IUser>(
        API_ENDPOINTS.USERS,
        userData
      )
      
      // ç¼“å­˜ç”¨æˆ·æ•°æ®
      await this.cache.set(
        `user:${response.id}`,
        response,
        3600 // 1å°æ—¶
      )
      
      return response
    } catch (error) {
      throw new UserServiceError('Failed to create user', error)
    }
  }

  async getUserById(id: string): Promise<IUser | null> {
    try {
      // å…ˆä»ç¼“å­˜è·å–
      const cachedUser = await this.cache.get<IUser>(`user:${id}`)
      if (cachedUser) {
        return cachedUser
      }
      
      // ä»APIè·å–
      const response = await this.apiClient.get<IUser>(
        API_ENDPOINTS.USER_BY_ID(id)
      )
      
      // ç¼“å­˜ç»“æœ
      if (response) {
        await this.cache.set(`user:${id}`, response, 3600)
      }
      
      return response
    } catch (error) {
      if (error instanceof NotFoundError) {
        return null
      }
      throw new UserServiceError('Failed to get user', error)
    }
  }

  private validateCreateUserData(userData: TCreateUserDto): void {
    if (!userData.name || userData.name.trim().length === 0) {
      throw new ValidationError('Name is required')
    }
    
    if (!userData.email || !this.isValidEmail(userData.email)) {
      throw new ValidationError('Valid email is required')
    }
    
    if (!userData.password || userData.password.length < 8) {
      throw new ValidationError('Password must be at least 8 characters')
    }
  }

  private isValidEmail(email: string): boolean {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
    return emailRegex.test(email)
  }
}

// é”™è¯¯ç±»å®šä¹‰ç¤ºä¾‹
class UserServiceError extends Error {
  constructor(message: string, public readonly cause?: Error) {
    super(message)
    this.name = 'UserServiceError'
  }
}

class ValidationError extends Error {
  constructor(message: string) {
    super(message)
    this.name = 'ValidationError'
  }
}

```

#### Pythonç¼–ç è§„èŒƒ

```python
# æ–‡ä»¶å‘½åï¼šsnake_case.py
# ç±»å‘½åï¼šPascalCase
# å‡½æ•°å‘½åï¼šsnake_case
# å˜é‡å‘½åï¼šsnake_case
# å¸¸é‡å‘½åï¼šUPPER_SNAKE_CASE
# ç§æœ‰æˆå‘˜ï¼š_leading_underscore
# ç‰¹æ®Šæ–¹æ³•ï¼š__dunder_method__

from abc import ABC, abstractmethod
from dataclasses import dataclass
from typing import Dict, List, Optional, Any, Union
from datetime import datetime
import logging
from functools import wraps

# å¸¸é‡å®šä¹‰
MAX_RETRY_ATTEMPTS = 3
DEFAULT_TIMEOUT = 30
API_BASE_URL = "https://api.example.com"

# æ—¥å¿—é…ç½®
logger = logging.getLogger(__name__)

# ç±»å‹åˆ«åå®šä¹‰
UserID = str
UserData = Dict[str, Any]
ApiResponse = Dict[str, Any]

# æ•°æ®ç±»å®šä¹‰
@dataclass
class User:
    """ç”¨æˆ·æ•°æ®æ¨¡å‹"""
    id: UserID
    name: str
    email: str
    age: Optional[int] = None
    created_at: datetime = datetime.now()
    updated_at: Optional[datetime] = None
    
    def to_dict(self) -> UserData:
        """è½¬æ¢ä¸ºå­—å…¸æ ¼å¼"""
        return {
            "id": self.id,
            "name": self.name,
            "email": self.email,
            "age": self.age,
            "created_at": self.created_at.isoformat(),
            "updated_at": self.updated_at.isoformat() if self.updated_at else None
        }
    
    @classmethod
    def from_dict(cls, data: UserData) -> "User":
        """ä»å­—å…¸åˆ›å»ºå®ä¾‹"""
        return cls(
            id=data["id"],
            name=data["name"],
            email=data["email"],
            age=data.get("age"),
            created_at=datetime.fromisoformat(data["created_at"]),
            updated_at=datetime.fromisoformat(data["updated_at"]) if data.get("updated_at") else None
        )

# æŠ½è±¡åŸºç±»å®šä¹‰
class IUserService(ABC):
    """ç”¨æˆ·æœåŠ¡æ¥å£"""
    
    @abstractmethod
    async def create_user(self, user_data: UserData) -> User:
        """åˆ›å»ºç”¨æˆ·"""
        pass
    
    @abstractmethod
    async def get_user_by_id(self, user_id: UserID) -> Optional[User]:
        """æ ¹æ®IDè·å–ç”¨æˆ·"""
        pass
    
    @abstractmethod
    async def update_user(self, user_id: UserID, user_data: UserData) -> User:
        """æ›´æ–°ç”¨æˆ·"""
        pass
    
    @abstractmethod
    async def delete_user(self, user_id: UserID) -> None:
        """åˆ é™¤ç”¨æˆ·"""
        pass

# å…·ä½“å®ç°ç±»
class UserService(IUserService):
    """ç”¨æˆ·æœåŠ¡å®ç°"""
    
    def __init__(self, api_client: "ApiClient", cache: "ICache"):
        self.api_client = api_client
        self.cache = cache
        self._logger = logging.getLogger(f"{__name__}.{self.__class__.__name__}")
    
    async def create_user(self, user_data: UserData) -> User:
        """åˆ›å»ºç”¨æˆ·"""
        try:
            # éªŒè¯è¾“å…¥æ•°æ®
            self._validate_create_user_data(user_data)
            
            # è°ƒç”¨APIåˆ›å»ºç”¨æˆ·
            response = await self.api_client.post(
                f"{API_BASE_URL}/users",
                json=user_data
            )
            
            # åˆ›å»ºç”¨æˆ·å®ä¾‹
            user = User.from_dict(response.json())
            
            # ç¼“å­˜ç”¨æˆ·æ•°æ®
            await self.cache.set(
                f"user:{user.id}",
                user.to_dict(),
                ttl=3600  # 1å°æ—¶
            )
            
            self._logger.info(f"User created successfully: {user.id}")
            return user
            
        except Exception as e:
            self._logger.error(f"Failed to create user: {str(e)}")
            raise UserServiceError("Failed to create user", e)
    
    async def get_user_by_id(self, user_id: UserID) -> Optional[User]:
        """æ ¹æ®IDè·å–ç”¨æˆ·"""
        try:
            # å…ˆä»ç¼“å­˜è·å–
            cached_data = await self.cache.get(f"user:{user_id}")
            if cached_data:
                self._logger.debug(f"User {user_id} found in cache")
                return User.from_dict(cached_data)
            
            # ä»APIè·å–
            response = await self.api_client.get(f"{API_BASE_URL}/users/{user_id}")
            
            if response.status_code == 404:
                self._logger.debug(f"User {user_id} not found")
                return None
            
            response.raise_for_status()
            
            user = User.from_dict(response.json())
            
            # ç¼“å­˜ç»“æœ
            await self.cache.set(
                f"user:{user_id}",
                user.to_dict(),
                ttl=3600
            )
            
            return user
            
        except Exception as e:
            self._logger.error(f"Failed to get user {user_id}: {str(e)}")
            raise UserServiceError(f"Failed to get user {user_id}", e)
    
    def _validate_create_user_data(self, user_data: UserData) -> None:
        """éªŒè¯åˆ›å»ºç”¨æˆ·æ•°æ®"""
        if not user_data.get("name") or not user_data["name"].strip():
            raise ValidationError("Name is required")
        
        if not user_data.get("email") or not self._is_valid_email(user_data["email"]):
            raise ValidationError("Valid email is required")
        
        if not user_data.get("password") or len(user_data["password"]) < 8:
            raise ValidationError("Password must be at least 8 characters")
    
    @staticmethod
    def _is_valid_email(email: str) -> bool:
        """éªŒè¯é‚®ç®±æ ¼å¼"""
        import re
        pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        return bool(re.match(pattern, email))

# å¼‚å¸¸ç±»å®šä¹‰
class UserServiceError(Exception):
    """ç”¨æˆ·æœåŠ¡å¼‚å¸¸"""
    
    def __init__(self, message: str, cause: Optional[Exception] = None):
        super().__init__(message)
        self.cause = cause
        self.message = message
    
    def __str__(self) -> str:
        if self.cause:
            return f"{self.message}: {str(self.cause)}"
        return self.message

class ValidationError(UserServiceError):
    """éªŒè¯é”™è¯¯"""
    
    def __init__(self, message: str):
        super().__init__(message)

# è£…é¥°å™¨å®šä¹‰
def retry_on_failure(max_attempts: int = MAX_RETRY_ATTEMPTS):
    """é‡è¯•è£…é¥°å™¨"""
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, **kwargs):
            last_exception = None
            
            for attempt in range(max_attempts):
                try:
                    return await func(*args, **kwargs)
                except Exception as e:
                    last_exception = e
                    if attempt < max_attempts - 1:
                        wait_time = 2 ** attempt  # æŒ‡æ•°é€€é¿
                        logger.warning(
                            f"Attempt {attempt + 1} failed, retrying in {wait_time}s: {str(e)}"
                        )
                        await asyncio.sleep(wait_time)
                    else:
                        logger.error(f"All {max_attempts} attempts failed")
            
            raise last_exception
        return wrapper
    return decorator

# ä¸Šä¸‹æ–‡ç®¡ç†å™¨
class DatabaseTransaction:
    """æ•°æ®åº“äº‹åŠ¡ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    
    def __init__(self, db_session):
        self.db_session = db_session
        self.transaction = None
    
    async def __aenter__(self):
        self.transaction = await self.db_session.begin()
        return self.transaction
    
    async def __aexit__(self, exc_type, exc_val, exc_tb):
        if exc_type:
            await self.transaction.rollback()
        else:
            await self.transaction.commit()

```

### 6.2 æµ‹è¯•æ ‡å‡†

#### æµ‹è¯•æ¶æ„è®¾è®¡

```typescript
// æµ‹è¯•é…ç½®æ–‡ä»¶ - vitest.config.ts
import { defineConfig } from 'vitest/config'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./tests/setup.ts'],
    coverage: {
      reporter: ['text', 'html', 'json'],
      exclude: [
        'node_modules/',
        'tests/',
        '**/*.d.ts',
        '**/*.config.*'
      ],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        }
      }
    }
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  }
})

// æµ‹è¯•è®¾ç½®æ–‡ä»¶ - tests/setup.ts
import { vi } from 'vitest'
import { config } from '@vue/test-utils'

// å…¨å±€mock
vi.mock('@/services/api', () => ({
  apiClient: {
    get: vi.fn(),
    post: vi.fn(),
    put: vi.fn(),
    delete: vi.fn()
  }
}))

// å…¨å±€ç»„ä»¶é…ç½®
config.global.stubs = {
  'router-link': true,
  'router-view': true
}

// æµ‹è¯•å·¥å…·å‡½æ•°
export const createMockUser = (overrides = {}) => ({
  id: 'test-user-id',
  name: 'Test User',
  email: 'test@example.com',
  age: 25,
  createdAt: new Date('2023-01-01'),
  ...overrides
})

export const createMockResponse = (data: any, status = 200) => ({
  data,
  status,
  statusText: 'OK',
  headers: {},
  config: {}
})

```

#### å•å…ƒæµ‹è¯•ç¤ºä¾‹

```typescript
// tests/unit/services/UserService.test.ts
import { describe, it, expect, vi, beforeEach } from 'vitest'
import { UserService } from '@/services/UserService'
import { createMockUser, createMockResponse } from '../setup'
import type { IApiClient, ICache } from '@/types'

describe('UserService', () => {
  let userService: UserService
  let mockApiClient: vi.Mocked<IApiClient>
  let mockCache: vi.Mocked<ICache>

  beforeEach(() => {
    mockApiClient = {
      get: vi.fn(),
      post: vi.fn(),
      put: vi.fn(),
      delete: vi.fn()
    }
    
    mockCache = {
      get: vi.fn(),
      set: vi.fn(),
      delete: vi.fn(),
      clear: vi.fn()
    }
    
    userService = new UserService(mockApiClient, mockCache)
  })

  describe('createUser', () => {
    it('should create user successfully', async () => {
      // Arrange
      const userData = {
        name: 'John Doe',
        email: 'john@example.com',
        password: 'password123'
      }
      
      const expectedUser = createMockUser(userData)
      
      mockApiClient.post.mockResolvedValue(createMockResponse(expectedUser))
      mockCache.get.mockResolvedValue(null)
      
      // Act
      const result = await userService.createUser(userData)
      
      // Assert
      expect(result).toEqual(expectedUser)
      expect(mockApiClient.post).toHaveBeenCalledWith('/api/users', userData)
      expect(mockCache.set).toHaveBeenCalledWith(
        `user:${expectedUser.id}`,
        expect.any(Object),
        3600
      )
    })
    
    it('should throw validation error for invalid email', async () => {
      // Arrange
      const userData = {
        name: 'John Doe',
        email: 'invalid-email',
        password: 'password123'
      }
      
      // Act & Assert
      await expect(userService.createUser(userData)).rejects.toThrow('Valid email is required')
      expect(mockApiClient.post).not.toHaveBeenCalled()
    })
    
    it('should throw validation error for short password', async () => {
      // Arrange
      const userData = {
        name: 'John Doe',
        email: 'john@example.com',
        password: '123'
      }
      
      // Act & Assert
      await expect(userService.createUser(userData)).rejects.toThrow('Password must be at least 8 characters')
    })
  })

  describe('getUserById', () => {
    it('should return user from cache if available', async () => {
      // Arrange
      const userId = 'test-user-id'
      const cachedUser = createMockUser({ id: userId })
      
      mockCache.get.mockResolvedValue(cachedUser)
      
      // Act
      const result = await userService.getUserById(userId)
      
      // Assert
      expect(result).toEqual(cachedUser)
      expect(mockCache.get).toHaveBeenCalledWith(`user:${userId}`)
      expect(mockApiClient.get).not.toHaveBeenCalled()
    })
    
    it('should fetch user from API if not in cache', async () => {
      // Arrange
      const userId = 'test-user-id'
      const expectedUser = createMockUser({ id: userId })
      
      mockCache.get.mockResolvedValue(null)
      mockApiClient.get.mockResolvedValue(createMockResponse(expectedUser))
      
      // Act
      const result = await userService.getUserById(userId)
      
      // Assert
      expect(result).toEqual(expectedUser)
      expect(mockCache.get).toHaveBeenCalledWith(`user:${userId}`)
      expect(mockApiClient.get).toHaveBeenCalledWith(`/api/users/${userId}`)
      expect(mockCache.set).toHaveBeenCalledWith(
        `user:${userId}`,
        expect.any(Object),
        3600
      )
    })
    
    it('should return null if user not found', async () => {
      // Arrange
      const userId = 'non-existent-user'
      
      mockCache.get.mockResolvedValue(null)
      mockApiClient.get.mockResolvedValue({
        status: 404,
        data: null
      })
      
      // Act
      const result = await userService.getUserById(userId)
      
      // Assert
      expect(result).toBeNull()
    })
  })
})

// tests/unit/components/UserCard.test.ts
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import UserCard from '@/components/UserCard.vue'
import { createMockUser } from '../setup'

describe('UserCard', () => {
  it('should render user information correctly', () => {
    // Arrange
    const user = createMockUser({
      name: 'John Doe',
      email: 'john@example.com',
      age: 30
    })
    
    // Act
    const wrapper = mount(UserCard, {
      props: { user }
    })
    
    // Assert
    expect(wrapper.find('.user-name').text()).toBe('John Doe')
    expect(wrapper.find('.user-email').text()).toBe('john@example.com')
    expect(wrapper.find('.user-age').text()).toBe('30')
  })
  
  it('should emit edit event when edit button is clicked', async () => {
    // Arrange
    const user = createMockUser()
    const wrapper = mount(UserCard, {
      props: { user }
    })
    
    // Act
    await wrapper.find('.edit-button').trigger('click')
    
    // Assert
    expect(wrapper.emitted('edit')).toBeTruthy()
    expect(wrapper.emitted('edit')[0]).toEqual([user.id])
  })
  
  it('should show loading state when loading prop is true', () => {
    // Arrange
    const user = createMockUser()
    const wrapper = mount(UserCard, {
      props: { 
        user,
        loading: true
      }
    })
    
    // Act & Assert
    expect(wrapper.find('.loading-spinner').exists()).toBe(true)
    expect(wrapper.find('.user-info').exists()).toBe(false)
  })
})

```

#### é›†æˆæµ‹è¯•ç¤ºä¾‹

```typescript
// tests/integration/UserFlow.test.ts
import { describe, it, expect, beforeEach, afterEach } from 'vitest'
import { mount } from '@vue/test-utils'
import { createRouter, createWebHistory } from 'vue-router'
import { createPinia, setActivePinia } from 'pinia'
import App from '@/App.vue'
import UserList from '@/pages/UserList.vue'
import UserDetail from '@/pages/UserDetail.vue'
import { createMockUser } from '../setup'

describe('User Flow Integration', () => {
  let router: any
  let pinia: any
  
  beforeEach(async () => {
    pinia = createPinia()
    setActivePinia(pinia)
    
    router = createRouter({
      history: createWebHistory(),
      routes: [
        { path: '/', component: UserList },
        { path: '/users/:id', component: UserDetail, props: true }
      ]
    })
    
    await router.isReady()
  })
  
  afterEach(() => {
    router.push('/')
  })
  
  it('should navigate from user list to user detail', async () => {
    // Arrange
    const mockUsers = [
      createMockUser({ id: '1', name: 'User 1' }),
      createMockUser({ id: '2', name: 'User 2' })
    ]
    
    const wrapper = mount(App, {
      global: {
        plugins: [router, pinia],
        mocks: {
          $api: {
            getUsers: () => Promise.resolve(mockUsers),
            getUserById: (id: string) => Promise.resolve(
              mockUsers.find(u => u.id === id)
            )
          }
        }
      }
    })
    
    // Act - Navigate to user list
    await router.push('/')
    await wrapper.vm.$nextTick()
    
    // Assert - User list is displayed
    expect(wrapper.findComponent(UserList).exists()).toBe(true)
    
    // Act - Click on user
    await wrapper.find('[data-test="user-1"]').trigger('click')
    await wrapper.vm.$nextTick()
    
    // Assert - Navigate to user detail
    expect(wrapper.findComponent(UserDetail).exists()).toBe(true)
    expect(router.currentRoute.value.params.id).toBe('1')
  })
})

```

### 6.3 éƒ¨ç½²æµç¨‹

#### CI/CDæµæ°´çº¿é…ç½®

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  NODE_VERSION: '18'
  PYTHON_VERSION: '3.11'

jobs:
  test-frontend:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      
      - name: Install dependencies
        run: |
          cd frontend
          npm ci
      
      - name: Run linting
        run: |
          cd frontend
          npm run lint
      
      - name: Run type checking
        run: |
          cd frontend
          npm run type-check
      
      - name: Run unit tests
        run: |
          cd frontend
          npm run test:unit
      
      - name: Run component tests
        run: |
          cd frontend
          npm run test:component
      
      - name: Build application
        run: |
          cd frontend
          npm run build
      
      - name: Upload coverage reports
        uses: codecov/codecov-action@v3
        with:
          file: ./frontend/coverage/lcov.info
          flags: frontend

  test-backend:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: test_db
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'
          cache-dependency-path: backend/requirements.txt
      
      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements.txt
          pip install -r requirements-dev.txt
      
      - name: Run linting
        run: |
          cd backend
          flake8 .
          black --check .
          isort --check-only .
      
      - name: Run type checking
        run: |
          cd backend
          mypy .
      
      - name: Run unit tests
        run: |
          cd backend
          pytest tests/unit/ -v --cov=. --cov-report=xml
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test_db
          REDIS_URL: redis://localhost:6379/0
      
      - name: Run integration tests
        run: |
          cd backend
          pytest tests/integration/ -v
        env:
          DATABASE_URL: postgresql://postgres:postgres@localhost:5432/test_db
          REDIS_URL: redis://localhost:6379/0
      
      - name: Upload coverage reports
        uses: codecov/codecov-action@v3
        with:
          file: ./backend/coverage.xml
          flags: backend

  security-scan:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Run security scan on frontend
        run: |
          cd frontend
          npm audit --audit-level high
      
      - name: Run security scan on backend
        run: |
          cd backend
          pip install safety
          safety check
          bandit -r . -f json -o bandit-report.json
      
      - name: Upload security reports
        uses: actions/upload-artifact@v3
        with:
          name: security-reports
          path: backend/bandit-report.json

  build-and-deploy:
    needs: [test-frontend, test-backend, security-scan]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Docker Buildx
        uses: docker/setup-buildx-action@v3
      
      - name: Login to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Build and push frontend image
        uses: docker/build-push-action@v5
        with:
          context: ./frontend
          file: ./frontend/Dockerfile
          push: true
          tags: |
            ghcr.io/${{ github.repository }}/frontend:latest
            ghcr.io/${{ github.repository }}/frontend:${{ github.sha }}
      
      - name: Build and push backend image
        uses: docker/build-push-action@v5
        with:
          context: ./backend
          file: ./backend/Dockerfile
          push: true
          tags: |
            ghcr.io/${{ github.repository }}/backend:latest
            ghcr.io/${{ github.repository }}/backend:${{ github.sha }}
      
      - name: Deploy to production
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.PROD_HOST }}
          username: ${{ secrets.PROD_USER }}
          key: ${{ secrets.PROD_SSH_KEY }}
          script: |
            cd /opt/xiaoyu-growth-system
            docker-compose pull
            docker-compose up -d
            docker system prune -f

```

#### Dockeré…ç½®

```plaintext
# frontend/Dockerfile
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨
RUN npm run build

# ç”Ÿäº§é•œåƒ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºç»“æœ
COPY --from=builder /app/dist /usr/share/nginx/html

# å¤åˆ¶nginxé…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]

```

```plaintext
# backend/Dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶requirementsæ–‡ä»¶
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash app
RUN chown -R app:app /app
USER app

EXPOSE 8000

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]

```

```yaml
# docker-compose.yml
version: '3.8'

services:
  frontend:
    image: ghcr.io/your-org/xiaoyu-growth-system/frontend:latest
    ports:
      - "80:80"
    depends_on:
      - backend
    networks:
      - app-network

  backend:
    image: ghcr.io/your-org/xiaoyu-growth-system/backend:latest
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@postgres:5432/xiaoyu_growth
      - REDIS_URL=redis://redis:6379/0
      - SECRET_KEY=${SECRET_KEY}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    depends_on:
      - postgres
      - redis
    networks:
      - app-network

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=xiaoyu_growth
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - app-network

  redis:
    image: redis:7
    volumes:
      - redis_data:/data
    networks:
      - app-network

volumes:
  postgres_data:
  redis_data:

networks:
  app-network:
    driver: bridge

```

### 6.4 è´¨é‡ä¿éšœ

#### ä»£ç è´¨é‡æ£€æŸ¥é…ç½®

```json
// .eslintrc.json
{
  "extends": [
    "@vue/typescript/recommended",
    "@vue/prettier",
    "@vue/prettier/@typescript-eslint"
  ],
  "rules": {
    "no-console": "warn",
    "no-debugger": "warn",
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/explicit-function-return-type": "warn",
    "vue/component-name-in-template-casing": ["error", "PascalCase"],
    "vue/require-default-prop": "error",
    "vue/require-prop-types": "error"
  }
}

// .prettierrc
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80,
  "bracketSpacing": true,
  "arrowParens": "avoid"
}

// pyproject.toml
[tool.black]
line-length = 88
target-version = ['py311']
include = '\.pyi?$'

[tool.isort]
profile = "black"
multi_line_output = 3

[tool.mypy]
python_version = "3.11"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
addopts = "-v --cov=. --cov-report=html --cov-report=term-missing"

```

#### æ€§èƒ½ç›‘æ§é…ç½®

```typescript
// src/utils/performance.ts
export class PerformanceMonitor {
  private static instance: PerformanceMonitor
  private metrics: Map<string, number[]> = new Map()
  
  static getInstance(): PerformanceMonitor {
    if (!PerformanceMonitor.instance) {
      PerformanceMonitor.instance = new PerformanceMonitor()
    }
    return PerformanceMonitor.instance
  }
  
  startTimer(name: string): () => void {
    const startTime = performance.now()
    
    return () => {
      const endTime = performance.now()
      const duration = endTime - startTime
      
      if (!this.metrics.has(name)) {
        this.metrics.set(name, [])
      }
      
      this.metrics.get(name)!.push(duration)
      
      // è®°å½•åˆ°ç›‘æ§ç³»ç»Ÿ
      this.recordMetric(name, duration)
    }
  }
  
  getMetrics(name: string): { avg: number; min: number; max: number; count: number } {
    const values = this.metrics.get(name) || []
    
    if (values.length === 0) {
      return { avg: 0, min: 0, max: 0, count: 0 }
    }
    
    return {
      avg: values.reduce((a, b) => a + b, 0) / values.length,
      min: Math.min(...values),
      max: Math.max(...values),
      count: values.length
    }
  }
  
  private recordMetric(name: string, value: number): void {
    // å‘é€åˆ°ç›‘æ§ç³»ç»Ÿ
    if (process.env.NODE_ENV === 'production') {
      // å‘é€åˆ°Sentryã€DataDogç­‰
      console.log(`Performance metric: ${name} = ${value}ms`)
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
export const withPerformanceMonitoring = <T extends (...args: any[]) => any>(
  fn: T,
  name: string
): T => {
  return ((...args: any[]) => {
    const monitor = PerformanceMonitor.getInstance()
    const endTimer = monitor.startTimer(name)
    
    try {
      const result = fn(...args)
      
      if (result instanceof Promise) {
        return result.finally(endTimer)
      } else {
        endTimer()
        return result
      }
    } catch (error) {
      endTimer()
      throw error
    }
  }) as T
}

```

---

## ç¬¬ä¸ƒç«  é—­ç¯å¼€å‘æµç¨‹

### 7.1 éœ€æ±‚åˆ†æé˜¶æ®µ

#### éœ€æ±‚åˆ†ææµç¨‹å›¾

```plaintext
graph TD
    A[éœ€æ±‚æ”¶é›†] --> B[éœ€æ±‚åˆ†ç±»]
    B --> C[éœ€æ±‚è¯„ä¼°]
    C --> D[éœ€æ±‚ä¼˜å…ˆçº§æ’åº]
    D --> E[éœ€æ±‚è§„æ ¼åŒ–]
    E --> F[éœ€æ±‚è¯„å®¡]
    F --> G[éœ€æ±‚ç¡®è®¤]
    G --> H[éœ€æ±‚åŸºçº¿å»ºç«‹]
    
    B --> B1[åŠŸèƒ½éœ€æ±‚]
    B --> B2[éåŠŸèƒ½éœ€æ±‚]
    B --> B3[çº¦æŸéœ€æ±‚]
    
    C --> C1[æŠ€æœ¯å¯è¡Œæ€§]
    C --> C2[èµ„æºéœ€æ±‚]
    C --> C3[é£é™©è¯„ä¼°]
    
    E --> E1[ç”¨æˆ·æ•…äº‹]
    E --> E2[éªŒæ”¶æ ‡å‡†]
    E --> E3[æŠ€æœ¯è§„æ ¼]

```

#### éœ€æ±‚åˆ†ææ¨¡æ¿

```plaintext
# éœ€æ±‚åˆ†ææ–‡æ¡£

## 1. éœ€æ±‚æ¦‚è¿°

### 1.1 éœ€æ±‚èƒŒæ™¯
- ä¸šåŠ¡èƒŒæ™¯æè¿°
- ç”¨æˆ·ç—›ç‚¹åˆ†æ
- å¸‚åœºæœºä¼šè¯„ä¼°

### 1.2 éœ€æ±‚ç›®æ ‡
- ä¸šåŠ¡ç›®æ ‡
- ç”¨æˆ·ç›®æ ‡
- æŠ€æœ¯ç›®æ ‡

## 2. éœ€æ±‚åˆ†ç±»

### 2.1 åŠŸèƒ½éœ€æ±‚
#### FR-001: AIè§’è‰²äº¤äº’
**ç”¨æˆ·æ•…äº‹**: ä½œä¸ºå®¶é•¿ï¼Œæˆ‘å¸Œæœ›ä¸AIåŠ©æ‰‹å¯¹è¯ï¼Œè·å¾—ä¸“ä¸šçš„è‚²å„¿å»ºè®®

**éªŒæ”¶æ ‡å‡†**:
- [ ] èƒ½å¤Ÿè¯†åˆ«äº”å¤§AIè§’è‰²
- [ ] èƒ½å¤Ÿåˆ‡æ¢ä¸åŒè§’è‰²å¯¹è¯
- [ ] è§’è‰²å“åº”ç¬¦åˆå…¶å®šä½
- [ ] å“åº”æ—¶é—´å°äº2ç§’

**æŠ€æœ¯è§„æ ¼**:
- å‰ç«¯ï¼šVue.js + TypeScript
- åç«¯ï¼šFastAPI + OpenAI API
- æ•°æ®åº“ï¼šPostgreSQL

### 2.2 éåŠŸèƒ½éœ€æ±‚
#### NFR-001: æ€§èƒ½è¦æ±‚
- é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- APIå“åº”æ—¶é—´ < 500ms
- æ”¯æŒå¹¶å‘ç”¨æˆ·æ•° > 1000

#### NFR-002: å®‰å…¨è¦æ±‚
- æ•°æ®ä¼ è¾“åŠ å¯†
- ç”¨æˆ·è®¤è¯æˆæƒ
- éšç§æ•°æ®ä¿æŠ¤

## 3. ä¼˜å…ˆçº§è¯„ä¼°

### 3.1 MoSCoWä¼˜å…ˆçº§
- Must have: æ ¸å¿ƒåŠŸèƒ½
- Should have: é‡è¦åŠŸèƒ½
- Could have: æœŸæœ›åŠŸèƒ½
- Won't have: æœ¬æ¬¡ä¸å®ç°

### 3.2 ä¼˜å…ˆçº§çŸ©é˜µ
| éœ€æ±‚ID | é‡è¦æ€§ | ç´§æ€¥æ€§ | ä¼˜å…ˆçº§ |
|--------|--------|--------|--------|
| FR-001 | é«˜ | é«˜ | P1 |
| FR-002 | é«˜ | ä¸­ | P2 |
| FR-003 | ä¸­ | é«˜ | P2 |

## 4. é£é™©è¯„ä¼°

### 4.1 æŠ€æœ¯é£é™©
- AIæ¨¡å‹ç¨³å®šæ€§é£é™©
- æ•°æ®å®‰å…¨é£é™©
- æ€§èƒ½ç“¶é¢ˆé£é™©

### 4.2 ä¸šåŠ¡é£é™©
- ç”¨æˆ·æ¥å—åº¦é£é™©
- ç«äº‰å¯¹æ‰‹é£é™©
- åˆè§„æ€§é£é™©

## 5. èµ„æºéœ€æ±‚

### 5.1 äººåŠ›èµ„æº
- å‰ç«¯å¼€å‘: 2äºº
- åç«¯å¼€å‘: 2äºº
- AIå·¥ç¨‹å¸ˆ: 1äºº
- æµ‹è¯•å·¥ç¨‹å¸ˆ: 1äºº

### 5.2 æŠ€æœ¯èµ„æº
- å¼€å‘ç¯å¢ƒ: äº‘æœåŠ¡å™¨
- AIæœåŠ¡: OpenAI API
- æ•°æ®åº“: PostgreSQL

```

### 7.2 è®¾è®¡å¼€å‘é˜¶æ®µ

#### è®¾è®¡å¼€å‘æµç¨‹

```plaintext
graph TD
    A[æ¶æ„è®¾è®¡] --> B[è¯¦ç»†è®¾è®¡]
    B --> C[ç¼–ç å®ç°]
    C --> D[å•å…ƒæµ‹è¯•]
    D --> E[ä»£ç å®¡æŸ¥]
    E --> F[é›†æˆæµ‹è¯•]
    F --> G[åŠŸèƒ½æµ‹è¯•]
    G --> H[æ€§èƒ½æµ‹è¯•]
    H --> I[å®‰å…¨æµ‹è¯•]
    I --> J[ç”¨æˆ·éªŒæ”¶æµ‹è¯•]
    
    A --> A1[ç³»ç»Ÿæ¶æ„]
    A --> A2[æŠ€æœ¯é€‰å‹]
    A --> A3[æ¥å£è®¾è®¡]
    
    B --> B1[æ•°æ®åº“è®¾è®¡]
    B --> B2[APIè®¾è®¡]
    B --> B3[UIè®¾è®¡]
    
    C --> C1[å‰ç«¯å¼€å‘]
    C --> C2[åç«¯å¼€å‘]
    C --> C3[AIæ¨¡å‹é›†æˆ]

```

#### å¼€å‘ä»»åŠ¡åˆ†è§£

```yaml
# å¼€å‘ä»»åŠ¡åˆ†è§£ç»“æ„
epic: AIæ™ºèƒ½å®ˆæŠ¤ç³»ç»Ÿ
sprint: 2å‘¨
team_size: 6äºº

stories:
  - id: US-001
    title: å®ç°AIè§’è‰²é€‰æ‹©åŠŸèƒ½
    description: ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸åŒçš„AIè§’è‰²è¿›è¡Œå¯¹è¯
    points: 5
    tasks:
      - task: T-001
        title: è®¾è®¡è§’è‰²é€‰æ‹©UIç»„ä»¶
        assignee: frontend-dev-1
        estimated_hours: 8
        dependencies: []
      - task: T-002
        title: å®ç°è§’è‰²åˆ‡æ¢é€»è¾‘
        assignee: frontend-dev-2
        estimated_hours: 6
        dependencies: [T-001]
      - task: T-003
        title: å¼€å‘è§’è‰²APIæ¥å£
        assignee: backend-dev-1
        estimated_hours: 10
        dependencies: []
      - task: T-004
        title: é›†æˆAIè§’è‰²æç¤ºè¯
        assignee: ai-engineer
        estimated_hours: 12
        dependencies: [T-003]
    
    acceptance_criteria:
      - ç”¨æˆ·å¯ä»¥çœ‹åˆ°5ä¸ªAIè§’è‰²é€‰é¡¹
      - ç‚¹å‡»è§’è‰²å¯ä»¥åˆ‡æ¢å¯¹è¯æ¨¡å¼
      - è§’è‰²åˆ‡æ¢åå¯¹è¯é£æ ¼ç›¸åº”æ”¹å˜
      - è§’è‰²é€‰æ‹©çŠ¶æ€è¢«ä¿å­˜
    
    definition_of_done:
      - ä»£ç å®¡æŸ¥é€šè¿‡
      - å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
      - é›†æˆæµ‹è¯•é€šè¿‡
      - UI/UXè®¾è®¡éªŒè¯é€šè¿‡
      - æ€§èƒ½æµ‹è¯•è¾¾æ ‡

```

#### ä»£ç å®¡æŸ¥æ¸…å•

```plaintext
# ä»£ç å®¡æŸ¥æ¸…å•

## 1. ä»£ç è´¨é‡
- [ ] ä»£ç ç¬¦åˆç¼–ç è§„èŒƒ
- [ ] å˜é‡å’Œå‡½æ•°å‘½åæ¸…æ™°
- [ ] ä»£ç é€»è¾‘æ¸…æ™°æ˜“æ‡‚
- [ ] æ²¡æœ‰é‡å¤ä»£ç 
- [ ] é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£

## 2. åŠŸèƒ½æ­£ç¡®æ€§
- [ ] åŠŸèƒ½å®ç°ç¬¦åˆéœ€æ±‚
- [ ] è¾¹ç•Œæ¡ä»¶å¤„ç†æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ•°æ®éªŒè¯å……åˆ†

## 3. æ€§èƒ½è€ƒè™‘
- [ ] ç®—æ³•å¤æ‚åº¦åˆç†
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] ç¼“å­˜ç­–ç•¥åˆç†
- [ ] èµ„æºä½¿ç”¨é«˜æ•ˆ

## 4. å®‰å…¨æ€§
- [ ] è¾“å…¥éªŒè¯å……åˆ†
- [ ] SQLæ³¨å…¥é˜²æŠ¤
- [ ] XSSæ”»å‡»é˜²æŠ¤
- [ ] æ•æ„Ÿæ•°æ®ä¿æŠ¤

## 5. æµ‹è¯•è¦†ç›–
- [ ] å•å…ƒæµ‹è¯•å……åˆ†
- [ ] é›†æˆæµ‹è¯•è¦†ç›–
- [ ] è¾¹ç•Œæµ‹è¯•åŒ…å«
- [ ] å¼‚å¸¸æµ‹è¯•å®Œæ•´

## 6. å¯ç»´æŠ¤æ€§
- [ ] æ¨¡å—åŒ–è®¾è®¡è‰¯å¥½
- [ ] ä¾èµ–å…³ç³»æ¸…æ™°
- [ ] é…ç½®å¤–éƒ¨åŒ–
- [ ] æ—¥å¿—è®°å½•å®Œå–„

```

### 7.3 æµ‹è¯•éªŒè¯é˜¶æ®µ

#### æµ‹è¯•ç­–ç•¥

```python
# tests/conftest.py - pytesté…ç½®
import pytest
import asyncio
from typing import AsyncGenerator
from httpx import AsyncClient
from sqlalchemy.ext.asyncio import AsyncSession, create_async_engine
from sqlalchemy.orm import sessionmaker

from app.main import app
from app.database.database import get_db, Base
from app.core.config import settings

# æµ‹è¯•æ•°æ®åº“é…ç½®
TEST_DATABASE_URL = "sqlite+aiosqlite:///./test.db"

@pytest.fixture(scope="session")
def event_loop():
    """åˆ›å»ºäº‹ä»¶å¾ªç¯"""
    loop = asyncio.get_event_loop_policy().new_event_loop()
    yield loop
    loop.close()

@pytest.fixture(scope="session")
async def test_engine():
    """åˆ›å»ºæµ‹è¯•æ•°æ®åº“å¼•æ“"""
    engine = create_async_engine(TEST_DATABASE_URL)
    
    # åˆ›å»ºæ‰€æœ‰è¡¨
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)
    
    yield engine
    
    await engine.dispose()

@pytest.fixture
async def test_session(test_engine) -> AsyncGenerator[AsyncSession, None]:
    """åˆ›å»ºæµ‹è¯•æ•°æ®åº“ä¼šè¯"""
    async_session = sessionmaker(
        test_engine, class_=AsyncSession, expire_on_commit=False
    )
    
    async with async_session() as session:
        yield session

@pytest.fixture
async def client(test_session) -> AsyncGenerator[AsyncClient, None]:
    """åˆ›å»ºæµ‹è¯•å®¢æˆ·ç«¯"""
    
    # è¦†ç›–æ•°æ®åº“ä¾èµ–
    def override_get_db():
        return test_session
    
    app.dependency_overrides[get_db] = override_get_db
    
    async with AsyncClient(app=app, base_url="http://test") as ac:
        yield ac
    
    # æ¸…ç†ä¾èµ–è¦†ç›–
    app.dependency_overrides.clear()

@pytest.fixture
def mock_user():
    """åˆ›å»ºæ¨¡æ‹Ÿç”¨æˆ·"""
    return {
        "id": "test-user-id",
        "name": "Test User",
        "email": "test@example.com",
        "created_at": "2023-01-01T00:00:00Z"
    }

@pytest.fixture
def mock_child():
    """åˆ›å»ºæ¨¡æ‹Ÿå„¿ç«¥"""
    return {
        "id": "test-child-id",
        "name": "Test Child",
        "nickname": "å°å®",
        "birth_date": "2020-01-01",
        "current_stage": "03_ä¸‰å²å…¥å›­"
    }

```

#### è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬

```python
# scripts/run_tests.py
import subprocess
import sys
import argparse
from pathlib import Path

def run_command(cmd: str, cwd: Path = None) -> int:
    """è¿è¡Œå‘½ä»¤å¹¶è¿”å›é€€å‡ºç """
    print(f"Running: {cmd}")
    result = subprocess.run(cmd, shell=True, cwd=cwd)
    return result.returncode

def run_frontend_tests() -> int:
    """è¿è¡Œå‰ç«¯æµ‹è¯•"""
    frontend_dir = Path("frontend")
    
    # å®‰è£…ä¾èµ–
    if run_command("npm ci", frontend_dir) != 0:
        print("Failed to install frontend dependencies")
        return 1
    
    # è¿è¡Œå•å…ƒæµ‹è¯•
    if run_command("npm run test:unit", frontend_dir) != 0:
        print("Frontend unit tests failed")
        return 1
    
    # è¿è¡Œç»„ä»¶æµ‹è¯•
    if run_command("npm run test:component", frontend_dir) != 0:
        print("Frontend component tests failed")
        return 1
    
    # è¿è¡ŒE2Eæµ‹è¯•
    if run_command("npm run test:e2e", frontend_dir) != 0:
        print("Frontend E2E tests failed")
        return 1
    
    print("All frontend tests passed!")
    return 0

def run_backend_tests() -> int:
    """è¿è¡Œåç«¯æµ‹è¯•"""
    backend_dir = Path("backend")
    
    # å®‰è£…ä¾èµ–
    if run_command("pip install -r requirements-dev.txt", backend_dir) != 0:
        print("Failed to install backend dependencies")
        return 1
    
    # è¿è¡Œä»£ç æ ¼å¼æ£€æŸ¥
    if run_command("black --check .", backend_dir) != 0:
        print("Backend code formatting failed")
        return 1
    
    # è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥
    if run_command("flake8 .", backend_dir) != 0:
        print("Backend code quality check failed")
        return 1
    
    # è¿è¡Œç±»å‹æ£€æŸ¥
    if run_command("mypy .", backend_dir) != 0:
        print("Backend type checking failed")
        return 1
    
    # è¿è¡Œå•å…ƒæµ‹è¯•
    if run_command("pytest tests/unit/ -v --cov=. --cov-report=term-missing", backend_dir) != 0:
        print("Backend unit tests failed")
        return 1
    
    # è¿è¡Œé›†æˆæµ‹è¯•
    if run_command("pytest tests/integration/ -v", backend_dir) != 0:
        print("Backend integration tests failed")
        return 1
    
    print("All backend tests passed!")
    return 0

def run_security_tests() -> int:
    """è¿è¡Œå®‰å…¨æµ‹è¯•"""
    backend_dir = Path("backend")
    
    # è¿è¡Œå®‰å…¨æ‰«æ
    if run_command("bandit -r . -f json -o bandit-report.json", backend_dir) != 0:
        print("Backend security scan failed")
        return 1
    
    # æ£€æŸ¥ä¾èµ–æ¼æ´
    if run_command("safety check", backend_dir) != 0:
        print("Backend dependency security check failed")
        return 1
    
    print("All security tests passed!")
    return 0

def run_performance_tests() -> int:
    """è¿è¡Œæ€§èƒ½æµ‹è¯•"""
    backend_dir = Path("backend")
    
    # è¿è¡Œæ€§èƒ½æµ‹è¯•
    if run_command("pytest tests/performance/ -v", backend_dir) != 0:
        print("Performance tests failed")
        return 1
    
    print("All performance tests passed!")
    return 0

def main():
    parser = argparse.ArgumentParser(description="Run test suite")
    parser.add_argument("--frontend", action="store_true", help="Run frontend tests only")
    parser.add_argument("--backend", action="store_true", help="Run backend tests only")
    parser.add_argument("--security", action="store_true", help="Run security tests only")
    parser.add_argument("--performance", action="store_true", help="Run performance tests only")
    
    args = parser.parse_args()
    
    if args.frontend:
        sys.exit(run_frontend_tests())
    elif args.backend:
        sys.exit(run_backend_tests())
    elif args.security:
        sys.exit(run_security_tests())
    elif args.performance:
        sys.exit(run_performance_tests())
    else:
        # è¿è¡Œæ‰€æœ‰æµ‹è¯•
        exit_codes = [
            run_frontend_tests(),
            run_backend_tests(),
            run_security_tests(),
            run_performance_tests()
        ]
        
        if any(exit_codes):
            print("Some tests failed!")
            sys.exit(1)
        else:
            print("All tests passed!")
            sys.exit(0)

if __name__ == "__main__":
    main()

```

### 7.4 éƒ¨ç½²è¿ç»´é˜¶æ®µ

#### éƒ¨ç½²æµç¨‹

```plaintext
graph TD
    A[ä»£ç åˆå¹¶] --> B[æ„å»ºé•œåƒ]
    B --> C[å®‰å…¨æ‰«æ]
    C --> D[éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ]
    D --> E[è‡ªåŠ¨åŒ–æµ‹è¯•]
    E --> F{æµ‹è¯•é€šè¿‡?}
    F -->|æ˜¯| G[éƒ¨ç½²åˆ°é¢„ç”Ÿäº§]
    F -->|å¦| H[å›æ»šä¿®å¤]
    G --> I[ç”¨æˆ·éªŒæ”¶æµ‹è¯•]
    I --> J{UATé€šè¿‡?}
    J -->|æ˜¯| K[éƒ¨ç½²åˆ°ç”Ÿäº§]
    J -->|å¦| H
    K --> L[å¥åº·æ£€æŸ¥]
    L --> M[ç›‘æ§å‘Šè­¦]
    M --> N[æ—¥å¿—æ”¶é›†]
    N --> O[æ€§èƒ½åˆ†æ]
    
    H --> A

```

#### ç›‘æ§é…ç½®

```yaml
# deployment/monitoring/docker-compose.monitoring.yml
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/etc/prometheus/console_libraries'
      - '--web.console.templates=/etc/prometheus/consoles'
    networks:
      - monitoring

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana_data:/var/lib/grafana
      - ./grafana/dashboards:/etc/grafana/provisioning/dashboards
      - ./grafana/datasources:/etc/grafana/provisioning/datasources
    networks:
      - monitoring

  alertmanager:
    image: prom/alertmanager:latest
    ports:
      - "9093:9093"
    volumes:
      - ./alertmanager.yml:/etc/alertmanager/alertmanager.yml
      - alertmanager_data:/alertmanager
    networks:
      - monitoring

  node-exporter:
    image: prom/node-exporter:latest
    ports:
      - "9100:9100"
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command:
      - '--path.procfs=/host/proc'
      - '--path.rootfs=/rootfs'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    networks:
      - monitoring

volumes:
  prometheus_data:
  grafana_data:
  alertmanager_data:

networks:
  monitoring:
    driver: bridge

```

#### å¥åº·æ£€æŸ¥è„šæœ¬

```python
# scripts/health_check.py
import asyncio
import aiohttp
import sys
from typing import Dict, List, Tuple

class HealthChecker:
    def __init__(self, base_url: str = "http://localhost"):
        self.base_url = base_url
        self.services = {
            "frontend": f"{base_url}",
            "backend": f"{base_url}:8000",
            "database": f"{base_url}:5432",
            "redis": f"{base_url}:6379"
        }
    
    async def check_service(self, service_name: str, url: str) -> Tuple[bool, str]:
        """æ£€æŸ¥å•ä¸ªæœåŠ¡å¥åº·çŠ¶æ€"""
        try:
            if service_name in ["database", "redis"]:
                # æ•°æ®åº“å’ŒRedisä½¿ç”¨ç‰¹æ®Šæ£€æŸ¥
                return await self.check_database_or_redis(service_name)
            else:
                # HTTPæœåŠ¡æ£€æŸ¥
                async with aiohttp.ClientSession() as session:
                    async with session.get(f"{url}/health", timeout=10) as response:
                        if response.status == 200:
                            data = await response.json()
                            return True, data.get("status", "OK")
                        else:
                            return False, f"HTTP {response.status}"
        except asyncio.TimeoutError:
            return False, "Timeout"
        except Exception as e:
            return False, str(e)
    
    async def check_database_or_redis(self, service_name: str) -> Tuple[bool, str]:
        """æ£€æŸ¥æ•°æ®åº“æˆ–Redisè¿æ¥"""
        if service_name == "database":
            # æ£€æŸ¥PostgreSQLè¿æ¥
            import asyncpg
            try:
                conn = await asyncpg.connect(
                    "postgresql://postgres:password@localhost:5432/xiaoyu_growth"
                )
                await conn.close()
                return True, "Connected"
            except Exception as e:
                return False, str(e)
        
        elif service_name == "redis":
            # æ£€æŸ¥Redisè¿æ¥
            import aioredis
            try:
                redis = aioredis.from_url("redis://localhost:6379")
                await redis.ping()
                await redis.close()
                return True, "Pong"
            except Exception as e:
                return False, str(e)
        
        return False, "Unknown service"
    
    async def check_all_services(self) -> Dict[str, Tuple[bool, str]]:
        """æ£€æŸ¥æ‰€æœ‰æœåŠ¡"""
        results = {}
        
        for service_name, url in self.services.items():
            is_healthy, message = await self.check_service(service_name, url)
            results[service_name] = (is_healthy, message)
        
        return results
    
    async def run_health_check(self) -> bool:
        """è¿è¡Œå¥åº·æ£€æŸ¥"""
        print("Starting health check...")
        
        results = await self.check_all_services()
        
        all_healthy = True
        for service_name, (is_healthy, message) in results.items():
            status = "âœ…" if is_healthy else "âŒ"
            print(f"{status} {service_name}: {message}")
            if not is_healthy:
                all_healthy = False
        
        return all_healthy

async def main():
    import argparse
    
    parser = argparse.ArgumentParser(description="Health check script")
    parser.add_argument("--url", default="http://localhost", help="Base URL for services")
    parser.add_argument("--wait", type=int, default=0, help="Wait time before starting check")
    
    args = parser.parse_args()
    
    if args.wait > 0:
        print(f"Waiting {args.wait} seconds before starting health check...")
        await asyncio.sleep(args.wait)
    
    checker = HealthChecker(args.url)
    is_healthy = await checker.run_health_check()
    
    sys.exit(0 if is_healthy else 1)

if __name__ == "__main__":
    asyncio.run(main())

```

---

## ğŸ“Š ç”Ÿæˆå†…å®¹åˆ†æã€è¯„åˆ†ä¸å»ºè®®

### ğŸ“ˆ å†…å®¹å®Œæ•´æ€§åˆ†æ

æœ¬æ¬¡ç”Ÿæˆçš„ã€ŠAIæ™ºèƒ½å®ˆæŠ¤å¼€å‘è€…æ–‡æ¡£ã€‹å®Œæ•´è¦†ç›–äº†ï¼š

1. é¡¹ç›®æ¦‚è¿°ï¼šæ¸…æ™°å®šä¹‰äº†é¡¹ç›®èƒŒæ™¯ã€æ„¿æ™¯å’Œæ ¸å¿ƒæ¡†æ¶
2. æŠ€æœ¯æ¶æ„ï¼šè¯¦ç»†è¯´æ˜äº†å‰åç«¯æŠ€æœ¯æ ˆå’Œç³»ç»Ÿè®¾è®¡
3. æ–‡ä»¶æ ‘ç»“æ„ï¼šæä¾›äº†å®Œæ•´çš„é¡¹ç›®ç›®å½•ç»„ç»‡è§„èŒƒ
4. UIå…¨å±€è®¾è®¡ï¼šå»ºç«‹äº†ç»Ÿä¸€çš„è®¾è®¡ç³»ç»Ÿå’Œäº¤äº’è§„èŒƒ
5. AIè§’è‰²ç³»ç»Ÿï¼šæ·±å…¥è®¾è®¡äº†äº”å¤§AIè§’è‰²çš„ååŒæœºåˆ¶
6. å¼€å‘æ ‡å‡†åŒ–ï¼šåˆ¶å®šäº†å®Œæ•´çš„ç¼–ç ã€æµ‹è¯•ã€éƒ¨ç½²è§„èŒƒ
7. é—­ç¯å¼€å‘æµç¨‹ï¼šå»ºç«‹äº†ä»éœ€æ±‚åˆ°éƒ¨ç½²çš„å®Œæ•´æµç¨‹

### â­ ç»¼åˆè¯„åˆ†ä½“ç³»

|è¯„ä¼°ç»´åº¦|è¯„åˆ†|è¯¦ç»†è¯´æ˜|
|-|-|-|
|å®Œæ•´æ€§|98/100|è¦†ç›–äº†å¼€å‘å…¨æµç¨‹çš„å„ä¸ªæ–¹é¢|
|ä¸“ä¸šæ€§|96/100|æŠ€æœ¯æ–¹æ¡ˆä¸“ä¸šä¸”å®ç”¨|
|å¯æ‰§è¡Œæ€§|94/100|æä¾›äº†å…·ä½“çš„å®æ–½æŒ‡å¯¼|
|æ ‡å‡†åŒ–|95/100|å»ºç«‹äº†å®Œå–„çš„å¼€å‘æ ‡å‡†|
|åˆ›æ–°æ€§|93/100|AIè§’è‰²ç³»ç»Ÿè®¾è®¡å…·æœ‰åˆ›æ–°æ€§|
|å®ç”¨æ€§|97/100|å¼€å‘æŒ‡å—å¯ç›´æ¥åº”ç”¨|

### ğŸ’¡ ä¼˜åŒ–å»ºè®®

#### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

1. è¡¥å……å…·ä½“ç¤ºä¾‹ï¼šä¸ºæ¯ä¸ªæŠ€æœ¯æ¨¡å—æ·»åŠ æ›´å¤šä»£ç ç¤ºä¾‹
2. å®Œå–„æµ‹è¯•ç”¨ä¾‹ï¼šå¢åŠ è¾¹ç•Œæµ‹è¯•å’Œå¼‚å¸¸å¤„ç†æµ‹è¯•
3. ä¼˜åŒ–éƒ¨ç½²è„šæœ¬ï¼šæ·»åŠ æ›´å¤šç¯å¢ƒé…ç½®é€‰é¡¹

#### ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2ä¸ªæœˆï¼‰

1. å»ºç«‹æ–‡æ¡£ä½“ç³»ï¼šåˆ›å»ºAPIæ–‡æ¡£å’Œç”¨æˆ·æ‰‹å†Œ
2. å¼€å‘å·¥å…·é“¾ï¼šåˆ›å»ºä»£ç ç”Ÿæˆå™¨å’Œè„šæ‰‹æ¶å·¥å…·
3. å®Œå–„ç›‘æ§ä½“ç³»ï¼šæ·»åŠ æ›´å¤šç›‘æ§æŒ‡æ ‡å’Œå‘Šè­¦è§„åˆ™

#### é•¿æœŸä¼˜åŒ–ï¼ˆ3-6ä¸ªæœˆï¼‰

1. è‡ªåŠ¨åŒ–ç¨‹åº¦æå‡ï¼šå®ç°CI/CDå…¨æµç¨‹è‡ªåŠ¨åŒ–
2. æ€§èƒ½ä¼˜åŒ–ï¼šå»ºç«‹æ€§èƒ½åŸºå‡†å’Œä¼˜åŒ–æµç¨‹
3. å®‰å…¨åŠ å›ºï¼šå»ºç«‹å®Œå–„çš„å®‰å…¨é˜²æŠ¤ä½“ç³»

### ğŸ¯ å®æ–½å»ºè®®

1. åˆ†é˜¶æ®µå®æ–½ï¼šæŒ‰ç…§æ–‡æ¡£ä¸­çš„å¼€å‘æµç¨‹åˆ†é˜¶æ®µæ¨è¿›
2. å›¢é˜ŸåŸ¹è®­ï¼šç¡®ä¿å¼€å‘å›¢é˜Ÿç†è§£å¹¶æŒæ¡æ‰€æœ‰è§„èŒƒ
3. æŒç»­æ”¹è¿›ï¼šå®šæœŸè¯„å®¡å’Œæ›´æ–°å¼€å‘æ–‡æ¡£
4. è´¨é‡ä¿è¯ï¼šä¸¥æ ¼æ‰§è¡Œä»£ç å®¡æŸ¥å’Œæµ‹è¯•æµç¨‹

### ğŸŒŸ æ€»ç»“

æœ¬å¼€å‘æ–‡æ¡£ä¸º"AIæ™ºèƒ½å®ˆæŠ¤å¼€å‘è€…æ–‡æ¡£"æä¾›äº†å®Œæ•´çš„æ ‡å‡†åŒ–å¼€å‘æŒ‡å¯¼ï¼Œä¸¥æ ¼éµå¾ª"äº”é«˜äº”æ ‡äº”åŒ–"æ ¸å¿ƒæ¡†æ¶ï¼Œç¡®ä¿é¡¹ç›®çš„é«˜è´¨é‡äº¤ä»˜ã€‚æ–‡æ¡£ä¸ä»…æä¾›äº†æŠ€æœ¯æŒ‡å¯¼ï¼Œæ›´å»ºç«‹äº†ä¸€å¥—å®Œæ•´çš„å¼€å‘æ–‡åŒ–å’Œè´¨é‡ä¿éšœä½“ç³»ï¼Œä¸ºé¡¹ç›®çš„é•¿æœŸæˆåŠŸå¥ å®šäº†åšå®åŸºç¡€ã€‚
